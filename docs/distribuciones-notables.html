<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tema 3 Distribuciones Notables | Probabilidad y variables aleatorias para ML con R y Python</title>
  <meta name="description" content="Asienta las bases para convertirte en el Data Scientist del futuro con todo el contenido de estadística descriptiva del curso. En particular verás los mismos contenidos que explicamos en primero de carrera a matemáticos, ingenieros, economistas, biólogos, médicos o informáticos." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Tema 3 Distribuciones Notables | Probabilidad y variables aleatorias para ML con R y Python" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.udemy.com/course/probabilidad-y-variables-aleatorias-para-ml-con-r-y-python/?couponCode=B85F8D52148DF5AAD8F7" />
  <meta property="og:image" content="https://www.udemy.com/course/probabilidad-y-variables-aleatorias-para-ml-con-r-y-python/?couponCode=B85F8D52148DF5AAD8F7Images/cover.jpg" />
  <meta property="og:description" content="Asienta las bases para convertirte en el Data Scientist del futuro con todo el contenido de estadística descriptiva del curso. En particular verás los mismos contenidos que explicamos en primero de carrera a matemáticos, ingenieros, economistas, biólogos, médicos o informáticos." />
  <meta name="github-repo" content="https://github.com/joanby/probabilidad" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tema 3 Distribuciones Notables | Probabilidad y variables aleatorias para ML con R y Python" />
  
  <meta name="twitter:description" content="Asienta las bases para convertirte en el Data Scientist del futuro con todo el contenido de estadística descriptiva del curso. En particular verás los mismos contenidos que explicamos en primero de carrera a matemáticos, ingenieros, economistas, biólogos, médicos o informáticos." />
  <meta name="twitter:image" content="https://www.udemy.com/course/probabilidad-y-variables-aleatorias-para-ml-con-r-y-python/?couponCode=B85F8D52148DF5AAD8F7Images/cover.jpg" />

<meta name="author" content="Ricardo Alberich, Juan Gabriel Gomila y Arnau Mir" />


<meta name="date" content="2019-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="Images/apple-icon-120x120.png" />
  <link rel="shortcut icon" href="Images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="variables-aleatorias.html"/>
<link rel="next" href="variables-aleatorias-complementos.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Curso completo de Probabilidad y Variables Aleatorias con R y Python</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><i class="fa fa-check"></i>Pre requisitos: Teoría de conjuntos y combinatoria</a><ul>
<li class="chapter" data-level="0.1" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#teoría-de-conjuntos"><i class="fa fa-check"></i><b>0.1</b> Teoría de conjuntos</a><ul>
<li class="chapter" data-level="0.1.1" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#conjuntos-básicos"><i class="fa fa-check"></i><b>0.1.1</b> Conjuntos básicos</a></li>
<li class="chapter" data-level="0.1.2" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#características-y-propiedades-básicas-de-los-conjuntos"><i class="fa fa-check"></i><b>0.1.2</b> Características y propiedades básicas de los conjuntos</a></li>
<li class="chapter" data-level="0.1.3" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#operaciones-con-conjuntos"><i class="fa fa-check"></i><b>0.1.3</b> Operaciones con conjuntos</a></li>
<li class="chapter" data-level="0.1.4" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#más-propiedades-y-definiciones"><i class="fa fa-check"></i><b>0.1.4</b> Más propiedades y definiciones</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#combinatoria"><i class="fa fa-check"></i><b>0.2</b> Combinatoria</a><ul>
<li class="chapter" data-level="0.2.1" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#número-binomial."><i class="fa fa-check"></i><b>0.2.1</b> Número binomial.</a></li>
<li class="chapter" data-level="0.2.2" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#variaciones."><i class="fa fa-check"></i><b>0.2.2</b> Variaciones.</a></li>
<li class="chapter" data-level="0.2.3" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#variaciones-con-repetición."><i class="fa fa-check"></i><b>0.2.3</b> Variaciones con repetición.</a></li>
<li class="chapter" data-level="0.2.4" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#permutaciones"><i class="fa fa-check"></i><b>0.2.4</b> Permutaciones</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html"><a href="pre-requisitos-teoría-de-conjuntos-y-combinatoria.html#para-acabar"><i class="fa fa-check"></i><b>0.3</b> Para acabar</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="probabilidad.html"><a href="probabilidad.html"><i class="fa fa-check"></i><b>1</b> Probabilidad</a><ul>
<li class="chapter" data-level="1.1" data-path="probabilidad.html"><a href="probabilidad.html#probabilidades-básicas"><i class="fa fa-check"></i><b>1.1</b> Probabilidades Básicas</a><ul>
<li class="chapter" data-level="1.1.1" data-path="probabilidad.html"><a href="probabilidad.html#operaciones-con-sucesos"><i class="fa fa-check"></i><b>1.1.1</b> Operaciones con sucesos</a></li>
<li class="chapter" data-level="1.1.2" data-path="probabilidad.html"><a href="probabilidad.html#propiedades"><i class="fa fa-check"></i><b>1.1.2</b> Propiedades</a></li>
<li class="chapter" data-level="1.1.3" data-path="probabilidad.html"><a href="probabilidad.html#definición-de-probabilidad"><i class="fa fa-check"></i><b>1.1.3</b> Definición de probabilidad</a></li>
<li class="chapter" data-level="1.1.4" data-path="probabilidad.html"><a href="probabilidad.html#propiedades-1"><i class="fa fa-check"></i><b>1.1.4</b> Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="probabilidad.html"><a href="probabilidad.html#probabilidad-condicionada"><i class="fa fa-check"></i><b>1.2</b> Probabilidad condicionada</a><ul>
<li class="chapter" data-level="1.2.1" data-path="probabilidad.html"><a href="probabilidad.html#atención"><i class="fa fa-check"></i><b>1.2.1</b> ¡Atención!</a></li>
<li class="chapter" data-level="1.2.2" data-path="probabilidad.html"><a href="probabilidad.html#propiedades-2"><i class="fa fa-check"></i><b>1.2.2</b> Propiedades</a></li>
<li class="chapter" data-level="1.2.3" data-path="probabilidad.html"><a href="probabilidad.html#teorema-de-la-probabilidad-total"><i class="fa fa-check"></i><b>1.2.3</b> Teorema de la probabilidad total</a></li>
<li class="chapter" data-level="1.2.4" data-path="probabilidad.html"><a href="probabilidad.html#clasificación-o-diagnósticos"><i class="fa fa-check"></i><b>1.2.4</b> Clasificación o Diagnósticos</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="probabilidad.html"><a href="probabilidad.html#bayes"><i class="fa fa-check"></i><b>1.3</b> Bayes</a><ul>
<li class="chapter" data-level="1.3.1" data-path="probabilidad.html"><a href="probabilidad.html#fórmula-de-bayes"><i class="fa fa-check"></i><b>1.3.1</b> Fórmula de Bayes</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="probabilidad.html"><a href="probabilidad.html#independencia-de-sucesos"><i class="fa fa-check"></i><b>1.4</b> Independencia de sucesos</a><ul>
<li class="chapter" data-level="1.4.1" data-path="probabilidad.html"><a href="probabilidad.html#sucesos-independientes"><i class="fa fa-check"></i><b>1.4.1</b> Sucesos independientes</a></li>
<li class="chapter" data-level="1.4.2" data-path="probabilidad.html"><a href="probabilidad.html#sucesos-independientes-vs-disjuntos"><i class="fa fa-check"></i><b>1.4.2</b> Sucesos independientes vs disjuntos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html"><i class="fa fa-check"></i><b>2</b> Variables Aleatorias</a><ul>
<li class="chapter" data-level="2.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#introducción-a-las-variables-aleatorias"><i class="fa fa-check"></i><b>2.1</b> Introducción a las variables aleatorias</a><ul>
<li class="chapter" data-level="2.1.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#definición-de-variable-aleatoria"><i class="fa fa-check"></i><b>2.1.1</b> Definición de variable aleatoria</a></li>
<li class="chapter" data-level="2.1.2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#tipos-de-variables-aleatorias"><i class="fa fa-check"></i><b>2.1.2</b> Tipos de variables aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-discretas"><i class="fa fa-check"></i><b>2.2</b> Variables aleatorias discretas</a><ul>
<li class="chapter" data-level="2.2.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#distribuciones-de-probabilidad-para-v.a.-discretas."><i class="fa fa-check"></i><b>2.2.1</b> Distribuciones de probabilidad para v.a. discretas.</a></li>
<li class="chapter" data-level="2.2.2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#valores-esperados-o-esperanza"><i class="fa fa-check"></i><b>2.2.2</b> Valores esperados o esperanza</a></li>
<li class="chapter" data-level="2.2.3" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#medidas-de-la-variabilidad"><i class="fa fa-check"></i><b>2.2.3</b> Medidas de la variabilidad</a></li>
<li class="chapter" data-level="2.2.4" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#transformaciones-lineales."><i class="fa fa-check"></i><b>2.2.4</b> Transformaciones lineales.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#variables-aleatorias-continuas"><i class="fa fa-check"></i><b>2.3</b> Variables aleatorias continuas</a><ul>
<li class="chapter" data-level="2.3.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#propiedades-3"><i class="fa fa-check"></i><b>2.3.1</b> Propiedades</a></li>
<li class="chapter" data-level="2.3.2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#función-de-densidad"><i class="fa fa-check"></i><b>2.3.2</b> Función de densidad</a></li>
<li class="chapter" data-level="2.3.3" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#utilidad-de-la-función-de-densidad"><i class="fa fa-check"></i><b>2.3.3</b> Utilidad de la función de densidad</a></li>
<li class="chapter" data-level="2.3.4" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#esperanza-y-varianza-para-variables-aleatorias-continuas"><i class="fa fa-check"></i><b>2.3.4</b> Esperanza y varianza para variables aleatorias continuas</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#transformaciones-de-variables-aleatorias"><i class="fa fa-check"></i><b>2.4</b> Transformaciones de variables aleatorias</a></li>
<li class="chapter" data-level="2.5" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#desigualdades-de-markov-y-de-chebychev"><i class="fa fa-check"></i><b>2.5</b> Desigualdades de Markov y de Chebychev</a><ul>
<li class="chapter" data-level="2.5.1" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#desigualdad-de-markov"><i class="fa fa-check"></i><b>2.5.1</b> Desigualdad de Markov</a></li>
<li class="chapter" data-level="2.5.2" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#desigualdad-de-chebychev"><i class="fa fa-check"></i><b>2.5.2</b> Desigualdad de Chebychev</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="variables-aleatorias.html"><a href="variables-aleatorias.html#cuantiles-de-variables-aleatorias"><i class="fa fa-check"></i><b>2.6</b> Cuantiles de variables aleatorias</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html"><i class="fa fa-check"></i><b>3</b> Distribuciones Notables</a><ul>
<li class="chapter" data-level="3.1" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribuciones-discretas"><i class="fa fa-check"></i><b>3.1</b> Distribuciones discretas</a><ul>
<li class="chapter" data-level="3.1.1" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-de-bernoulli"><i class="fa fa-check"></i><b>3.1.1</b> Distribución de Bernoulli</a></li>
<li class="chapter" data-level="3.1.2" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-binomial"><i class="fa fa-check"></i><b>3.1.2</b> Distribución binomial</a></li>
<li class="chapter" data-level="3.1.3" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-geométrica"><i class="fa fa-check"></i><b>3.1.3</b> Distribución geométrica</a></li>
<li class="chapter" data-level="3.1.4" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-binomial-negativa"><i class="fa fa-check"></i><b>3.1.4</b> Distribución binomial negativa</a></li>
<li class="chapter" data-level="3.1.5" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-de-poisson"><i class="fa fa-check"></i><b>3.1.5</b> Distribución de Poisson</a></li>
<li class="chapter" data-level="3.1.6" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-hipergeométrica"><i class="fa fa-check"></i><b>3.1.6</b> Distribución hipergeométrica</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#cuantiles-de-distribuciones-notables-discretas"><i class="fa fa-check"></i><b>3.2</b> Cuantiles de distribuciones notables discretas</a></li>
<li class="chapter" data-level="3.3" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribuciones-continuas"><i class="fa fa-check"></i><b>3.3</b> Distribuciones continuas</a><ul>
<li class="chapter" data-level="3.3.1" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-uniforme"><i class="fa fa-check"></i><b>3.3.1</b> Distribución uniforme</a></li>
<li class="chapter" data-level="3.3.2" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-exponencial"><i class="fa fa-check"></i><b>3.3.2</b> Distribución exponencial</a></li>
<li class="chapter" data-level="3.3.3" data-path="distribuciones-notables.html"><a href="distribuciones-notables.html#distribución-normal-o-gaussiana"><i class="fa fa-check"></i><b>3.3.3</b> Distribución normal o Gaussiana</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html"><i class="fa fa-check"></i><b>4</b> Variables Aleatorias. Complementos</a><ul>
<li class="chapter" data-level="4.1" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#momentos-de-variables-aleatorias"><i class="fa fa-check"></i><b>4.1</b> Momentos de variables aleatorias</a><ul>
<li class="chapter" data-level="4.1.1" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#momento-de-orden-n"><i class="fa fa-check"></i><b>4.1.1</b> Momento de orden <span class="math inline">\(n\)</span></a></li>
<li class="chapter" data-level="4.1.2" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#momento-central-de-orden-n"><i class="fa fa-check"></i><b>4.1.2</b> Momento central de orden <span class="math inline">\(n\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#asimetría-de-una-variable-aleatoria"><i class="fa fa-check"></i><b>4.2</b> Asimetría de una variable aleatoria</a></li>
<li class="chapter" data-level="4.3" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#curtosis-o-apuntamiento-de-una-variable-aleatoria"><i class="fa fa-check"></i><b>4.3</b> Curtosis o apuntamiento de una variable aleatoria</a></li>
<li class="chapter" data-level="4.4" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#métodos-de-transformación"><i class="fa fa-check"></i><b>4.4</b> Métodos de transformación</a><ul>
<li class="chapter" data-level="4.4.1" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#función-generatriz-de-momentos"><i class="fa fa-check"></i><b>4.4.1</b> Función generatriz de momentos</a></li>
<li class="chapter" data-level="4.4.2" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#función-característica"><i class="fa fa-check"></i><b>4.4.2</b> Función característica</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#fiabilidad"><i class="fa fa-check"></i><b>4.5</b> Fiabilidad</a><ul>
<li class="chapter" data-level="4.5.1" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#tiempo-medio-de-vida"><i class="fa fa-check"></i><b>4.5.1</b> Tiempo medio de vida</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#generación-de-muestras-de-variables-aleatorias-por-ordenador"><i class="fa fa-check"></i><b>4.6</b> Generación de muestras de variables aleatorias por ordenador</a><ul>
<li class="chapter" data-level="4.6.1" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#método-de-transformación"><i class="fa fa-check"></i><b>4.6.1</b> Método de transformación</a></li>
<li class="chapter" data-level="4.6.2" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#método-de-rechazo"><i class="fa fa-check"></i><b>4.6.2</b> Método de rechazo</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#entropía"><i class="fa fa-check"></i><b>4.7</b> Entropía</a><ul>
<li class="chapter" data-level="4.7.1" data-path="variables-aleatorias-complementos.html"><a href="variables-aleatorias-complementos.html#entropía-de-una-variable-aleatoria"><i class="fa fa-check"></i><b>4.7.1</b> Entropía de una variable aleatoria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html"><i class="fa fa-check"></i><b>5</b> Vectores aleatorios bidimensionales</a><ul>
<li class="chapter" data-level="5.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#dos-variables-aleatorias"><i class="fa fa-check"></i><b>5.1</b> Dos variables aleatorias</a><ul>
<li class="chapter" data-level="5.1.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#definición"><i class="fa fa-check"></i><b>5.1.1</b> Definición</a></li>
<li class="chapter" data-level="5.1.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#representación-del-dominio-de-una-variable-aleatoria-bidimensional"><i class="fa fa-check"></i><b>5.1.2</b> Representación del dominio de una variable aleatoria bidimensional</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#función-de-distribución-conjunta"><i class="fa fa-check"></i><b>5.2</b> Función de distribución conjunta</a><ul>
<li class="chapter" data-level="5.2.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#definición-1"><i class="fa fa-check"></i><b>5.2.1</b> Definición</a></li>
<li class="chapter" data-level="5.2.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#propiedades-4"><i class="fa fa-check"></i><b>5.2.2</b> Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#variables-aleatorias-bidimensionales-discretas"><i class="fa fa-check"></i><b>5.3</b> Variables aleatorias bidimensionales discretas</a><ul>
<li class="chapter" data-level="5.3.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#función-de-probabilidad-conjunta"><i class="fa fa-check"></i><b>5.3.1</b> Función de probabilidad conjunta</a></li>
<li class="chapter" data-level="5.3.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#distribuciones-marginales"><i class="fa fa-check"></i><b>5.3.2</b> Distribuciones marginales</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#variables-aleatorias-bidimensionales-continuas"><i class="fa fa-check"></i><b>5.4</b> Variables aleatorias bidimensionales continuas</a><ul>
<li class="chapter" data-level="5.4.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#definición-2"><i class="fa fa-check"></i><b>5.4.1</b> Definición</a></li>
<li class="chapter" data-level="5.4.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#propiedades-de-la-función-de-densidad"><i class="fa fa-check"></i><b>5.4.2</b> Propiedades de la función de densidad</a></li>
<li class="chapter" data-level="5.4.3" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#la-distribución-gaussiana-bidimensional"><i class="fa fa-check"></i><b>5.4.3</b> La distribución gaussiana bidimensional</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#independencia-de-variables-aleatorias"><i class="fa fa-check"></i><b>5.5</b> Independencia de variables aleatorias</a><ul>
<li class="chapter" data-level="5.5.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#independencia-de-variables-aleatorias-discretas"><i class="fa fa-check"></i><b>5.5.1</b> Independencia de variables aleatorias discretas</a></li>
<li class="chapter" data-level="5.5.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#independencia-de-variables-aleatorias-continuas"><i class="fa fa-check"></i><b>5.5.2</b> Independencia de variables aleatorias continuas</a></li>
<li class="chapter" data-level="5.5.3" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#relación-de-la-independencia-y-la-función-de-distribución"><i class="fa fa-check"></i><b>5.5.3</b> Relación de la independencia y la función de distribución</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#momentos-conjuntos-y-valores-esperados-conjuntos"><i class="fa fa-check"></i><b>5.6</b> Momentos conjuntos y valores esperados conjuntos</a><ul>
<li class="chapter" data-level="5.6.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#valor-esperado-de-una-función-de-dos-variables-aleatorias"><i class="fa fa-check"></i><b>5.6.1</b> Valor esperado de una función de dos variables aleatorias</a></li>
<li class="chapter" data-level="5.6.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#valor-esperado-de-una-función-de-dos-variables-aleatorias-independientes"><i class="fa fa-check"></i><b>5.6.2</b> Valor esperado de una función de dos variables aleatorias independientes</a></li>
<li class="chapter" data-level="5.6.3" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#momentos-conjuntos"><i class="fa fa-check"></i><b>5.6.3</b> Momentos conjuntos</a></li>
<li class="chapter" data-level="5.6.4" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#momentos-conjuntos-centrados-en-las-medias"><i class="fa fa-check"></i><b>5.6.4</b> Momentos conjuntos centrados en las medias</a></li>
<li class="chapter" data-level="5.6.5" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#covariancia-entre-las-variables"><i class="fa fa-check"></i><b>5.6.5</b> Covariancia entre las variables</a></li>
<li class="chapter" data-level="5.6.6" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#coeficiente-de-correlación-entre-las-variables"><i class="fa fa-check"></i><b>5.6.6</b> Coeficiente de correlación entre las variables</a></li>
<li class="chapter" data-level="5.6.7" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#incorrelación-e-independencia"><i class="fa fa-check"></i><b>5.6.7</b> Incorrelación e independencia</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#variables-aleatorias-condicionales-y-valor-esperado-condicional"><i class="fa fa-check"></i><b>5.7</b> Variables aleatorias condicionales y valor esperado condicional</a><ul>
<li class="chapter" data-level="5.7.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#variables-aleatorias-condicionales-discretas"><i class="fa fa-check"></i><b>5.7.1</b> Variables aleatorias condicionales discretas</a></li>
<li class="chapter" data-level="5.7.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#variables-aleatorias-condicionales-continuas"><i class="fa fa-check"></i><b>5.7.2</b> Variables aleatorias condicionales continuas</a></li>
<li class="chapter" data-level="5.7.3" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#valores-esperados-condicionales"><i class="fa fa-check"></i><b>5.7.3</b> Valores esperados condicionales</a></li>
<li class="chapter" data-level="5.7.4" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#relación-con-el-problema-de-la-regresión-general"><i class="fa fa-check"></i><b>5.7.4</b> Relación con el problema de la regresión general</a></li>
<li class="chapter" data-level="5.7.5" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#valores-esperados-condicionales.-caso-general"><i class="fa fa-check"></i><b>5.7.5</b> Valores esperados condicionales. Caso general</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#variables-aleatorias-definidas-como-función-de-dos-variables-aleatorias-conjuntas"><i class="fa fa-check"></i><b>5.8</b> Variables aleatorias definidas como función de dos variables aleatorias conjuntas</a><ul>
<li class="chapter" data-level="5.8.1" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#variable-aleatoria-función-de-la-variable-aleatoria-bidimensional"><i class="fa fa-check"></i><b>5.8.1</b> Variable aleatoria función de la variable aleatoria bidimensional</a></li>
<li class="chapter" data-level="5.8.2" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#transformaciones-lineales-de-variables-aleatorias"><i class="fa fa-check"></i><b>5.8.2</b> Transformaciones lineales de variables aleatorias</a></li>
<li class="chapter" data-level="5.8.3" data-path="vectores-aleatorios-bidimensionales.html"><a href="vectores-aleatorios-bidimensionales.html#transformaciones-generales-de-variables-aleatorias"><i class="fa fa-check"></i><b>5.8.3</b> Transformaciones generales de variables aleatorias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html"><i class="fa fa-check"></i><b>6</b> Vectores aleatorios</a><ul>
<li class="chapter" data-level="6.1" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#varias-variables-aleatorias"><i class="fa fa-check"></i><b>6.1</b> Varias variables aleatorias</a><ul>
<li class="chapter" data-level="6.1.1" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#definición-3"><i class="fa fa-check"></i><b>6.1.1</b> Definición</a></li>
<li class="chapter" data-level="6.1.2" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#representación-del-dominio-de-una-variable-aleatoria-n-dimensional"><i class="fa fa-check"></i><b>6.1.2</b> Representación del dominio de una variable aleatoria <span class="math inline">\(n\)</span>-dimensional</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#función-de-distribución-conjunta-1"><i class="fa fa-check"></i><b>6.2</b> Función de distribución conjunta</a><ul>
<li class="chapter" data-level="6.2.1" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#definición-4"><i class="fa fa-check"></i><b>6.2.1</b> Definición</a></li>
<li class="chapter" data-level="6.2.2" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#propiedades-5"><i class="fa fa-check"></i><b>6.2.2</b> Propiedades</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#variables-aleatorias-n-dimensionales-discretas"><i class="fa fa-check"></i><b>6.3</b> Variables aleatorias <span class="math inline">\(n\)</span>-dimensionales discretas</a><ul>
<li class="chapter" data-level="6.3.1" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#función-de-probabilidad-conjunta-1"><i class="fa fa-check"></i><b>6.3.1</b> Función de probabilidad conjunta</a></li>
<li class="chapter" data-level="6.3.2" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#propiedades-de-la-función-de-probabilidad-conjunta-1"><i class="fa fa-check"></i><b>6.3.2</b> Propiedades de la función de probabilidad conjunta</a></li>
<li class="chapter" data-level="6.3.3" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#funciones-de-distribución-marginales"><i class="fa fa-check"></i><b>6.3.3</b> Funciones de distribución marginales</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#variables-aleatorias-n-dimensionales-continuas"><i class="fa fa-check"></i><b>6.4</b> Variables aleatorias <span class="math inline">\(n\)</span>-dimensionales continuas</a><ul>
<li class="chapter" data-level="6.4.1" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#definición-5"><i class="fa fa-check"></i><b>6.4.1</b> Definición</a></li>
<li class="chapter" data-level="6.4.2" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#propiedades-de-la-función-de-densidad-1"><i class="fa fa-check"></i><b>6.4.2</b> Propiedades de la función de densidad</a></li>
<li class="chapter" data-level="6.4.3" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#la-distribución-gaussiana-n-dimensional"><i class="fa fa-check"></i><b>6.4.3</b> La distribución gaussiana <span class="math inline">\(n\)</span>-dimensional</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#independencia-de-variables-aleatorias-1"><i class="fa fa-check"></i><b>6.5</b> Independencia de variables aleatorias</a><ul>
<li class="chapter" data-level="6.5.1" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#independencia-de-variables-aleatorias-discretas-1"><i class="fa fa-check"></i><b>6.5.1</b> Independencia de variables aleatorias discretas</a></li>
<li class="chapter" data-level="6.5.2" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#independencia-de-variables-aleatorias-continuas-1"><i class="fa fa-check"></i><b>6.5.2</b> Independencia de variables aleatorias continuas</a></li>
<li class="chapter" data-level="6.5.3" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#relación-de-la-independencia-y-la-función-de-distribución-1"><i class="fa fa-check"></i><b>6.5.3</b> Relación de la independencia y la función de distribución</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#momentos-conjuntos-y-valores-esperados-conjuntos-1"><i class="fa fa-check"></i><b>6.6</b> Momentos conjuntos y valores esperados conjuntos</a><ul>
<li class="chapter" data-level="6.6.1" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#valor-esperado-de-una-función-de-n-variables-aleatorias"><i class="fa fa-check"></i><b>6.6.1</b> Valor esperado de una función de <span class="math inline">\(n\)</span> variables aleatorias</a></li>
<li class="chapter" data-level="6.6.2" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#ejemplos-12"><i class="fa fa-check"></i><b>6.6.2</b> Ejemplos</a></li>
<li class="chapter" data-level="6.6.3" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#propiedad-del-valor-esperado-de-la-suma-de-variables"><i class="fa fa-check"></i><b>6.6.3</b> Propiedad del valor esperado de la suma de variables</a></li>
<li class="chapter" data-level="6.6.4" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#valor-esperado-de-una-función-de-n-variables-aleatorias-independientes"><i class="fa fa-check"></i><b>6.6.4</b> Valor esperado de una función de <span class="math inline">\(n\)</span> variables aleatorias independientes</a></li>
<li class="chapter" data-level="6.6.5" data-path="vectores-aleatorios.html"><a href="vectores-aleatorios.html#propiedades-de-la-covarianza-1"><i class="fa fa-check"></i><b>6.6.5</b> Propiedades de la covarianza</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><i class="fa fa-check"></i><b>7</b> Ley de los grandes números y Teorema Central del Límite</a><ul>
<li class="chapter" data-level="7.1" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#muestras-aleatorias-simples"><i class="fa fa-check"></i><b>7.1</b> Muestras aleatorias simples</a><ul>
<li class="chapter" data-level="7.1.1" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#la-distribución-de-la-media-muestral"><i class="fa fa-check"></i><b>7.1.1</b> La distribución de la media muestral</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#convergencia-de-sucesiones-de-variables-aleatorias"><i class="fa fa-check"></i><b>7.2</b> Convergencia de sucesiones de variables aleatorias</a><ul>
<li class="chapter" data-level="7.2.1" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#convergencia-casi-segura"><i class="fa fa-check"></i><b>7.2.1</b> Convergencia casi segura</a></li>
<li class="chapter" data-level="7.2.2" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#convergencia-en-probabilidad"><i class="fa fa-check"></i><b>7.2.2</b> Convergencia en probabilidad</a></li>
<li class="chapter" data-level="7.2.3" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#convergencia-en-ley-o-en-distribución"><i class="fa fa-check"></i><b>7.2.3</b> Convergencia en ley o en distribución</a></li>
<li class="chapter" data-level="7.2.4" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#relaciones-entre-las-distintas-convergencias"><i class="fa fa-check"></i><b>7.2.4</b> Relaciones entre las distintas convergencias</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#leyes-de-los-grandes-números"><i class="fa fa-check"></i><b>7.3</b> Leyes de los grandes números</a><ul>
<li class="chapter" data-level="7.3.1" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#leyes-débiles-de-los-grandes-números"><i class="fa fa-check"></i><b>7.3.1</b> Leyes débiles de los grandes números</a></li>
<li class="chapter" data-level="7.3.2" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#convergencia-de-los-momentos-muestrales"><i class="fa fa-check"></i><b>7.3.2</b> Convergencia de los momentos muestrales</a></li>
<li class="chapter" data-level="7.3.3" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#leyes-fuertes-de-los-grandes-números"><i class="fa fa-check"></i><b>7.3.3</b> Leyes fuertes de los grandes números</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#teorema-central-del-límite"><i class="fa fa-check"></i><b>7.4</b> Teorema Central del Límite</a><ul>
<li class="chapter" data-level="7.4.1" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#teorema-central-del-límite-1"><i class="fa fa-check"></i><b>7.4.1</b> Teorema Central del Límite</a></li>
<li class="chapter" data-level="7.4.2" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#teorema-central-del-límite-en-la-práctica"><i class="fa fa-check"></i><b>7.4.2</b> Teorema Central del Límite en la práctica</a></li>
<li class="chapter" data-level="7.4.3" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#teorema-de-moivre-laplace"><i class="fa fa-check"></i><b>7.4.3</b> Teorema de Moivre-Laplace</a></li>
<li class="chapter" data-level="7.4.4" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#aproximación-de-una-suma-de-variables-poisson"><i class="fa fa-check"></i><b>7.4.4</b> Aproximación de una suma de variables Poisson</a></li>
<li class="chapter" data-level="7.4.5" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#corrección-de-continuidad-de-fisher"><i class="fa fa-check"></i><b>7.4.5</b> Corrección de continuidad de Fisher</a></li>
<li class="chapter" data-level="7.4.6" data-path="ley-de-los-grandes-números-y-teorema-central-del-límite.html"><a href="ley-de-los-grandes-números-y-teorema-central-del-límite.html#simulación-del-teorema-central-del-límite"><i class="fa fa-check"></i><b>7.4.6</b> Simulación del Teorema Central del Límite</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.udemy.com/course/probabilidad-y-variables-aleatorias-para-ml-con-r-y-python/?couponCode=B85F8D52148DF5AAD8F7" target="blank">Curso en Udemy</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Probabilidad y variables aleatorias para ML con R y Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="distribuciones-notables" class="section level1">
<h1><span class="header-section-number">Tema 3</span> Distribuciones Notables</h1>
<p>En este tema estudiaremos diversos tipos de experimentos que son muy frecuentes y algunas de las variables aleatorias asociadas a ellos.</p>
<p>Estas variables reciben distintos nombres que aplicaremos sin distinción al tipo de población del experimento a la variable o a su función de probabilidad, densidad o distribución.</p>
<p>Empezaremos con las variables aleatorias discretas que se presentan con frecuencia ya que están relacionadas con situaciones muy comunes como el número de caras en varios lanzamiento de una moneda, el número de veces que una maquina funciona hasta que se estropea, el numero de clientes en una cola,…</p>
<div id="distribuciones-discretas" class="section level2">
<h2><span class="header-section-number">3.1</span> Distribuciones discretas</h2>
<div id="distribución-de-bernoulli" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Distribución de Bernoulli</h3>
<p>Consideremos un experimento con dos resultados posibles éxito (E) y
fracaso (F). El espacio de sucesos será <span class="math inline">\(\Omega=\{E,F\}\)</span>.</p>
<p>Supongamos que la probabilidad de éxito es <span class="math inline">\(P(E)=p\)</span>, y naturalmente <span class="math inline">\(P(F)=1-p=q\)</span> con <span class="math inline">\(0&lt;p&lt;1\)</span>.</p>
<p>Consideremos la aplicación</p>
<p><span class="math display">\[
X:\Omega=\{E,F\}\to \mathbb{R},
\]</span>
definida por <span class="math inline">\(X(E)=1,\ X(F)=0.\)</span></p>
<p>Su función de probabilidad es:
<span class="math display">\[
P_{X}(x)=
\left\{
\begin{array}{ll} 1-p=q, &amp; \mbox{si } x=0,\\
p, &amp; \mbox{si } x=1,\\
0, &amp; \mbox{en cualquier otro caso.}
\end{array}
\right.
\]</span></p>
<p>Su función de distribución es:
<span class="math display">\[
F_{X}(x)=P(X\leq x)=
\left\{
\begin{array}{ll} 
0, &amp; \mbox{si } x&lt;0,\\
1-p=q, &amp; \mbox{si } 0\leq x &lt;1,\\
1, &amp; \mbox{si } 1\leq x. \\
\end{array}
\right.
\]</span>
Bajo estas condiciones diremos que <span class="math inline">\(X\)</span> <strong>es una v.a. Bernoulli</strong> o que sigue una ley de <strong>distribución de probabilidad Bernoulli</strong> de parámetro <span class="math inline">\(p\)</span>.</p>
<p>Lo denotaremos por <span class="math inline">\(X\equiv Ber(p)\)</span> o también <span class="math inline">\(X\equiv B(1,p).\)</span></p>
<p>A este tipo de experimentos (éxito/fracaso) se les denomina experimentos Bernoulli.</p>
<p>Fue su descubridor un científico suizo <a href="https://es.wikipedia.org/wiki/Jakob_Bernoulli">Jacob Bernoulli</a>, uno más de la de la conocida <a href="https://es.wikipedia.org/wiki/Familia_Bernoulli">familia de científicos suizos Bernoulli</a>.</p>
<p><strong>Esperanza de una v.a. <span class="math inline">\(X\)</span> <span class="math inline">\(Ber(p)\)</span></strong></p>
<p>Su <strong>valor esperado</strong> es:
<span class="math display">\[E(X)=\displaystyle\sum_{x=0}^1 x\cdot P(X=x)= 0\cdot(1-p)+1\cdot p=p.\]</span>
Calculemos también <span class="math inline">\(E(X^2)\)</span>:</p>
<p><span class="math display">\[E(X^2)=\displaystyle\sum_{x=0}^1 x^2\cdot P(X=x)= 0^2\cdot(1-p)+1^2\cdot p=p.\]</span>
<strong>Varianza de una v.a. <span class="math inline">\(X\)</span> <span class="math inline">\(Ber(p)\)</span></strong></p>
<p>Su <strong>varianza</strong> es:</p>
<p><span class="math display">\[Var(X)=E(X^2)-\left(E(X)\right)^2=p-p^2=p\cdot (1-p)=p\cdot q.\]</span>
Su desviación típica es:
<span class="math display">\[
\sqrt{Var(X)}=\sqrt{p \cdot (1-p)}.
\]</span></p>
<p><strong>Resumen v.a con distribución Bernoulli</strong></p>
<table>
<colgroup>
<col width="55%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X\)</span> Bernoulli</th>
<th align="left"><span class="math inline">\(Ber(p)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\(\{0,1\}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} q &amp; \mbox{si } x=0\\ p &amp; \mbox{si } x=1\\0 &amp; \mbox{en otro caso}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} 0 &amp; \mbox{ si } x&lt;0\\q &amp; \mbox{ si } 0\leq x&lt;1\\1 &amp; \mbox{ si } 1\leq x \end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=p\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=p\cdot q\)</span></td>
</tr>
</tbody>
</table>
<div class="example">
<p><strong>Ejemplo de Distribución Bernoulli</strong></p>
<p>Veamos los cálculos básicos usando la distribución <span class="math inline">\(Ber(p=0.25)\)</span> en <code>R</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">dbinom</span>(<span class="dv">0</span>,<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">dbinom</span>(<span class="dv">1</span>,<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">rbinom</span>(<span class="dt">n=</span><span class="dv">20</span>,<span class="dt">size =</span> <span class="dv">1</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>##  [1] 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 1 0 1 0 0</code></pre>
<p>El siguiente código dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(Ber(p=0.25)\)</span></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">y=</span><span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb57-3" title="3">     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb57-4" title="4">     <span class="dt">main=</span><span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> Ber(p=0.25)&quot;</span>)</a>
<a class="sourceLine" id="cb57-5" title="5"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">y=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.75</span>,<span class="dv">0</span>,<span class="fl">0.25</span>), <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb57-6" title="6"><span class="kw">curve</span>(<span class="kw">pbinom</span>(x,<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb57-7" title="7">      <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb57-8" title="8">      <span class="dt">main=</span><span class="st">&quot;Función de distribución\n Ber(p=0.25)&quot;</span>)</a>
<a class="sourceLine" id="cb57-9" title="9"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Gráficas interactivas <span class="math inline">\(Ber(p)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">sliderInput</span>(<span class="st">&quot;p_ber&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Probabilidad éxito p:&quot;</span>,</a>
<a class="sourceLine" id="cb58-2" title="2">              <span class="dt">min =</span> <span class="fl">0.01</span>, <span class="dt">max =</span> <span class="fl">0.99</span>, <span class="dt">value =</span> <span class="fl">0.25</span>, <span class="dt">step =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb58-3" title="3"></a>
<a class="sourceLine" id="cb58-4" title="4"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb58-5" title="5"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-6" title="6">  p=input<span class="op">$</span>p_ber</a>
<a class="sourceLine" id="cb58-7" title="7"><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">y=</span><span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span>p),</a>
<a class="sourceLine" id="cb58-8" title="8">     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">2</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">pch=</span><span class="dv">21</span>,</a>
<a class="sourceLine" id="cb58-9" title="9">     <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span></a>
<a class="sourceLine" id="cb58-10" title="10"><span class="st">                   Ber(p=&quot;</span>,p,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse=</span><span class="st">&quot;&quot;</span>),<span class="dt">bg=</span><span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb58-11" title="11"><span class="kw">segments</span>(<span class="dt">x0=</span><span class="dv">0</span>,<span class="dt">y0=</span><span class="dv">0</span>,<span class="dt">x1=</span><span class="dv">0</span>,<span class="dt">y1=</span><span class="dv">1</span><span class="op">-</span>p, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-12" title="12"><span class="kw">segments</span>(<span class="dt">x0=</span><span class="dv">1</span>,<span class="dt">y0=</span><span class="dv">0</span>,<span class="dt">x1=</span><span class="dv">1</span>,<span class="dt">y1=</span>p, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-13" title="13"><span class="kw">segments</span>(<span class="dt">x0=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">y0=</span><span class="dv">1</span><span class="op">-</span>p,<span class="dt">x1=</span><span class="dv">0</span>,<span class="dt">y1=</span><span class="dv">1</span><span class="op">-</span>p, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-14" title="14"><span class="kw">segments</span>(<span class="dt">x0=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">y0=</span>p,<span class="dt">x1=</span><span class="dv">1</span>,<span class="dt">y1=</span>p, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-15" title="15">x=<span class="dv">0</span><span class="op">:</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb58-16" title="16">y=<span class="kw">pbinom</span>(x,<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span>p)</a>
<a class="sourceLine" id="cb58-17" title="17"><span class="kw">curve</span>(<span class="kw">pbinom</span>(x,<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob=</span>p),</a>
<a class="sourceLine" id="cb58-18" title="18">      <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb58-19" title="19">      <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de distribución\n Ber(p=&quot;</span>,p,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb58-20" title="20">      )</a>
<a class="sourceLine" id="cb58-21" title="21"></a>
<a class="sourceLine" id="cb58-22" title="22"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb58-23" title="23">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_ber1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
</div>
</div>
<div id="distribución-binomial" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Distribución binomial</h3>
<p>Si repetimos <span class="math inline">\(n\)</span> veces de forma independiente un experimento Bernoulli de parámetro <span class="math inline">\(p\)</span>, el espacio muestral <span class="math inline">\(\Omega\)</span> estará formado por cadenas de <span class="math inline">\(E\)</span>’s y <span class="math inline">\(F\)</span>’s de longitud <span class="math inline">\(n\)</span>.
Consideremos la v.a.:
<span class="math display">\[X(\overbrace{EFFF\ldots EEF}^{n})=\mbox{número de éxitos en la cadena}.\]</span>
A la variable aleatoria anterior se le conoce como distribución binomial de parámetros <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span>, y lo denotaremos por <span class="math inline">\(X\equiv B(n,p).\)</span></p>
<p><strong>Función de probabilidad de una binomial</strong></p>
<p>Su <strong>función de probabilidad</strong> es:
<span class="math display">\[
P_{X}(x)=\left\{
\begin{array}{ll}
{n\choose x}\cdot  p^x \cdot(1-p)^{n-x}, &amp;\mbox{ si } x=0,1,\ldots,n,\\
0,  &amp; \mbox{ en otro caso.}
\end{array}\right.
\]</span>
<strong>Función de distribución de una binomial</strong></p>
<p>Su <strong>función de distribución</strong> no tiene una fórmula cerrada. Hay que acumular la función de probabilidad:
<span class="math display">\[
\begin{array}{ll}
F_{X}(x)=P(X\leq x) &amp; =  \sum_{i=0}^x P_X(i)\\
&amp; = 
\left\{
\begin{array}{ll}
0, &amp; \mbox{ si } x\leq 0,\\\displaystyle
\sum_{i=0}^k {n\choose i}\cdot  p^i \cdot (1-p)^{n-i} &amp; \mbox{ si } 
\left\{
  \begin{array}{l} 
  k\leq x&lt; k+1,\\
  k=0,1,\ldots,n,
  \end{array}
\right.\\
1, &amp; \mbox{ si } n\leq x.
\end{array}
\right.
\end{array}
\]</span></p>
<p><strong>Números binomiales con R</strong></p>
<p>Los números binomiales calculan el número de equipos de baloncesto distintos que (<span class="math inline">\(k=5\)</span> jugadores) se pueden hacer con 6 jugadores (<span class="math inline">\(n=6\)</span>).</p>
<p>Es decir cuántas maneras distintas hay para elegir (<em>choose</em>) 5 jugadores en un conjunto de 6 jugadores. Todo el mundo diría
¡¡¡6!!!. Efectivamente con <code>R</code> es</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">choose</span>(<span class="dv">6</span>,<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>Con 10 jugadores el número de equipos de 5 distintos es bastante más grande</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">choose</span>(<span class="dv">10</span>,<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 252</code></pre>
<p>Y, por ejemplo, con un equipo de fútbol profesional que tiene en plantilla 22 jugadores (quitando los guardametas) se pueden formar ¡¡nada menos que!!</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">choose</span>(<span class="dv">22</span>,<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [1] 646646</code></pre>
<p>un bonito número capicúa que nos da el número de equipos distintos que se pueden formar.</p>
<p>Obviamente se tiene que una v.a. Bernoulli es una binomial con <span class="math inline">\(n=1\)</span>:
<span class="math inline">\(B(1,p)=Ber(p).\)</span></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Calculad las funciones de distribución de una binomial <span class="math inline">\(B(n=1,p=0.3)\)</span> y comprobar que coinciden con las distribuciones de una <span class="math inline">\(Ber(p=0.3)\)</span>.</p>
</div>
<p><strong>Observaciones sobre la distribución binomial</strong></p>
<ul>
<li>La probabilidad de fracaso se suele denotar con <span class="math inline">\(q=1-p\)</span>, <strong>sin ningún aviso adicional</strong>, con el fin de acortar y agilizar la escritura de las fórmulas.</li>
<li>Su <strong>función de distribución no tienen una formula general</strong>, hay que calcularla con una función de R o python. En el siglo pasado se tabulaban en los libros de papel :-).</li>
<li>En el material adicional os pondremos unas tablas de esta distribución
para distintos valores de <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span> para que disfrutéis de tan ancestral método de cálculo.</li>
<li>Cualquier paquete estadístico u hoja de cálculo dispone de
funciones para el cálculo de estas probabilidades, así que el <strong>uso de las tablas</strong> queda <strong>totalmente anticuado</strong>.</li>
</ul>
<p><strong>Esperanza de una <span class="math inline">\(B(n,p)\)</span></strong></p>
<p>Su <strong>esperanza</strong> es:
<span class="math display">\[E(X)=\displaystyle\sum_{k=0}^n k \cdot  {n \choose k }\cdot p^k\cdot q^{n-k} = n\cdot p.\]</span>
La esperanza de <span class="math inline">\(X^2\)</span> es:
<span class="math display">\[
E(X^2)= \displaystyle\sum_{k=0}^n k^2 \cdot  {n \choose k }\cdot p^k\cdot q^{n-k}= n\cdot p\cdot q-(n\cdot p)^2.
\]</span></p>
<p><strong>Varianza de una <span class="math inline">\(B(n,p)\)</span></strong></p>
<p>Su <strong>varianza</strong> es:</p>
<p><span class="math display">\[Var(X)=E(X^2)-\left(E(X)\right)^2=n\cdot p \cdot q=n\cdot p\cdot (1-p).\]</span></p>
<p>Su desviación típica es:</p>
<p><span class="math display">\[\sqrt{n\cdot p\cdot q}=\sqrt{n\cdot p\cdot (1-p)}.\]</span></p>
<p>En temas posteriores veremos una forma sencilla del cálculo de la esperanza y varianza de una <span class="math inline">\(B(n,p)\)</span> como las suma de <span class="math inline">\(n\)</span> v.a. <span class="math inline">\(Ber(p)\)</span> independientes.</p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Justificar de forma intuitiva que si <span class="math inline">\(X_i\)</span> con <span class="math inline">\(i=1,2,\ldots, n\)</span> son v.a. <span class="math inline">\(Ber(p)\)</span> independientes entonces <span class="math inline">\(X=\displaystyle\sum_{i=1}^n X_i\)</span> sigue una distribución <span class="math inline">\(B(n,p).\)</span></p>
</div>
<p><strong>Resumen v.a con distribución binomial <span class="math inline">\(B(n,p)\)</span></strong></p>
<table>
<colgroup>
<col width="45%" />
<col width="29%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X\)</span> binomial</th>
<th align="left"><span class="math inline">\(B(n,p)\)</span></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\(\{0,1,\ldots n\}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll}{n\choose x}\cdot p^x\cdot (1-p)^{n-x} &amp; \mbox{ si } x=0,1,\ldots,n\\0 &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left">no tiene fórmula (utilizad funciones de <code>R</code> o python)</td>
<td></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\)</span></td>
<td align="left"><span class="math inline">\(n\cdot p\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(Var(X)=\)</span></td>
<td align="left"><span class="math inline">\(n\cdot p \cdot (1-p)\)</span></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Cálculos binomial con R</strong></p>
<p>Veamos los cálculos básicos con funciones de R para una v.a <span class="math inline">\(X\)</span> con distribución binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<p>Si queremos calcular con <code>R</code> algún valor de la función de distribución como por ejemplo <span class="math inline">\(F_X(0)=P(X\leq 0)\)</span>, tenemos que hacer:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">pbinom</span>(<span class="dv">0</span>,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.05631351</code></pre>
<p>y si queremos por ejemplo <span class="math inline">\(F_X(4)=P(X\leq 4)\)</span>, tenemos que hacer:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">pbinom</span>(<span class="dv">4</span>,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.9218731</code></pre>
<p>Sin embargo, si queremos calcular algún valor de la función de probabilidad como por ejemplo <span class="math inline">\(P(X=0)\)</span>, tenemos que hacer:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">dbinom</span>(<span class="dv">0</span>,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.05631351</code></pre>
<p>o por ejemplo para <span class="math inline">\(P(X=4)\)</span>:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">dbinom</span>(<span class="dv">4</span>,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.145998</code></pre>
<p><strong>Generación de muestras aleatorias con R</strong></p>
<p>Generaremos una muestra aleatoria de 100 valores de una población con distribución <span class="math inline">\(B(20,0.5)\)</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="kw">rbinom</span>(<span class="dv">100</span>,<span class="dt">size =</span> <span class="dv">20</span>,<span class="dt">prob=</span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>##   [1] 12 11  9 11  6  6 12  5  7 11 12 11  8  8 11 11  7 11  9 10  9 10 14
##  [24]  8  8  5 11 14 11 10 11  5 12  8  6  7  9 10  5 12 11  9 12 11 12 10
##  [47] 13 13  8  8  9  7  6  9 10  9 16 13  6  6  8  8 11  9 12 15  9  7 12
##  [70] 11  9  8  9  8 11 15  7 10  9 12  6 13 14  8 10  8 10 11 11  9 10 11
##  [93] 12  8 10 12  9 13  9 13</code></pre>
<div class="example">
<p><strong>Ejemplo</strong></p>
<p>El ejemplo anterior correspondería a repetir 100 veces el experimento de lanzar una moneda 20 veces y contar el número de caras.</p>
</div>
<p><strong>Cálculos distribución binomial con python</strong></p>
<p>Veamos los cálculos básicos con funciones de python para una v.a <span class="math inline">\(X\)</span> con distribución binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<p>Primero importamos la función <code>binom</code> de la librería <code>scipy.stat</code>:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb75-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> binom</a></code></pre></div>
<p>En general en el paquete <code>scipy</code>, la función de probabilidad se invocará con el método <code>pmf</code>, la de distribución con el método <code>cdf</code> mientras que una muestra aleatoria que siga esta distribución con el método <code>rvs</code>. En todos ellos aparecerá siempre el parámetro <code>loc</code> que se utiliza para desplazar el dominio de la variable aleatoria. Por ejemplo, en este caso:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb76-1" title="1">binom.pmf(k, n, p, loc) <span class="op">=</span>  binom.pmf(k <span class="op">-</span> loc, n, p)</a></code></pre></div>
<p>Para calcular los valores de la función de distribución como por ejemplo <span class="math inline">\(F_X(0)=P(X\leq 0)\)</span> y <span class="math inline">\(F_X(4)=P(X\leq 4)\)</span> utilizamos la función <code>cdf</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb77-1" title="1">binom.cdf(<span class="dv">0</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## 0.056313514709472656</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb79-1" title="1">binom.cdf(<span class="dv">4</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## 0.9218730926513672</code></pre>
<p>Notemos que al no indicar el valor de <code>loc</code>, se le asume que toma el valor 0.</p>
<p>Para calcular los valores de la función de probabilidad <span class="math inline">\(P(X=0)\)</span> y <span class="math inline">\(P(X=4)\)</span> utilizamos la función <code>pmf</code>:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb81-1" title="1">binom.pmf(<span class="dv">0</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## 0.056313514709472684</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb83-1" title="1">binom.pmf(<span class="dv">4</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## 0.14599800109863295</code></pre>
<p>Notemos que al no indicar el valor de <code>loc</code>, se le asume que toma el valor 0.</p>
<p>Si queremos generar una muestras aleatorias que siga una distribución binomial, podemos usar la función <code>rvs</code>. En este caso, generaremos una muestra aleatoria de 100 valores de una población <span class="math inline">\(B(20,0.5)\)</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb85-1" title="1">binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size <span class="op">=</span> <span class="dv">100</span>)</a></code></pre></div>
<pre><code>## array([ 5,  6,  6,  4,  5,  6, 11,  4,  7,  5,  2,  5,  5,  8,  2,  6,  4,
##         5,  4,  2,  3,  4,  4,  5,  2,  4,  4,  8,  4,  5,  3,  5,  6,  4,
##         3,  4,  3,  4,  5,  3,  4,  6,  5,  4,  2,  3,  3,  5,  8,  6,  7,
##         3,  5,  7,  3,  7,  6,  5,  5,  4,  6,  5,  4,  4,  5,  6,  5,  2,
##         8,  4,  2,  3,  0,  6,  6,  6,  3,  4,  5,  6,  6,  8,  6,  3,  3,
##         3,  2,  7,  7,  8,  7,  5,  8,  6,  6,  7,  4,  6,  5,  2])</code></pre>
<p><l class="observ"> <strong>Observación</strong></l></p>
<p>Notemos que la secuencia aleatoria generada no es la misma que con <code>R</code>. De hecho, si volvemos a ejecutar esta función obtendremos una muestra aleatoria distinta.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb87-1" title="1">binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size <span class="op">=</span> <span class="dv">100</span>)</a></code></pre></div>
<pre><code>## array([5, 4, 3, 4, 2, 6, 5, 9, 3, 3, 3, 5, 6, 1, 5, 3, 5, 4, 5, 6, 6, 7,
##        5, 2, 0, 4, 4, 3, 4, 3, 2, 5, 8, 6, 6, 4, 5, 6, 7, 5, 7, 5, 4, 5,
##        4, 0, 2, 3, 3, 7, 5, 1, 2, 3, 3, 8, 6, 7, 3, 7, 3, 3, 5, 2, 3, 5,
##        4, 9, 6, 4, 6, 7, 4, 5, 2, 7, 7, 4, 6, 7, 6, 8, 5, 7, 9, 4, 5, 6,
##        6, 7, 5, 8, 7, 1, 5, 5, 5, 6, 4, 5])</code></pre>
</div>
<p>Veamos algunos cálculos básicos con funciones de python para la binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb89-1" title="1">binom.cdf(<span class="dv">5</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## 0.9802722930908203</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb91-1" title="1">binom.pmf(<span class="dv">1</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## 0.18771171569824247</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb93-1" title="1">binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size<span class="op">=</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## array([6, 5, 6, 6, 5, 4, 6, 5, 4, 2])</code></pre>
<p><strong>Gráficas de la distribución binomial con <code>R</code></strong></p>
<p>El siguiente código de <code>R</code> dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(B(n=10,p=0.25)\)</span>:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb95-2" title="2">aux=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>)</a>
<a class="sourceLine" id="cb95-3" title="3">aux[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">22</span>,<span class="dv">2</span>)]=<span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb95-4" title="4"><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),<span class="dt">y=</span><span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb95-5" title="5">  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb95-6" title="6">  <span class="dt">main=</span><span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> B(n=10,p=0.25)&quot;</span>)</a>
<a class="sourceLine" id="cb95-7" title="7"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb95-8" title="8"><span class="kw">curve</span>(<span class="kw">pbinom</span>(x,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb95-9" title="9">  <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb95-10" title="10">  <span class="dt">main=</span><span class="st">&quot;Función de distribución\n B(n=10,p=0.25)&quot;</span>)</a>
<a class="sourceLine" id="cb95-11" title="11"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Gráficas interactivas de la distribución binomial</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb96-3" title="3">  <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb96-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;n_binom&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número de repeticiones n:&quot;</span>,</a>
<a class="sourceLine" id="cb96-5" title="5">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">50</span>, <span class="dt">value =</span><span class="dv">10</span> , <span class="dt">step =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb96-6" title="6">  <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb96-7" title="7">          <span class="kw">sliderInput</span>(<span class="st">&quot;p_binom&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Probabilidad éxito p:&quot;</span>,</a>
<a class="sourceLine" id="cb96-8" title="8">                     <span class="dt">min =</span> <span class="fl">0.01</span>, <span class="dt">max =</span> <span class="fl">0.99</span>, <span class="dt">value =</span> <span class="fl">0.25</span>, <span class="dt">step =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb96-9" title="9">         )</a>
<a class="sourceLine" id="cb96-10" title="10">  )</a>
<a class="sourceLine" id="cb96-11" title="11">)</a>
<a class="sourceLine" id="cb96-12" title="12"></a>
<a class="sourceLine" id="cb96-13" title="13"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb96-14" title="14">  n=input<span class="op">$</span>n_binom</a>
<a class="sourceLine" id="cb96-15" title="15">  pr=input<span class="op">$</span>p_binom</a>
<a class="sourceLine" id="cb96-16" title="16">  </a>
<a class="sourceLine" id="cb96-17" title="17">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb96-18" title="18">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb96-19" title="19">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">size=</span>n,<span class="dt">prob=</span>pr)</a>
<a class="sourceLine" id="cb96-20" title="20">  <span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">size=</span>n,<span class="dt">prob=</span>pr),</a>
<a class="sourceLine" id="cb96-21" title="21">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb96-22" title="22">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> B(n=&quot;</span>,n,<span class="st">&quot;,p=&quot;</span>,pr,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb96-23" title="23">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb96-24" title="24">  <span class="kw">curve</span>(<span class="kw">pbinom</span>(x,<span class="dt">size=</span>n,<span class="dt">p=</span>pr),</a>
<a class="sourceLine" id="cb96-25" title="25">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb96-26" title="26">        <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de distribución\n B(n=&quot;</span>,n,<span class="st">&quot;,p=&quot;</span>,pr,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb96-27" title="27">                    <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb96-28" title="28">        <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb96-29" title="29">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_bino1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Gráficos de la distribución binomial con python</strong></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Buscad en la documentación de python cómo se dibuja la función de probabilidad y de distribución de una binomial y recread los gráficos anteriores.</p>
<div class="exercise-sol">
<p>Pista: Necesitaremos investigar más librerías:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb97-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb97-2" title="2"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb98-1" title="1">n, p <span class="op">=</span> <span class="dv">10</span>, <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb98-2" title="2">x <span class="op">=</span> np.arange(binom.ppf(<span class="fl">0.01</span>, n, p),binom.ppf(<span class="fl">0.99</span>, n, p))</a>
<a class="sourceLine" id="cb98-3" title="3">fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</a>
<a class="sourceLine" id="cb98-4" title="4">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb98-5" title="5">ax.plot(x, binom.pmf(x, n, p), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span><span class="st">&#39;binom pmf&#39;</span>)</a>
<a class="sourceLine" id="cb98-6" title="6">ax.vlines(x, <span class="dv">0</span>, binom.pmf(x, n, p), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb98-7" title="7"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb98-8" title="8">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-9" title="9"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb98-10" title="10">  tick.label.set_fontsize(<span class="dv">5</span>) </a>
<a class="sourceLine" id="cb98-11" title="11">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb98-12" title="12">ax.plot(x, binom.cdf(x, n, p), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span><span class="st">&#39;binom pmf&#39;</span>)</a>
<a class="sourceLine" id="cb98-13" title="13">ax.vlines(x, <span class="dv">0</span>, binom.cdf(x, n, p), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb98-14" title="14"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb98-15" title="15">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-16" title="16"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb98-17" title="17">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb98-18" title="18">fig.suptitle(<span class="st">&#39;Distribucion Binomial&#39;</span>)</a>
<a class="sourceLine" id="cb98-19" title="19">plt.show()</a></code></pre></div>
<div class="center">
<p><img src="curso-probabilidad-udemy_files/figure-html/dibu_python2-1.png" width="480" /></p>
</div>
</div>
</div>
<div class="example">
<p><strong>Ejemplo: número de bolas rojas extraídas de una urna con reposición</strong></p>
<p>Tenemos una urna con <span class="math inline">\(100\)</span> bolas de las cuales 40 son rojas y 60 son blancas. Extraemos al azar una bola, anotamos su color y la devolvemos a (reponemos en) la urna.</p>
<p>Supongamos que repetimos este proceso <span class="math inline">\(n=10\)</span> reponiendo en cada ocasión la bola extraída.</p>
<p>Consideremos la variable aleatoria <span class="math inline">\(X\)</span> como el número de bolas rojas extraídas (con reposición) en <span class="math inline">\(n=10\)</span> repeticiones del mismo experimento de Bernoulli.</p>
<p>Bajo estas condiciones repetimos <span class="math inline">\(n=10\)</span> veces el mismo experimento de Bernoulli con probabilidad de éxito (sacar bola roja)
<span class="math display">\[P(Roja)=P(Éxito)=p=\frac{40}{100}=0.4.\]</span></p>
<p>Así que la variable <span class="math inline">\(X\)</span> que es el número de bolas rojas extraídas de la urna (con reposición) en <span class="math inline">\(n=10\)</span> ocasiones sigue una ley binomial <span class="math inline">\(B(n=10,p=0.4).\)</span></p>
<p>Nos preguntamos:</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que saquemos exactamente <span class="math inline">\(4\)</span> bolas rojas?</li>
<li>¿Cuál es la probabilidad de que saquemos al menos <span class="math inline">\(4\)</span> bolas rojas?</li>
<li>¿Cuál es la probabilidad de que saquemos menos de <span class="math inline">\(3\)</span> bolas rojas?</li>
<li>¿Cuál es el valor esperado del número de bolas rojas?</li>
<li>¿Cuál es la desviación típica del número de bolas rojas?</li>
</ol>
<div class="example-sol">
<p><strong>Solución 1</strong>. ¿Cuál es la probabilidad de que saquemos exactamente <span class="math inline">\(4\)</span> rojas?</p>
<p>Utilizando la función de probabilidad, tenemos que:
<span class="math display">\[
\begin{array}{ll}
P(X=4)&amp;={10\choose 4}\cdot 0.4^4\cdot (1-0.4)^{10-4}
= \frac{10!}{(10-4)!\cdot 4!}\cdot 0.4^4\cdot 0.6^6\\
&amp;= \frac{7\cdot 8\cdot 9\cdot 10}{1\cdot 2\cdot 3\cdot 4}\cdot 0.4^4\cdot 0.6^6=0.2508227.
\end{array}
\]</span></p>
<p>Con <code>R</code>:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">dbinom</span>(<span class="dv">4</span>,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob =</span> <span class="fl">0.4</span>)</a></code></pre></div>
<pre><code>## [1] 0.2508227</code></pre>
</div>
<div class="example-sol">
<p><strong>Solución 2</strong>. ¿Cuál es la probabilidad de que saquemos al menos <span class="math inline">\(4\)</span> bolas rojas?</p>
<p>La probabilidad de sacar al menos 4 rojas se expresa como <span class="math inline">\(P(X \geq 4)=1-P(X&lt;4)=1-P(X\leq 3):\)</span>
<span class="math display">\[
\begin{array}{rl}
P(X\leq 3)&amp; = P(X=0)+P(X=1)+P(X=2)+P(X=3)\\
&amp;= 
 {10\choose 0}\cdot 0.4^0\cdot (1-0.4)^{10-0}+ {10\choose 1}\cdot 0.4^1\cdot (1-0.4)^{10-1}\\
&amp;+{10\choose 2}\cdot 0.4^2\cdot (1-0.4)^{10-2}+ {10\choose 3}\cdot 0.4^3\cdot (1-0.4)^{10-3}\\
&amp;=0.3822806.
\end{array}
\]</span></p>
<p>Con <code>R</code>:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</a></code></pre></div>
<pre><code>## [1] 0.3822806</code></pre>
<p>Así que</p>
<p><span class="math display">\[P(X \geq 4 )=1-P(X&lt; 4)=P(X\leq 3)=1-0.3822806=0.6177194.\]</span></p>
<p>Otra manera usando <code>R</code> sería:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</a></code></pre></div>
<pre><code>## [1] 0.6177194</code></pre>
<p>Aunque en estos casos el parámetro <code>lower.tail = FALSE</code> es sin duda nuestra mejor opción:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="kw">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.6177194</code></pre>
</div>
<div class="example-sol">
<p><strong>Solución 3</strong>. ¿Cuál es la probabilidad de que saquemos menos de <span class="math inline">\(3\)</span> bolas rojas?</p>
<p><span class="math display">\[
\begin{array}{ll}
P(X&lt; 3)&amp;= P(X\leq 2)=  P(X=0)+P(X=1)+P(X=2)\\
&amp;=
{10\choose 0}\cdot 0.4^0\cdot (1-0.4)^{10-0}+ {10\choose 1}\cdot 0.4^1\cdot (1-0.4)^{10-1}\\
&amp;+
{10\choose 2}\cdot 0.4^2\cdot (1-0.4)^{10-2}\\
&amp;=0.1672898.
\end{array}
\]</span></p>
<p>En <code>R</code>:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">dbinom</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)<span class="op">+</span><span class="kw">dbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)<span class="op">+</span><span class="kw">dbinom</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</a></code></pre></div>
<pre><code>## [1] 0.1672898</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="kw">pbinom</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</a></code></pre></div>
<pre><code>## [1] 0.1672898</code></pre>
</div>
<div class="example-sol">
<p><strong>Solución 4</strong>. ¿Cuál es el valor esperado del número de bolas rojas?</p>
<p>Como <span class="math inline">\(X\)</span> es una <span class="math inline">\(B(n=10,p=0.4)\)</span> sabemos que</p>
<p><span class="math display">\[E(X)=n\cdot p = 10\cdot 0.4=4.\]</span></p>
<p>Aunque en python tenemos la función <code>stats</code> que nos lo calcula directamente:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb111-1" title="1"><span class="bu">print</span>(<span class="st">&quot;E(X) = </span><span class="sc">{m}</span><span class="st">&quot;</span>.<span class="bu">format</span>(m<span class="op">=</span>binom.stats(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.4</span>, moments<span class="op">=</span><span class="st">&#39;m&#39;</span>)))</a></code></pre></div>
<pre><code>## E(X) = 4.0</code></pre>
</div>
<div class="example-sol">
<p><strong>Solución 5</strong>. ¿Cuál es la desviación típica del número de bolas rojas?</p>
<p>La varianza es:
<span class="math display">\[
Var(X)=n\cdot p \cdot(1-p)=10\cdot 0.4\cdot 0.6=2.4.
\]</span>
Por lo tanto, la desviación típica es:</p>
<p><span class="math display">\[\sqrt{Var(X)}=\sqrt{2.4}= 1.5491933.\]</span></p>
<p>Aunque en python tenemos la función <code>stats</code> que nos lo calcula directamente:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb113-1" title="1"><span class="bu">print</span>(<span class="st">&quot;Var(X) = </span><span class="sc">{v}</span><span class="st">&quot;</span>.<span class="bu">format</span>(v<span class="op">=</span>binom.stats(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.4</span>, moments<span class="op">=</span><span class="st">&#39;v&#39;</span>)))</a></code></pre></div>
<pre><code>## Var(X) = 2.4</code></pre>
</div>
</div>
</div>
<div id="distribución-geométrica" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Distribución geométrica</h3>
<p>Todos hemos jugado a, por ejemplo, tirar una moneda hasta que obtengamos la primera cara.</p>
<p>O también tirar una pelota a una canasta de baloncesto hasta obtener la primera canasta.</p>
<p>Desde otro punto de vista también podemos intentar modelar el número de veces que accionamos una interruptor y la bombilla se ilumina hasta que falla.</p>
<p>O también el número de veces que un cajero automático nos da dinero hasta que falla.</p>
<p>La <strong>modelización de este tipo de problemas se consigue con la llamada distribución geométrica</strong>.</p>
<p><l class="definition"> <strong>Distribución geométrica</strong> </l></p>
<p>Repitamos un experimento Bernoulli, de parámetro <span class="math inline">\(p\)</span>, de forma independiente hasta obtener el primer éxito.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de fracasos antes del primer éxito. Por ejemplo que hayamos tenido <span class="math inline">\(x\)</span> fracasos será una cadena de <span class="math inline">\(x\)</span> fracasos culminada con un éxito. Más concretamente</p>
<p><span class="math display">\[P(\overbrace{FFF\ldots F}^{x}E)=P(F)^{x}\cdot P(E)=(1-p)^{x}\cdot p=q^{x}\cdot p.\]</span>
Su función de probabilidad es:
<span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}
(1-p)^{x}\cdot p, &amp; \mbox{ si } x=0,1,2,\ldots,\\
0, &amp;\mbox{ en otro caso.}
\end{array}\right.
\]</span>
La v.a. definida anteriormente diremos que sigue una distribución geométrica de parámetro <span class="math inline">\(p\)</span>. La denotaremos por <span class="math inline">\(Ge(p)\)</span>.
Su dominio será: <span class="math inline">\(D_X=\{0,1,2,\ldots\}\)</span>.</p>
<p>Calculemos como ejemplo P(<span class="math inline">\(X\leq 3\)</span>).
Por la propiedad de la probabilidad del suceso complementario tenemos que</p>
<p><span class="math display">\[
P(X\leq 3 )=1-P(X&gt; 3)=1-P(X\geq 4)
\]</span></p>
<p>Efectivamente, el complementario del evento <span class="math inline">\(X\leq 3\)</span> nos dice que hemos fracasado más de tres veces hasta conseguir el primer éxito, es decir, <strong>hemos fracasado 4 o más veces</strong>. Podemos simbolizar dicho evento de la forma siguiente:
<span class="math display">\[
\{X&gt;3\}=\{X\geq 4\}= \{FFFF\}
\]</span></p>
<p>Ahora, al ser los intentos independientes, tenemos que:
<span class="math display">\[
\begin{array}{ll}
P(X&gt;3) &amp; =  P(\{FFFF\})= P(F)\cdot P(F)\cdot P(F)\cdot P(F)\\
&amp;= (1-p)\cdot (1-p)\cdot (1-p)\cdot (1-p)= (1-p)^{3+1}=(1-p)^{4}.
\end{array}
\]</span></p>
<p>El valor de la función de distribución de <span class="math inline">\(X\)</span> en <span class="math inline">\(x=3\)</span> será, pues:
<span class="math display">\[F_X(3)=P(X\leq 3)=1-P(X&gt;3)=1-(1-p)^{3+1}.\]</span>
Generalizando el resultado anterior a cualquier entero positivo <span class="math inline">\(k=0,1,2,\ldots\)</span>, tenemos:
<span class="math display">\[F_X(k)=P(X\leq k)=1-(1-p)^{k+1},\mbox{ si } k=0,1,2,\ldots\]</span></p>
<p>En general, tendremos que:
<span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{\begin{array}{ll} 
0, &amp; \mbox{ si } x&lt;0,\\
1- (1-p),  &amp; \mbox{ si } k=0\leq x &lt;1,\\
1- (1-p)^2, &amp; \mbox{ si } k=1\leq x &lt;2,\\
1- (1-p)^3, &amp; \mbox{ si } k=2\leq x &lt;3,\\
1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,2,\ldots\end{array}
    \right.\end{array}\right.
\]</span>
De forma más compacta, tendremos que
<span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{\begin{array}{ll} 
0, &amp; \mbox{ si } x&lt;0,\\
1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,2,\ldots\end{array}
    \right.\end{array}
    \right.
\]</span></p>
<p>Notemos que el límite de la función de distribución es:
<span class="math display">\[
\displaystyle\lim_{k\to +\infty } F_X(k)=\lim_{k\to +\infty } 1-(1-p)^{k+1}=
1,
\]</span>
ya que <span class="math inline">\(0&lt;1-p&lt;1\)</span>.</p>
<p><strong>Sumas derivadas series geométricas</strong></p>
<p>Recordemos las propiedades siguientes del tema de variables aleatorias:</p>
<ul>
<li>Si <span class="math inline">\(|r|&lt;1\)</span> también son convergentes las derivadas, respecto de <span class="math inline">\(r\)</span>, de la serie geométrica y convergen a la derivada correspondiente. Así, tenemos que:
<span class="math display">\[
\begin{array}{ll}
\left(\sum_{k=0}^{+\infty} r^k\right)&#39; &amp;= \sum_{k=1}^{+\infty}k\cdot
r^{k-1}\\
&amp;= \left(\frac{1}{1-r}\right)&#39;=\frac{1}{(1-r)^2}.\\
\left(\sum_{k=0}^{+\infty} r^k\right)^{&#39;&#39;} &amp;= \sum_{k=2}^{+\infty}k \cdot(k-1)\cdot r^{k-2} \\
&amp;= \left(\frac{1}{1-r}\right)^{&#39;&#39;}=\frac{2}{(1-r)^3}.
\end{array}
\]</span></li>
</ul>
<p><strong>Esperanza de una v.a. <span class="math inline">\(Ge(p)\)</span></strong></p>
<p>Recordemos que <span class="math inline">\(P(X=x)=(1-p)^x\cdot p\)</span> si <span class="math inline">\(x=0,1,2,\ldots\)</span> y aplicado la fórmula anterior con <span class="math inline">\(r=1-p\)</span>, tenemos:
<span class="math display">\[
\begin{array}{rll}
E(X)&amp;=&amp;\sum_{x=0}^{+\infty} x\cdot P_x(x)=\sum_{x=0}^{+\infty} x\cdot (1-p)^x\cdot p=
p\cdot (1-p) \cdot \sum_{x=1}^{+\infty} x\cdot (1-p)^{x-1}\\
&amp;=&amp; p\cdot (1-p)\cdot \frac{1}{(1-(1-p))^2}=p\cdot (1-p)\cdot \frac{1}{p^2}=\frac{1-p}{p}.
\end{array}
\]</span></p>
<p><strong>Valor <span class="math inline">\(E(X^2)\)</span> de una v.a. <span class="math inline">\(Ge(p)\)</span></strong></p>
<p><span class="math display">\[
\begin{array}{rll}
E(X^2)&amp;=&amp;\sum_{x=0}^{+\infty} x^2\cdot P_X(x)=\sum_{x=1}^{+\infty} x^2\cdot (1-p)^x\cdot p\\
&amp;=&amp; 
\sum_{x=1}^{+\infty} (x\cdot (x-1)+x)\cdot (1-p)^{x}\cdot p\\
&amp;=&amp;
\sum_{x=1}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x}\cdot p+\sum_{x=1}^{+\infty} x \cdot (1-p)^{x}\cdot p\\
&amp;=&amp;
(1-p)^{2}\cdot p\cdot \sum_{x=2}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x-2}\\ 
&amp; &amp; +    (1-p)\cdot p\sum_{x=1}^{+\infty} x \cdot (1-p)^{x-1} 
\\  &amp;=&amp;
(1-p)^{2}\cdot p\cdot \sum_{x=2}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x-2}\\ 
&amp; &amp;+   (1-p)\cdot p\sum_{x=1}^{+\infty} x \cdot (1-p)^{x-1}\\
&amp;=&amp;
p\cdot (1-p)^2 \frac{2}{(1-(1-p))^3}+  (1-p)\cdot p \frac{1}{(1-(1-p))^2}\\
&amp;=&amp;
p\cdot (1-p)^2 \frac{2}{p^3}+  (1-p)\cdot p \frac{1}{p^2}\\
&amp;=&amp;\frac{2\cdot (1-p)^2}{p^2}+\frac{1-p}{p}.
\end{array}
\]</span></p>
<p><strong>Varianza de una v.a. <span class="math inline">\(Ge(p)\)</span></strong></p>
<p><span class="math display">\[
\begin{array}{rll}
Var(X)&amp;=&amp;E(X^2)-E(X)^2=\frac{2\cdot (1-p)^2}{p^2}+\frac{1-p}{p}-\left(\frac{1-p}{p}\right)^2\\
&amp;=&amp;
\frac{2\cdot (1-p)^2+p\cdot(1-p)-(1-p)^2}{p^2}=\frac{(1-p)^2+p\cdot(1-p)}{p^2}\\
&amp;=&amp;
\frac{1-2\cdot p + p^2+p-p^2}{p^2}\\
&amp;=&amp; \frac{1-p}{p^2},
\end{array}
\]</span>
y su desviación típica será
<span class="math display">\[\sqrt{Var(X)}=\sqrt{\frac{1-p}{p^2}}.\]</span></p>
<p><strong>Resumen <span class="math inline">\(Ge(p)\)</span> empezando en 0$</strong></p>
<table>
<colgroup>
<col width="53%" />
<col width="46%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X=\)</span> Geométrica (empieza en <span class="math inline">\(0\)</span>)</th>
<th align="left">número de fracasos para conseguir el primer éxito</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\(\{0,1,\ldots n,\ldots\}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll}(1-p)^{x}\cdot p, &amp; \mbox{ si } x=0,1,2,\ldots \\0, &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} 0 &amp; \mbox{ si } x&lt;0\\  1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,2,\ldots\end{array}  \right.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\frac{1-p}{p}\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=\frac{1-p}{p^2}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>La variable geométrica que cuenta los intentos para obtener el primer éxito</strong></p>
<p>Supongamos que sólo estamos interesados en el <strong>número de intentos</strong> para obtener el primer éxito.</p>
<p>Si definimos <span class="math inline">\(Y\)</span> como número de intentos para obtener el primer éxito, entonces <span class="math inline">\(Y=X+1\)</span>, donde <span class="math inline">\(X\equiv Ge(p)\)</span>.</p>
<p>Su dominio es <span class="math inline">\(D_Y=\{1,2,\ldots\}\)</span></p>
<p>La media se incrementa en un intento debido al éxito <span class="math inline">\(E(Y)=E(X+1)=E(X)+1=\frac{1-p}{p}+1=\frac1{p}\)</span>.</p>
<p>La varianza es la misma <span class="math inline">\(Var(Y)=Var(X+1)=Var(X)=\frac{1-p}{p^2}\)</span>.</p>
<p><strong>Resumen <span class="math inline">\(Ge(p)\)</span> comenzando en <span class="math inline">\(1\)</span></strong></p>
<table>
<colgroup>
<col width="53%" />
<col width="46%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(Y\)</span> geométrica (que cuenta el éxito empieza en 1)</th>
<th align="left">número de INTENTOS para OBTENER el primer éxito</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_Y=\)</span></td>
<td align="left"><span class="math inline">\(\{1,2,\ldots n,\ldots\}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_Y(y)=P(Y=y)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll}(1-p)^{y-1}\cdot p, &amp; \mbox{ si } y=1,2,3,\ldots\\ 0, &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_Y(y)=P(Y\leq y)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} 0, &amp; \mbox{ si } y&lt;1\\ 1- (1-p)^{k}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq y&lt; k+1,\\\mbox{para } k=1,2,3,\dots \end{array} \right.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\frac1{p}\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=\frac{1-p}{p^2}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Propiedad de la falta de memoria</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. discreta con dominio <span class="math inline">\(D_X=\{0,1,2,\ldots\}\)</span>, con <span class="math inline">\(P(X=0)=p\)</span>.</p>
<p>Entonces <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(Ge(p)\)</span> si, y sólo si,
<span class="math display">\[
P\left(X&gt; k+j\big| X\geq j\right)=P(X&gt; k)
\]</span>
para todo <span class="math inline">\(k,j=0,1,2,3\ldots\)</span>.</p>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Si <span class="math inline">\(X\)</span> es geométrica, entonces el lado derecho de la igualdad es</p>
<p><span class="math display">\[
P(X&gt;k)=1-P(X\leq k)=1-\left(1-(1-p)^{k+1}\right)=(1-p)^{k+1},
\]</span>
y el lado de izquierdo es:
<span class="math display">\[
\begin{array}{rll} 
P\left(X&gt; k+j\big| X\geq j\right)&amp;=&amp;\frac{P\left(\{X&gt; k+j\}\cap \{X\geq j\} \right)}{P\left(X\geq j\right)}=
\frac{P\left(X&gt;k+j \right)}{P\left(X\geq j \right)} = \frac{1-P(X\leq k+j)}{1-P(X\leq j-1)}\\
&amp;=&amp;  \frac{1-(1-(1-p)^{k+j+1})}{1-(1-(1-p)^{j-1+1})} =\frac{(1-p)^{k+j+1}}{(1-p)^{j}} = (1-p)^{k+1},
\end{array}
\]</span>
lo que demuestra la igualdad.</p>
<p>Para demostrar el recíproco, tomemos <span class="math inline">\(j=1\)</span> y <span class="math inline">\(k\geq 0\)</span>. Entonces, por la propiedad de la pérdida de memoria:
<span class="math display">\[
P\left(X&gt; k+1\big| X\geq 1\right)=P(X&gt; k)
\]</span></p>
<p>Como <span class="math inline">\(P(X=0)=p\)</span>, tenemos que <span class="math inline">\(P(X \geq 1 )=1-P(X&lt;1)=1-P(X=0)=1-p\)</span>.</p>
<p>Combinado las igualdades, tenemos que:
<span class="math display">\[
P\left(X&gt; k+1\big| X\geq 1\right)=\frac{P(X&gt;k+1, X\geq 1)}{P(X\geq 1)}=\frac{P(X&gt;k+1)}{P(X\geq 1)}=P(X&gt;k).
\]</span>
Así podemos poner que</p>
<p><span class="math display">\[
\begin{array}{rll}
P(X&gt;k+1)&amp;=&amp;P(X\geq 1)\cdot P(X&gt;k)=\left(1-P(X&lt;1)\right)\cdot P(X&gt;k)\\
&amp;=&amp;\left(1-P(X=0)\right)\cdot P(X&gt;k)=(1-p)\cdot P(X&gt;k).
\end{array}
\]</span></p>
<p>En general tenemos que:</p>
<p><span class="math display">\[
P(X&gt;k+1)=(1-p)\cdot P(X&gt;k).
\]</span>
Del mismo modo para <span class="math inline">\(j=2\)</span>,
<span class="math display">\[
P(X&gt;k+2)=(1-p)\cdot P(X&gt;k+1).
\]</span>
Restando la primera igualdad de la última obtenemos:
<span class="math display">\[
P(X&gt;k+1)-P(X&gt;k+2)=(1-p)\cdot P(X&gt;k)-(1-p)\cdot P(X&gt;k+1),
\]</span>
de donde operando en cada lado de la igualdad obtenemos la recurrencia:
<span class="math display">\[
[1-P(X\leq k+1)]-[1-P(X\leq k+2)]=(1-p)\cdot [P(X&gt;k)-P(X&gt;k+1)]
\]</span></p>
<p>Ahora operando,
<span class="math display">\[
\begin{array}{rl}
P(X\leq k+2)-P(X\leq k+1) &amp; =(1-p)\cdot[1-P(X\leq k)-\left(1-P(X\leq k+1)\right)],\\
P(X=k+2) &amp; =(1-p)\cdot[P(X\leq k+1)-P(X\leq k)], \\
P(X=k+2) &amp; =(1-p)\cdot P(X=k+1).
\end{array}
\]</span>
De forma similar, obtenemos</p>
<p><span class="math display">\[
P(X=k+1)=(1-p)\cdot P(X=k).
\]</span>
Utilizando la recurrencia anterior, podemos calcular todas las probabilidades <span class="math inline">\(P(X=k)\)</span> a partir de la <span class="math inline">\(P(X=0)=p\)</span>:
<span class="math display">\[
\begin{array}{rl}
P(X=0)&amp;= p,\\
P(X=1)&amp;=P(X=0+1)= (1-p)\cdot P(X=0) =(1-p)\cdot  p,\\
P(X=2)&amp;=P(X=1+1)= (1-p)\cdot P(X=1)=(1-p)\cdot (1-p)\cdot p=(1-p)^2\cdot p,\\
 \vdots&amp; \vdots \\
P(X=k)&amp;=P(X=(k-1)+1)= (1-p)\cdot P(X=k-1)=(1-p)\cdot (1-p)^{k-1}\cdot p \\
&amp; =(1-p)^{k}\cdot p,
\end{array}
\]</span>
lo que demuestra el recíproco, es decir, que <span class="math inline">\(X\)</span> es <span class="math inline">\(Geom(p)\)</span>.</p>
</div>
<p><l class="observ"> <strong>Observación: Interpretación de la propiedad de la falta de memoria</strong></l></p>
<p>La propiedad de la falta de memoria
<span class="math display">\[
P(X&gt; k+j\big|X \geq j)=P(X &gt; k),
\]</span><br />
significa que, aunque <strong>ya llevemos al menos <span class="math inline">\(j\)</span> fracasos</strong>, la probabilidad de <strong>que fracasemos <span class="math inline">\(k\)</span> veces más</strong> no disminuye, es la misma que era cuando empezamos el experimento.</p>
<p>A este efecto se le suele etiquetar con la frase <strong>el experimento carece de memoria</strong> o es un <strong>experimento sin memoria</strong> (<em>Memoryless Property</em>).</p>
<p><strong>Ejemplo falta de memoria</strong></p>
<p>Un ejemplo muy sencillo nos aclarará el alcance de esta propiedad es el ejercicio siguiente:</p>
<div class="exercise">
<p><strong>Ejercicio: la llave que abre la puerta</strong></p>
<p>Tenemos un llavero con 10 llaves, sólo una de ellas abre una puerta. Cada vez que probamos una llave y falla olvidamos que llave hemos probado. ¿Cuál es la probabilidad de que si ya lo hemos intentado 5 veces necesitemos más de 4 intentos adicionales para abrir la puerta?</p>
<div class="example-sol">
<p>Tomemos <span class="math inline">\(k=4,j=5\)</span>, aplicando la propiedad de la falta de memoria</p>
<p><span class="math display">\[
P(X&gt; 4+5/X \geq 5)=P(X &gt; 4)
\]</span></p>
<p>Después de 5 fracasos no estamos “más cerca” de abrir la puerta.
La propiedad de la falta de memoria nos dice que en <strong>después de cada intento es como si empezásemos de nuevo a abrir la puerta</strong>. Tras 5 fracasos la probabilidad de que fallemos más de 4 veces más es la misma que cuando lo intentamos la primera vez.</p>
<p>¿Cuál es el número esperado de fracasos hasta abrir la puerta?</p>
<p><span class="math display">\[
E(X)=\frac{1-p}{p}=\frac{1-\frac{1}{10}}{\frac{1}{10}}=\frac{\frac{9}{10}}{\frac{1}{10}}=9.
\]</span></p>
<p>La varianza es
<span class="math display">\[
Var(X)=\frac{1-p}{p^2}=\frac{1-\frac{1}{10}}{\left(\frac{1}{10}\right)^2}=\frac{\frac{9}{10}}{\frac{1}{100}}=
90.
\]</span></p>
<p>La desviación típica es <span class="math inline">\(\sqrt{90}=9.486833.\)</span></p>
</div>
</div>
<div class="exercise">
<p><strong>Ejemplo: partidos hasta que el Barça gana al Madrid</strong></p>
<p>Los partidos Real Madrid vs FC Barcelona de <strong>la liga</strong> española se suelen denominar <strong>El Clásico</strong>, sean en el Bernabeu (estadio del Real Madrid) o en el Camp Nou (estadio del Barça)</p>
<p>Sea <span class="math inline">\(X\)</span> la variable que cuenta el número de veces consecutivas que en un partido de fútbol de la liga el Barça no gana al Madrid sea en el Camp Nou o el Bernabeu.</p>
<p>Nuestra amiga Aina es muy culé (hincha del Barça) y quiere averiguar cuántos partidos consecutivos de <strong>El Clásico</strong> tiene que ver hasta ver ganar al Barça por primera vez.</p>
<p>Le interesa estimar cuánto le va a costar este capricho. Tendrá que comprar las entradas y pagar los viajes de Barcelona a Madrid.</p>
<p>En <a href="https://es.wikipedia.org/wiki/El_Cl%C3%A1sico">datos historicos de <strong>El clásico</strong> en la wikipedia</a> están los datos hasta el 3 de marzo de 2019: se han jugado en total 178 <strong>Clásicos</strong> donde el Real Madrid ganó en 72 ocasiones, el Barça, en 72 y empataron 34 veces.</p>
<p>La pregunta es: ¿Cuántos partidos se tienen que jugar de media para ver ganar al Barça por primera vez?</p>
<div class="example-sol">
<p>Con los datos anteriores, podemos estimar que la probabilidad de que el Barça gane un clásico cualquiera es:
<span class="math display">\[P(\mbox{Barça})=\frac{72}{178}=0.4045.\]</span></p>
<p>Por tanto, podemos modelar la variable <span class="math inline">\(X\)</span> con una ley geométrica con probabilidad de éxito <span class="math inline">\(p=P(\mbox{Barça})=\frac{72}{178}.\)</span></p>
<p>El número de partidos esperado para que el Barça gane por primera vez es:</p>
<p><span class="math display">\[E(X)=\frac{1-p}{p}=\frac{1-0.4045}{0.4045}=1.4722,\]</span>
con una varianza de:
<span class="math display">\[Var(X)=\frac{1-p}{p^2}=\frac{1-0.4045}{0.4045^2}=3.6397\]</span>
y desviación típica:
<span class="math display">\[\sqrt{3.6397}=1.9078.\]</span></p>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Veamos los cálculos básicos con <code>R</code> para la distribución geométrica <span class="math inline">\(Ge(p=0.25)\)</span>. <code>R</code> implementa la geométrica que cuenta el número de fracasos, <span class="math inline">\(P(X=0)=(1-0.25)^0\cdot 0.25^1=0.25\)</span>:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">dgeom</span>(<span class="dv">0</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<p><span class="math inline">\(P(X\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25\)</span>:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">pgeom</span>(<span class="dv">0</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<p><span class="math inline">\(P(X\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=0.7626953\)</span>:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">pgeom</span>(<span class="dv">4</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>## [1] 0.7626953</code></pre>
<p>Una muestra aleatoria de tamaño 25 de una <span class="math inline">\(Ge(0.25)\)</span>:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">rgeom</span>(<span class="dt">n=</span><span class="dv">25</span>,<span class="dt">prob=</span><span class="fl">0.25</span>)</a></code></pre></div>
<pre><code>##  [1]  5  4  1  6 10  0  0 10  7  0  6  2  1  3  0  2  5  0  0  5  5  3  3
## [24]  2  2</code></pre>
<p><strong>Gráficos con <code>R</code></strong></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb123-2" title="2">x=<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="kw">plot</span>(<span class="dt">x=</span>x,<span class="dt">y=</span><span class="kw">dgeom</span>(x,<span class="dt">prob=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb123-4" title="4">  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb123-5" title="5">  <span class="dt">main=</span><span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> Ge(p=0.25)&quot;</span>)</a>
<a class="sourceLine" id="cb123-6" title="6"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb123-7" title="7">aux0=<span class="kw">dgeom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),<span class="dt">prob=</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb123-8" title="8">ceros=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb123-9" title="9">ceros</a>
<a class="sourceLine" id="cb123-10" title="10">aux=ceros</a>
<a class="sourceLine" id="cb123-11" title="11">aux[<span class="dv">2</span><span class="op">*</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">11</span>))]&lt;-aux0</a>
<a class="sourceLine" id="cb123-12" title="12"><span class="kw">curve</span>(<span class="kw">pgeom</span>(x,<span class="dt">prob=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb123-13" title="13">  <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">10</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb123-14" title="14">  <span class="dt">main=</span><span class="st">&quot;Función de distribución\n Ge(p=0.25)&quot;</span>)</a>
<a class="sourceLine" id="cb123-15" title="15"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/graficos22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Gráficas interactivas geométrica</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">sliderInput</span>(<span class="st">&quot;p_geom&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Probabilidad de éxito:&quot;</span>,</a>
<a class="sourceLine" id="cb124-2" title="2">              <span class="dt">min =</span> <span class="fl">0.01</span>, <span class="dt">max =</span> <span class="fl">0.99</span>, <span class="dt">value =</span><span class="fl">0.25</span> , <span class="dt">step =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb124-3" title="3"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb124-4" title="4">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb124-5" title="5">  p=input<span class="op">$</span>p_geom</a>
<a class="sourceLine" id="cb124-6" title="6">  n=<span class="dv">30</span></a>
<a class="sourceLine" id="cb124-7" title="7">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb124-8" title="8">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dgeom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">prob=</span>p)</a>
<a class="sourceLine" id="cb124-9" title="9">  <span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dgeom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">prob=</span>p),</a>
<a class="sourceLine" id="cb124-10" title="10">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb124-11" title="11">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> Ge(p=&quot;</span>,p,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb124-12" title="12">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb124-13" title="13">  <span class="kw">curve</span>(<span class="kw">pgeom</span>(x,<span class="dt">prob=</span>p),</a>
<a class="sourceLine" id="cb124-14" title="14">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb124-15" title="15">        <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de distribución\n Ge(p=&quot;</span>,p,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb124-16" title="16">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb124-17" title="17">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_geometrica1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Cálculos con python</strong></p>
<p>Veamos los cálculos básicos con python para la distribución geométrica <span class="math inline">\(Ge(p=0.25)\)</span>. scipy.stats implementa la distribución geométrica que cuenta el número intentos así que empieza en 1.</p>
<p>Cargamos la función de la librería</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb125-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> geom</a></code></pre></div>
<p>La función de probabilidad es <code>geom.pmf(x,p,loc=0)=geom.pmf(x,p)</code> es un geométrica que cuenta el número de intentos para obtener el primer éxito el valor por defecto del último parámetro es <code>loc=0</code>.</p>
<p>Si queremos la que cuenta el número de fracasos para obtener el primer éxito (la geométrica que empieza en 0) tenemos que usar <code>geom.pmf(x,p,loc=-1)</code>.</p>
<p>Es decir <code>geom.pmf(x,p,loc=-1)=geom.pmf(x-1,p,loc=0)</code></p>
<p>Veamos pues los cálculos para la <span class="math inline">\(Ge(p)\)</span> que empieza en <span class="math inline">\(0\)</span>.</p>
<p><span class="math inline">\(P(X=0)=(1-0.25)^0\cdot 0.25^1=0.25\)</span>:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb126-1" title="1">geom.pmf(<span class="dv">0</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## 0.25</code></pre>
<p><span class="math inline">\(P(X\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25\)</span>:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb128-1" title="1">geom.cdf(<span class="dv">0</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## 0.24999999999999997</code></pre>
<p><span class="math inline">\(P(X\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=0.7626953\)</span>:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb130-1" title="1">geom.cdf(<span class="dv">4</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## 0.7626953125</code></pre>
<p>Una muestra aleatoria de tamaño 25 de una <span class="math inline">\(Ge(0.25)\)</span>:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb132-1" title="1">geom.rvs(p<span class="op">=</span><span class="fl">0.25</span>, size<span class="op">=</span><span class="dv">20</span>, loc<span class="op">=-</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## array([ 3,  0, 15,  1,  0,  0,  0,  1,  4,  0,  0,  0,  0,  5,  0,  0,  1,
##        14,  5,  0])</code></pre>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>¿Qué probabilidades son las que calcula el siguiente código y qué tipo de variables geométricas son?</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb134-1" title="1">geom.cdf(<span class="bu">range</span>(<span class="dv">5</span>),p<span class="op">=</span><span class="fl">0.3</span>,loc<span class="op">=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## array([0.    , 0.3   , 0.51  , 0.657 , 0.7599])</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb136-1" title="1">geom.cdf(<span class="bu">range</span>(<span class="dv">5</span>),p<span class="op">=</span><span class="fl">0.3</span>,loc<span class="op">=-</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## array([0.3    , 0.51   , 0.657  , 0.7599 , 0.83193])</code></pre>
</div>
<p><strong>Cálculos con python de la esperanza y varianza</strong></p>
<p>Con python también podemos calcular directamente algunos parámetros asociados a una función de distribución predefinida</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb138-1" title="1">geom.stats(p<span class="op">=</span><span class="fl">0.25</span>, loc<span class="op">=</span><span class="dv">0</span>, moments<span class="op">=</span><span class="st">&#39;mv&#39;</span>)</a></code></pre></div>
<pre><code>## (array(4.), array(12.))</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb140-1" title="1">geom.stats(p<span class="op">=</span><span class="fl">0.25</span>, loc<span class="op">=-</span><span class="dv">1</span>, moments<span class="op">=</span><span class="st">&#39;mv&#39;</span>)</a></code></pre></div>
<pre><code>## (array(3.), array(12.))</code></pre>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Comprobad que las medias y las varianzas calculadas en el código anterior, corresponden a una <span class="math inline">\(Ge(p=0.3)\)</span> empezando en <span class="math inline">\(1\)</span> y a una <span class="math inline">\(Ge(p=0.3)\)</span> empezando en <span class="math inline">\(0\)</span>.</p>
<p>¿Son las varianzas siempre iguales?</p>
</div>
<p><strong>Gráficos con python</strong></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb142-1" title="1">p <span class="op">=</span> <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb142-2" title="2">x <span class="op">=</span> np.arange(geom.ppf(<span class="fl">0.01</span>, p),geom.ppf(<span class="fl">0.99</span>, p))</a>
<a class="sourceLine" id="cb142-3" title="3">fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</a>
<a class="sourceLine" id="cb142-4" title="4">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb142-5" title="5">ax.plot(x, geom.pmf(x, p), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;geom pmf&#39;</span>)</a>
<a class="sourceLine" id="cb142-6" title="6">ax.vlines(x, <span class="dv">0</span>, geom.pmf(x, p), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb142-7" title="7"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb142-8" title="8">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb142-9" title="9"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb142-10" title="10">  tick.label.set_fontsize(<span class="dv">5</span>) </a>
<a class="sourceLine" id="cb142-11" title="11">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb142-12" title="12">ax.plot(x, geom.cdf(x, p), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;geom pmf&#39;</span>)</a>
<a class="sourceLine" id="cb142-13" title="13">ax.vlines(x, <span class="dv">0</span>, geom.cdf(x, p), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb142-14" title="14"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb142-15" title="15">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb142-16" title="16"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb142-17" title="17">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb142-18" title="18">fig.suptitle(<span class="st">&#39;Distribucion Geometrica&#39;</span>)</a>
<a class="sourceLine" id="cb142-19" title="19">plt.show()</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-43-1.png" width="480" /></p>
</div>
<div id="distribución-binomial-negativa" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Distribución binomial negativa</h3>
<p><strong>El problema de la puerta con dos cerraduras</strong></p>
<p>Supongamos que disponemos de 10 llaves distintas y tenemos que abrir una puerta con <strong>dos cerraduras</strong>.</p>
<p>Comenzamos por la primera cerradura, de tal forma que cada vez olvidamos qué llave hemos probado.</p>
<p>Una vez abierta la primera cerradura probamos de igual forma con la segunda hasta que también la abrimos.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de fracasos hasta abrir la puerta.</p>
<p>Acertar una llave de la puerta es un experimento Bernoulli con probabilidad de éxito <span class="math inline">\(p=0.1\)</span>. Lo repetiremos hasta obtener 2 éxitos.</p>
<p>En general, tendremos un experimento de Bernoulli con probabilidad de éxito <span class="math inline">\(0&lt;p&lt;1\)</span> tal que:</p>
<ul>
<li>Repetimos el experimento hasta obtener el <span class="math inline">\(n\)</span>-ésimo éxito ¡¡abrir la maldita puerta!!.</li>
<li>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número fallos hasta abrir la puerta, es decir, hasta conseguir el <span class="math inline">\(n\)</span>-ésimo éxito. Notemos que no contamos los éxitos, solo contamos los fracasos.</li>
</ul>
<p>Si representamos como es habitual un suceso como una cadena de F’s y E’s, para <span class="math inline">\(n=2\)</span>, algunos sucesos elementales serán:
<span class="math display">\[\{EE,FEE,EFE, FFEE,FEFE,EFFE,FFFEE,FFEFE,FEFFE,EFFFE\}.\]</span></p>
<p>Calculemos algunas probabilidades para <span class="math inline">\(n=2\)</span>:
<span class="math display">\[
\begin{array}{rl}
P(X=0) &amp; =P(\{EE\})=p^2, \\
P(X=1) &amp; =P(\{FEE,EFE\})=2\cdot (1-p)\cdot p^2, \\
P(X=2) &amp; =P(\{FFEE,FEFE,EFFE\})=3\cdot (1-p) 2\cdot p^2, \\
P(X=3) &amp; =P(\{FFFEE,FFEFE,FEFFE,EFFFE\})=4\cdot (1-p)^3\cdot p^2.
\end{array}
\]</span>
En general su función de probabilidad es
<span class="math display">\[
P_{X}(k)=P(X=k)=\left\{\begin{array}{ll}
     {{k+n-1}\choose{n-1}} \cdot (1-p)^{k}\cdot p^n, &amp; \mbox{si } k=0,1,\ldots\\
     0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Una v.a. con este tipo de distribución recibe el nombre de <strong>binomial negativa</strong> y la denotaremos por <span class="math inline">\(BN(n,p)\)</span>.</p>
<p>Notemos que <span class="math inline">\(BN(1,p)=Ge(p)\)</span>.</p>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Justifiquemos el resultado. Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(BN(n,p)\)</span> y sea <span class="math inline">\(k=0,1,2,\ldots\)</span></p>
<p><span class="math display">\[P(X=k)=P(\mbox{Todas las cadenas de E&#39;s y F&#39; con $k$ F, con $n$ E y acabadas en E})\]</span></p>
<p><span class="math display">\[
\overbrace{\underbrace{\overbrace{EFFF\ldots EEF}^{n-1 \quad \mbox{Éxitos}.}}}_{k \quad\mbox{Fracasos}}^{k+n-1\mbox{ posiciones}}E
\]</span></p>
<p>De estas cadenas hay tantas como maneras de elegir de entre las <span class="math inline">\(k+n-1\)</span> primeras posiciones <span class="math inline">\(n-1\)</span> para colocar los éxitos. Esta cantidad es el número binomial <span class="math inline">\({k+n-1\choose n-1}\)</span>.</p>
</div>
<p><strong>Números binomiales negativos</strong></p>
<p>Dados dos enteros positivos <span class="math inline">\(n\)</span> y <span class="math inline">\(k\)</span>, se define el número binomial negativo como:
<span class="math display">\[\binom{-n}{k}=\frac{(-n)(-n-1)\cdots (-n-k+1)}{k!}.\]</span>
Los números binomiales negativos generalizan la fórmula de Newton para exponentes negativos:
<span class="math display">\[
(t+1)^{-n}=\sum_{k=0}^{+\infty}\left(\begin{array}{c} -n
\\ k\end{array}\right) t^{k}.
\]</span></p>
<p><code>R</code> usa la función <code>choose</code> para calcular números binomiales, sean negativos o no. Veámoslo con un ejemplo:
<span class="math display">\[
{-6\choose 4}=\frac{-6\cdot (-6-1)\cdot \cdot (-6-2)\cdot (-6-3) }{4!}= \frac{-6\cdot(-7)\cdot (-8)\cdot (-9)}{24}
= \frac{3024}{24}=126.
\]</span>
Si realizamos el cálculo con <code>R</code> obtenemos el mismo resultado:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">choose</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 126</code></pre>
<p><strong>Esperanza de una <span class="math inline">\(BN(n,p)\)</span></strong></p>
<p>Su <strong>esperanza es</strong>:</p>
<p><span class="math display">\[E(X)=\sum_{k=0}^{+\infty} k\cdot {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n=n\cdot\frac{1-p}{p}.\]</span></p>
<p>La <strong>esperanza de <span class="math inline">\(X^2\)</span></strong> es:</p>
<p><span class="math display">\[E(X^2)=\sum_{k=0}^{+\infty} k^2\cdot {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n=n\cdot\frac{1-p}{p^2}+\left(n\cdot \frac{1-p}{p}\right)^2.\]</span></p>
<p><strong>Varianza de una <span class="math inline">\(BN(n,p)\)</span></strong></p>
<p>Por último, la <strong>varianza</strong> es:
<span class="math display">\[
Var(X)=E(X^2)-E(X)^2=n\cdot \frac{1-p}{p^2}+\left(n\cdot \frac{1-p}{p}\right)^2-\left(n\cdot \frac{1-p}{p}\right)^2=
n\cdot \frac{1-p}{p^2},
\]</span>
y la desviación típica es:</p>
<p><span class="math display">\[\sqrt{Var(X)} = \frac{\sqrt{n(1-p)}}{p}.\]</span></p>
<p><strong>Resumen Binomial Negativa <span class="math inline">\(BN(n,p)\)</span></strong></p>
<table>
<colgroup>
<col width="53%" />
<col width="46%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X\)</span>, <span class="math inline">\(BN(n,p)\)</span></th>
<th align="left">Número de fracasos antes de conseguir el <span class="math inline">\(n\)</span>-ésimo éxito. Probabilidad de éxito <span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\(\{0,1,2,3\ldots\}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_X(k)=P(X=k)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n, &amp; \mbox{si } k=0,1,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq x)=\)</span></td>
<td align="left"><span class="math inline">\(\begin{array}{l}\left\{\begin{array}{ll} 0, &amp; \mbox{si } x&lt;0\\\displaystyle\sum_{i=0}^{k} P(X=i) &amp; \mbox{si }\left\{\begin{array}{l}k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.\end{array}\right. \\\mbox{Calcular la suma o utilizar funciones de `R` o python.} \end{array}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=n\cdot\frac{1-p}{p}\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=n\cdot \frac{1-p}{p^2}\)</span></td>
</tr>
</tbody>
</table>
<div class="exercise">
<p><strong>Ejercicio: Puerta con dos cerraduras</strong></p>
<p>Recordemos nuestra puerta con dos cerraduras que se abren secuencialmente. Tenemos un manojo de 10 llaves casi idénticas de manera que cada vez que probamos una llave olvidamos qué llave hemos usado.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a que nos da el número de intentos fallidos hasta abrir abrir la puerta.</p>
<p>Estamos interesado en modelar este problema. La preguntas son:</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span> la v.a que nos da el número fallos hasta abrir la puerta?</li>
<li>¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span>?</li>
<li>¿Cuál es la probabilidad de fallar exactamente 5 veces antes de abrir la puerta?</li>
<li>¿Cuál es la probabilidad de fallar más de 4?</li>
<li>¿Cuál es el número esperado de fallos? ¿Y su desviación típica?</li>
</ol>
<div class="example-sol">
<p><strong>Solución 1.</strong> ¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span> la v.a que nos da el número fallos hasta abrir la puerta?</p>
<p>Bajo estados condiciones tenemos que la probabilidad de “éxito” de cada intento es <span class="math inline">\(p=\frac{1}{10}=0.1\)</span>. Como cada vez <em>olvidamos</em> qué llave hemos probado, cada intento será independiente del anterior.</p>
<p>Así que la variable <span class="math inline">\(X\)</span> que queremos modelar cuenta el número de fallos de repeticiones sucesivas e independientes de un experimento <span class="math inline">\(Ber(p=0.1)\)</span> hasta conseguir 2 éxitos en un experimento.</p>
<p>Por lo tanto podemos asegurar que <span class="math inline">\(X\)</span> sigue un distribución <span class="math inline">\(BN(n=2,p=0.1).\)</span></p>
<p><strong>Solución 2.</strong> ¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span>?</p>
<p>En general la función de probabilidad de una <span class="math inline">\(BN(n,p)\)</span> es</p>
<p><span class="math display">\[
P_X(X=k)=
\left\{
\begin{array}{cc} 
{k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n, &amp; \mbox{si }  k=0,1,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span>
Si aplicamos la expresión anterior para <span class="math inline">\(n=2\)</span> y <span class="math inline">\(p=0.1\)</span>, obtenemos:</p>
<p><span class="math display">\[
P_X(X=k)=
\left\{
\begin{array}{cc} 
{k+2-1\choose 2-1} \cdot 0.9^{k}\cdot 0.1^2, &amp; \mbox{si }  k=0,1,2,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span>
Simplificando,
<span class="math display">\[
P_X(X=k)=P(X=k)=
\left\{
\begin{array}{cc} 
0.01\cdot (k+1)\cdot 0.9^{k}, &amp; \mbox{si }  k=0,1,2,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span>
La función de distribución en general es</p>
<p><span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0, \\
\displaystyle\sum_{i=0}^{k }{i+n-1\choose n-1} \cdot (1-p)^{i+n-1}\cdot p^n, 
&amp; \mbox{si }\left\{\begin{array}{l} k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right. 
\end{array}
\right.
\]</span>
Simplificando para <span class="math inline">\(n=2\)</span>, <span class="math inline">\(p=0.1\)</span>.</p>
<p><span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0, \\
\displaystyle\sum_{i=0}^{k }0.01\cdot (i+1) \cdot 0.9^{i+1},
&amp; \mbox{si }\left\{\begin{array}{l} k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right. 
\end{array}
\right.
\]</span></p>
<p><strong>Solución 3.</strong> ¿Cuál es la probabilidad de fallar exactamente 5 veces antes de abrir la puerta?
<span class="math display">\[
P(X=5)= 0.01\cdot (5+1) \cdot 0.9^{5}= 0.06 \cdot 0.9^{5}= 0.0354294.
\]</span></p>
<p><strong>Solución 4.</strong> ¿Cuál es la probabilidad de fallar más de 4?</p>
<p>Nos piden calcular <span class="math inline">\(P(X&gt;4)=1-P(X\leq 4).\)</span></p>
<p>Calculemos primero <span class="math inline">\(P(X\leq 4):\)</span></p>
<p><span class="math display">\[
\begin{array}{rl}
P(X\leq 4) &amp;=  \displaystyle\sum_{x=0}^{4} P(X=x) \\ &amp; =P(X=0)+P(X=1)+P(X=2)+P(X=3)+P(X=4)\\
&amp;= 0.01\cdot (0+1) \cdot 0.9^{0}+0.01\cdot (1+1) \cdot 0.9^{1}+0.01\cdot (2+1) \cdot 0.9^{2} \\ &amp;\ \ 
+0.01\cdot (3+1) \cdot 0.9^{3} + 0.01\cdot (4+1) \cdot 0.9^{4} \\ &amp; =
0.01 +0.018+0.0243+0.02916+0.032805 = 0.114265.
\end{array}
\]</span></p>
<p>Por lo tanto</p>
<p><span class="math display">\[
P(X&gt;4)=1-P(X\leq 4)=1-0.114265=
0.885735.
\]</span></p>
</div>
<div class="example-sol">
<p><strong>Solución 5.</strong> ¿Cuál es el número esperado de fallos? ¿Y su desviación típica?</p>
<p>Como <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(BN(n=2,p=0.1)\)</span></p>
<p><span class="math display">\[E(X)=n\cdot \frac{1-p}{p}=2\cdot \frac{1-0.1}{0.1}=18.\]</span></p>
<p>El número de fallos esperado es 18.</p>
<p>La varianza será:
<span class="math display">\[
Var(X)=n\cdot\frac{1-p}{p^2}=2 \cdot \frac{1-0.1}{0.1^2}=180.
\]</span>
La varianza de <span class="math inline">\(X\)</span> es 180 y su desviación típica <span class="math inline">\(\sqrt{180}=13.41641.\)</span></p>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>La función de <code>R</code> que calcula la función de probabilidad de la binomial negativa con sus parámetros básicos es:</p>
<pre><code>dnbinom(x, size, prob,...)`</code></pre>
<p>donde <code>size</code> (<span class="math inline">\(n\)</span>) es el número de éxitos y <code>prob</code> (<span class="math inline">\(p\)</span>), la probabilidad de éxito.</p>
<p>Así en el ejemplo de la puerta con dos cerraduras, <span class="math inline">\(X\)</span> es una <span class="math inline">\(BN(n=size=2,p=prob=0.1)\)</span>. Por ejemplo, <span class="math inline">\(P(X=5)\)</span> que hemos calculado en el ejemplo anterior, vale:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">dnbinom</span>(<span class="dv">5</span>,<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">p=</span><span class="fl">0.1</span>)</a></code></pre></div>
<pre><code>## [1] 0.0354294</code></pre>
<p>De forma similar calculamos calculamos <span class="math inline">\(P(X\leq 4)\)</span>, <span class="math inline">\(P(X&gt;4)=1-P(X\leq 4)\)</span> y <span class="math inline">\(P(X&gt;4)\)</span>.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">pnbinom</span>(<span class="dv">4</span>,<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">p=</span><span class="fl">0.1</span>)</a></code></pre></div>
<pre><code>## [1] 0.114265</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">pnbinom</span>(<span class="dv">4</span>,<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">p=</span><span class="fl">0.1</span>)</a></code></pre></div>
<pre><code>## [1] 0.885735</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">pnbinom</span>(<span class="dv">4</span>,<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">p=</span><span class="fl">0.1</span>,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.885735</code></pre>
<p><strong>Cálculos con python</strong></p>
<p>La función con python es <code>nbinom.pmf(k, n, p, loc)</code>. Hay que cargarla desde <code>scpi.stats</code></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb154-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> nbinom</a></code></pre></div>
<p>Recordemos que de nuevo se cumple que</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb155-1" title="1">nbinom.pmf(k, n, p, loc) <span class="op">=</span> nbinom.pmf(k<span class="op">-</span>loc, n, p)`</a></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb156-1" title="1">nbinom.pmf(k<span class="op">=</span><span class="dv">5</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</a></code></pre></div>
<pre><code>## 0.03542940000000002</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb158-1" title="1">nbinom.pmf(k<span class="op">=</span><span class="dv">5</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>,loc<span class="op">=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 0.03542940000000002</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb160-1" title="1">nbinom.cdf(k<span class="op">=</span><span class="dv">4</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</a></code></pre></div>
<pre><code>## 0.11426500000000003</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb162-1" title="1"><span class="dv">1</span><span class="op">-</span>nbinom.cdf(k<span class="op">=</span><span class="dv">4</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</a></code></pre></div>
<pre><code>## 0.8857349999999999</code></pre>
<p>Generemos 100 observaciones aleatorias de una <span class="math inline">\(BN(n=2,0.1)\)</span>. Es decir serán las veces que hemos fallado hasta abrir la puerta 100 veces.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb164-1" title="1">nbinom.rvs(n<span class="op">=</span><span class="dv">2</span>, p<span class="op">=</span><span class="fl">0.1</span>, size<span class="op">=</span><span class="dv">100</span>)</a></code></pre></div>
<pre><code>## array([23, 42,  3, 23, 35, 12, 25, 29,  5, 24, 22, 14,  6,  7, 15,  4, 20,
##         7,  8, 26, 15,  6, 26, 40, 12, 40, 13,  4,  7, 10, 21, 17,  3, 12,
##        17,  7, 17, 20, 25,  4, 19, 11,  7, 35, 10,  8, 28,  5,  9, 30, 17,
##        32, 13, 37, 10,  2, 41,  9, 15, 17, 22, 15, 35, 42, 30, 15, 16, 11,
##        14,  6,  1,  2, 27, 16,  5,  1, 25, 35, 18, 14,  6, 22, 19, 10, 17,
##         8,  9,  5, 26,  3,  4, 13, 13, 15, 12, 14,  5, 10, 31, 19])</code></pre>
<p>La <strong>esperanza</strong> y la <strong>varianza</strong>de una <span class="math inline">\(BN(n=2,0.1)\)</span> valen:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb166-1" title="1">n, p<span class="op">=</span><span class="dv">2</span>,<span class="fl">0.1</span></a>
<a class="sourceLine" id="cb166-2" title="2">params <span class="op">=</span> nbinom.stats(n,p,moments<span class="op">=</span><span class="st">&#39;mv&#39;</span>)</a>
<a class="sourceLine" id="cb166-3" title="3"><span class="bu">print</span>(<span class="st">&quot;E(X)=</span><span class="sc">{m}</span><span class="st">&quot;</span>.<span class="bu">format</span>(m<span class="op">=</span>params[<span class="dv">0</span>]))</a></code></pre></div>
<pre><code>## E(X)=18.0</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb168-1" title="1"><span class="bu">print</span>(<span class="st">&quot;Var(X)=</span><span class="sc">{v}</span><span class="st">&quot;</span>.<span class="bu">format</span>(v<span class="op">=</span>params[<span class="dv">1</span>]))</a></code></pre></div>
<pre><code>## Var(X)=180.0</code></pre>
<p><strong>Gráficas de la binomial negativa con <code>R</code></strong></p>
<p>El siguiente código de <code>R</code> dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(BN(n=2,p=0.1)\)</span></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb170-2" title="2">aux=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>)</a>
<a class="sourceLine" id="cb170-3" title="3">aux[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">22</span>,<span class="dv">2</span>)]=<span class="kw">dnbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">prob=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb170-4" title="4"><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),<span class="dt">y=</span><span class="kw">dnbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>),<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">prob=</span><span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb170-5" title="5">  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb170-6" title="6">  <span class="dt">main=</span><span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> BN(n=2,p=0.1)&quot;</span>)</a>
<a class="sourceLine" id="cb170-7" title="7"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb170-8" title="8"><span class="kw">curve</span>(<span class="kw">pnbinom</span>(x,<span class="dt">size=</span><span class="dv">2</span>,<span class="dt">prob=</span><span class="dv">0</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb170-9" title="9">  <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb170-10" title="10">  <span class="dt">main=</span><span class="st">&quot;Función de distribución\n BN(n=2,p=0.1)&quot;</span>)</a>
<a class="sourceLine" id="cb170-11" title="11"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-54-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Gráficas interactivas binomial negativa</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb171-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb171-3" title="3">  <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb171-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;n_nbinom&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número de éxitos n:&quot;</span>,</a>
<a class="sourceLine" id="cb171-5" title="5">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">50</span>, <span class="dt">value =</span><span class="dv">20</span> , <span class="dt">step =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb171-6" title="6">  <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb171-7" title="7">          <span class="kw">sliderInput</span>(<span class="st">&quot;p_nbinom&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Probabilidad de un éxito p:&quot;</span>,</a>
<a class="sourceLine" id="cb171-8" title="8">                     <span class="dt">min =</span> <span class="fl">0.01</span>, <span class="dt">max =</span> <span class="fl">0.99</span>, <span class="dt">value =</span> <span class="fl">0.8</span>, <span class="dt">step =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb171-9" title="9">         )</a>
<a class="sourceLine" id="cb171-10" title="10">  )</a>
<a class="sourceLine" id="cb171-11" title="11">)</a>
<a class="sourceLine" id="cb171-12" title="12"></a>
<a class="sourceLine" id="cb171-13" title="13"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb171-14" title="14">  n=input<span class="op">$</span>n_nbinom</a>
<a class="sourceLine" id="cb171-15" title="15">  pr=input<span class="op">$</span>p_nbinom</a>
<a class="sourceLine" id="cb171-16" title="16">  </a>
<a class="sourceLine" id="cb171-17" title="17">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb171-18" title="18">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb171-19" title="19">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dnbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">size=</span>n,<span class="dt">prob=</span>pr)</a>
<a class="sourceLine" id="cb171-20" title="20">  <span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dnbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">size=</span>n,<span class="dt">prob=</span>pr),</a>
<a class="sourceLine" id="cb171-21" title="21">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb171-22" title="22">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> BN(n=&quot;</span>,n,<span class="st">&quot;,p=&quot;</span>,pr,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb171-23" title="23">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb171-24" title="24">  <span class="kw">curve</span>(<span class="kw">pnbinom</span>(x,<span class="dt">size=</span>n,<span class="dt">p=</span>pr),</a>
<a class="sourceLine" id="cb171-25" title="25">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb171-26" title="26">        <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de distribución\n BN(n=&quot;</span>,n,<span class="st">&quot;,p=&quot;</span>,pr,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb171-27" title="27">                    <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb171-28" title="28">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb171-29" title="29">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_binomial_negativa1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Buscad en los manuales de python cómo se dibuja la función de probabilidad y de distribución de una binomial.
negativa</p>
<div class="exercise-sol">
<p>Necesitamos de nuevo más librerías</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb172-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb172-2" title="2"><span class="im">from</span> scipy.stats <span class="im">import</span> nbinom</a>
<a class="sourceLine" id="cb172-3" title="3"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a></code></pre></div>
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb173-1" title="1">n, p <span class="op">=</span> <span class="dv">10</span>, <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb173-2" title="2">x <span class="op">=</span> np.arange(<span class="dv">0</span>,nbinom.ppf(<span class="fl">0.99</span>, n, p))</a>
<a class="sourceLine" id="cb173-3" title="3">fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</a>
<a class="sourceLine" id="cb173-4" title="4">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb173-5" title="5">ax.plot(x, nbinom.pmf(x, n, p), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;nbinom pmf&#39;</span>)</a>
<a class="sourceLine" id="cb173-6" title="6">ax.vlines(x, <span class="dv">0</span>, nbinom.pmf(x, n, p), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb173-7" title="7"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb173-8" title="8">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb173-9" title="9"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb173-10" title="10">  tick.label.set_fontsize(<span class="dv">5</span>) </a>
<a class="sourceLine" id="cb173-11" title="11">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb173-12" title="12">ax.plot(x, nbinom.cdf(x, n, p), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;nbinom pmf&#39;</span>)</a>
<a class="sourceLine" id="cb173-13" title="13">ax.vlines(x, <span class="dv">0</span>, nbinom.cdf(x, n, p), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb173-14" title="14"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb173-15" title="15">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb173-16" title="16"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb173-17" title="17">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb173-18" title="18">fig.suptitle(<span class="st">&#39;Distribucion Binomial Negativa&#39;</span>)</a>
<a class="sourceLine" id="cb173-19" title="19">plt.show()</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/negativa_py_show-1.png" width="480" /></p>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio: acceso aleatorio a un sistema con triple clave</strong></p>
<p>Supongamos que tenemos un sistema informático tiene un programa de seguridad que genera accesos con claves de 3 dígitos <span class="math inline">\(000,001,\ldots 999\)</span>. En total tenemos 1000 posibilidades.</p>
<p>Como una clave de tres dígitos es fácil de romper proponemos considerar tres claves consecutivas de acceso al sistema, cada una de 3 dígitos.</p>
<p>Para acceder al sistema hay que dar las tres claves de forma consecutiva y por orden.</p>
<p>Es decir hasta que no averiguamos la primera clave no pasamos a la segunda clave.</p>
<p>Supongamos que cada vez que ponemos las dos claves olvidamos el resultado y seguimos poniendo claves al azar hasta adivinar la contraseña.</p>
<p>Así hasta conseguir entrar en el sistema.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a que nos da el número de fallos antes de entrar en el sistema.</p>
<p>Estamos interesados en modelar este problema. La preguntas son:</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span>, la v.a que nos da el número de fallos antes de acceder al sistema.</li>
<li>¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span>?</li>
<li>¿Cuál es la probabilidad de fallar 150 veces antes de acceder en el sistema?</li>
<li>¿Cuál es la probabilidad de fallar más de 150 veces antes de entrar en el sistema?</li>
<li>¿Cuál es el número esperado de fallos antes de acceder al sistema? ¿Y su varianza?</li>
</ol>
<div class="exercise-sol">
<p><strong>Solución 1.</strong> ¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span>, la v.a que nos da el número de fallos antes de acceder al sistema?</p>
<p>Bajo estados condiciones tenemos que la probabilidad de “éxito” de cada intento es <span class="math inline">\(p=\frac{1}{1000}=0.001\)</span>. Y como cada vez <em>olvidamos</em> en los dígitos cada intento será independiente del anterior.</p>
<p>Así que la variable <span class="math inline">\(X\)</span> cuenta el número de fracasos independientes hasta conseguir 3 éxitos en un experimento <span class="math inline">\(Ber(p=0.001)\)</span> por lo tanto <span class="math inline">\(X\)</span> sigue un distribución <span class="math inline">\(BN(n=3,p=0.001).\)</span></p>
<p><strong>Solución 2.</strong> ¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span></p>
<p>En general la función de probabilidad de una <span class="math inline">\(BN(n,p)\)</span> es:</p>
<p><span class="math display">\[
P_X(X=x)=P(X=x)=
\left\{
\begin{array}{cc} 
{x+n-1\choose n-1} \cdot (1-p)^{x}\cdot p^n, &amp; \mbox{si }  x=0,1,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span>
En particular la función de probabilidad de una <span class="math inline">\(BN(n=3,p=0.001)\)</span> es</p>
<p><span class="math display">\[
P_X(X=x)=P(X=x)=
\left\{
\begin{array}{cc} 
{x+2\choose 2} \cdot 0.999^{x}\cdot 0.001^3 &amp; \mbox{si }  x=0,1,2,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><strong>Solución 3.</strong> ¿Cuál es la probabilidad de fallar 150 veces antes de acceder en el sistema?</p>
<p>Nos piden calcular la probabilidad siguiente:
<span class="math display">\[
P(X=150)= {152\choose 2} \cdot 0.999^{150}\cdot 0.001^3.
\]</span>
Realizaremos el cálculo anterior con ayuda de <code>R</code>:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">choose</span>(<span class="dv">152</span>,<span class="dv">2</span>)<span class="op">*</span><span class="fl">0.999</span><span class="op">^</span><span class="dv">150</span><span class="op">*</span><span class="fl">0.001</span><span class="op">^</span><span class="dv">3</span></a></code></pre></div>
<pre><code>## [1] 9.876743e-06</code></pre>
<p>o, usando la función de <code>R</code> que nos calcula la función de probabilidad:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="kw">dnbinom</span>(<span class="dv">150</span>,<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">p=</span><span class="fl">0.001</span>)</a></code></pre></div>
<pre><code>## [1] 9.876743e-06</code></pre>
<p>Si queremos calcular la probabilidad anterior con python, tenemos que hacer:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb178-1" title="1"><span class="im">from</span>  scipy.special <span class="im">import</span> binom</a>
<a class="sourceLine" id="cb178-2" title="2">binom(<span class="dv">152</span>,<span class="dv">2</span>)<span class="op">*</span><span class="fl">0.999</span><span class="op">**</span><span class="dv">150</span><span class="op">*</span><span class="fl">0.001</span><span class="op">**</span><span class="dv">3</span></a></code></pre></div>
<pre><code>## 9.876743459670526e-06</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb180-1" title="1">nbinom.pmf(<span class="dv">150</span>,n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>)</a></code></pre></div>
<pre><code>## 9.876743459670217e-06</code></pre>
<p>Vemos que es muy improbable fallar 150 veces antes de acceder al sistema.</p>
<p><strong>Solución 4.</strong> ¿Cuál es la probabilidad de fallar más de 150 veces antes de entrar en el sistema?</p>
<p>Nos piden calcular la probabilidad siguiente:
<span class="math display">\[P(X&gt;150)=1-P(X\leq 150).\]</span></p>
<p>Calculemos <span class="math inline">\(P(X\leq 150)\)</span>
<span class="math display">\[
\begin{array}{rl}
P(X\leq 150) &amp;= P(X=0)+P(X=1)+P(X=2)+\ldots+P(X=150) \\ &amp; = \sum\limits_{k=0}^{150} {k+3-1\choose 3-1} \cdot (0.999)^{k}\cdot 0.001^3= \ldots = 5.2320035\times 10^{-4}
\end{array}
\]</span>
Si hacemos el cálculo con <code>R</code>, obtenemos:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1"><span class="kw">pnbinom</span>(<span class="dv">150</span>,<span class="dv">3</span>,<span class="fl">0.001</span>)</a></code></pre></div>
<pre><code>## [1] 0.0005232003</code></pre>
<p>Si lo hacemos en python, obtenemos el mismo resultado:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb184-1" title="1">nbinom.cdf(<span class="dv">150</span>,n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>)</a></code></pre></div>
<pre><code>## 0.0005232003490824058</code></pre>
<p>El valor pedido será pues:
<span class="math display">\[
P(X&gt;150)=1-P(X\leq 150)=1-5.2320035\times 10^{-4}=0.9994768.
\]</span>
Vemos que es muy probable que fallemos más de 150 veces antes de entrar en el sistema.</p>
<p><strong>Solución 5.</strong> ¿Cuál es el número esperado de fallos antes de acceder al sistema? ¿Y su varianza?</p>
<p><span class="math display">\[E(X)=n\cdot \frac{1-p}{p}=3\cdot \frac{1- 0.001}{0.001}=2997.\]</span>
<span class="math display">\[Var(X)=n\cdot \frac{1-p}{p^2}=3\cdot \frac{1- 0.001^2}{0.001^2}=2.997\times 10^{6}.\]</span></p>
<p>Con python:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb186-1" title="1">params <span class="op">=</span> nbinom.stats(n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>,moments<span class="op">=</span><span class="st">&#39;mv&#39;</span>)</a>
<a class="sourceLine" id="cb186-2" title="2"><span class="bu">print</span>(<span class="st">&quot;E(X) = </span><span class="sc">{m}</span><span class="st">&quot;</span>.<span class="bu">format</span>(m<span class="op">=</span>params[<span class="dv">0</span>]))</a></code></pre></div>
<pre><code>## E(X) = 2997.0</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb188-1" title="1"><span class="bu">print</span>(<span class="st">&quot;Var(X) = </span><span class="sc">{v}</span><span class="st">&quot;</span>.<span class="bu">format</span>(v<span class="op">=</span>params[<span class="dv">1</span>]))</a></code></pre></div>
<pre><code>## Var(X) = 2997000.0</code></pre>
</div>
</div>
<p><strong>¿Tres claves de tres dígitos o una de 9 dígitos?</strong></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Supongamos que ponemos una sola clave de 9 dígitos. Estudiemos en este caso la variable aleatoria que da el número de fallos antes de entrar en el sistema y comparemos los resultados.</p>
<div class="exercise-sol">
<p>Si seguimos suponiendo que cada vez ponemos la contraseña al azar pero esta vez con una clave de 9 dígitos. La probabilidad de éxito será ahora <span class="math inline">\(p=\frac{1}{10^{9}}\)</span>.</p>
<p>Si llamamos <span class="math inline">\(X_9\)</span> a la variable aleatoria que nos da el número de fallos antes de entra en el sistema seguirá una distribución <span class="math inline">\(Ge(p=\frac{1}{10^9}=0.000000001)\)</span>.</p>
<p>Su valor esperado es</p>
<p><span class="math display">\[
E(X_9)=\frac{1-p}{p}=\frac{1-0.000000001}{0.000000001}=10\times 10^{8}.
\]</span></p>
<p><span class="math inline">\(1000 000 000\)</span> son 1000 millones de fallos esperados hasta abrir la puerta.</p>
<p>Recordemos que con tres contraseñas de 3 dígitos el valor esperado de fallos era:</p>
<p><span class="math display">\[3\cdot \frac{1-0.001}{0.001}=2997.\]</span></p>
<p>Por lo tanto, desde el punto de vista de la seguridad, es mejor una clave larga de 9 dígitos que tres cortas si escribimos las contraseñas al azar.</p>
</div>
</div>
</div>
<div id="distribución-de-poisson" class="section level3">
<h3><span class="header-section-number">3.1.5</span> Distribución de Poisson</h3>
<p>Diremos que una v.a. discreta <span class="math inline">\(X\)</span> con <span class="math inline">\(X(\Omega)=\mathbf{N}\)</span> tiene distribución de Poisson con parámetro <span class="math inline">\(\lambda&gt;0\)</span>, y lo denotaremos por <span class="math inline">\(Po(\lambda)\)</span> si su función de probabilidad es:</p>
<p><span class="math display">\[
P_{X}(x)=P(X=x)=
\left\{\begin{array}{ll}
\frac{\lambda^x}{x!} e^{-\lambda},&amp; \mbox{ si } x=0,1,\ldots\\
0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Usando que el desarrollo en serie de Taylor de la función exponencial es
<span class="math display">\[
e^{\lambda}=\sum_{x=0}^{+\infty} \frac{\lambda^x}{x!},
\]</span>
es fácil comprobar que la suma de la función de probabilidad en todos los valores del dominio de <span class="math inline">\(X\)</span>, o sea, los enteros positivos, vale 1.</p>
<p>Además recordemos que dado <span class="math inline">\(x\in\mathbb{R}-\{0\}\)</span> se tiene que</p>
<p><span class="math display">\[
\lim_{n\to\infty} \left(1+\frac{x}{n}\right)^n=e^x.
\]</span></p>
<p>Usando la expresión anterior para <span class="math inline">\(x=-\lambda\)</span>, tenemos:
<span class="math display">\[
\lim_{n\to\infty} \left(1-\frac{\lambda}{n}\right)^n=\lim_{n\to\infty} \left(1+\frac{-\lambda}{n}\right)^n=e^{-\lambda}.
\]</span></p>
<p><strong>La distribución de Poisson como “límite” de una binomial</strong></p>
<p>La distribución de Poisson (<a href="https://es.wikipedia.org/wiki/Sim%C3%A9on_Denis_Poisson">Siméon Denis Poisson</a>) aparece en el conteo de determinados eventos que se producen en un intervalo de tiempo o en el espacio.</p>
<p>Supongamos que nuestra variable de interés es <span class="math inline">\(X\)</span>, el número de eventos en el intervalo de tiempo <span class="math inline">\((0,t]\)</span>, como por ejemplo el número de llamadas a un <em>call center</em> en una hora donde suponemos que se cumplen las siguientes condiciones:</p>
<ol style="list-style-type: decimal">
<li>El número promedio de eventos en el intervalo <span class="math inline">\((0,t]\)</span> es <span class="math inline">\(\lambda&gt;0\)</span>.</li>
<li>Es posible dividir el intervalo de tiempo en un
gran número de subintervalos (denotemos por <span class="math inline">\(n\)</span> al número de intervalos) de forma que:
<ul>
<li>La probabilidad de que se produzcan dos o más eventos en un subintervalo es despreciable.</li>
<li>El número de ocurrencias de eventos en un intervalo es independiente del número de ocurrencias en otro intervalo.</li>
<li>La probabilidad de que un evento ocurra en un subintervalo es <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>·</li>
</ul></li>
</ol>
<p>Bajo estas condiciones, podemos considerar que el número de eventos en el intervalo <span class="math inline">\((0,t]\)</span> será el número de “éxitos” en <span class="math inline">\(n\)</span> repeticiones independientes de un proceso Bernoulli de parámetro <span class="math inline">\(p_n\)</span></p>
<p>Entonces si <span class="math inline">\(n\to\infty\)</span> y <span class="math inline">\(p_n\cdot n\)</span> se mantiene igual a <span class="math inline">\(\lambda\)</span> resulta que la función de probabilidad de <span class="math inline">\(X_n\)</span> se puede escribir como</p>
<p><span class="math display">\[
\begin{array}{rl}
P(X_n=k)&amp;=\left(\begin{array}{c} n\\ k\end{array}\right) \cdot p_n^k\cdot  (1-p_n)^{n-k}
\\
&amp;= {n\choose k}\cdot \left(\frac{\lambda}{n}\right)^{k}\cdot \left(1-\frac{\lambda}{n}\right)^{n-k}\\
&amp;=
\frac{\lambda^k}{k!}\cdot\frac{n!}{(n-k)!\cdot n^k}\cdot
\left(1-\frac{\lambda}{n}\right)^{n}\cdot \left(1-\frac{\lambda}{n}\right)^{-k}.
\end{array}
\]</span>
Si hacemos tender <span class="math inline">\(n\)</span> hacia <span class="math inline">\(\infty\)</span>, obtenemos:
<span class="math display">\[
\displaystyle\lim_{n\to \infty} P(X_n=k) = \lim_{n\to \infty} \frac{\lambda^k}{k!}\cdot\frac{n!}{(n-k)!\cdot n^k} \cdot
\left(1-\frac{\lambda}{n}\right)^{n}\cdot \left(1-\frac{\lambda}{n}\right)^{-k}.
\]</span></p>
<p>Calculemos el límite de algunos de los factores de la expresión</p>
<p><span class="math display">\[
\begin{array}{rl}
\lim\limits_{n\to \infty}\frac{n!}{(n-k)!\cdot n^k} &amp; = \lim\limits_{n\to \infty}\frac{n\cdot (n-1)\cdots (n-k-1)}{n^k}
=\lim\limits_{n\to \infty}\frac{n^{k}+\cdots}{n^k}=1, \\
\lim\limits_{n\to \infty} \left(1-\frac{\lambda}{n}\right)^{n} &amp; =e^{-\lambda},\\
\lim\limits_{n\to \infty} \left(1-\frac{\lambda}{n}\right)^{-k} &amp; =\lim\limits_{n\to \infty} 1^{-k}=\lim\limits_{n\to \infty}  1=1,
\end{array}
\]</span>
donde en el último límite, hemos tenido en cuenta que <span class="math inline">\(k\)</span> es constante.</p>
<p>Usando las expresiones halladas anteriormente, tenemos que el límite de la función de probabilidad de la variable <span class="math inline">\(X_n\)</span> tiende a la función de probabilidad de la variable de Poisson de parámetro <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[
\displaystyle\lim_{n\to\infty} P(X_n=k)=
\lim_{n\to\infty} \left(\begin{array}{c} n\\ k\end{array}\right)
\cdot p_n^k \cdot (1-p_n)^{n-k}= \frac{\lambda^k}{k!}\cdot 1 \cdot e^{-\lambda}\cdot 1=\frac{\lambda^k}{k!}\cdot e^{-\lambda}.
\]</span>
Usando que las variables <span class="math inline">\(X_n\)</span> tienen distribución <span class="math inline">\(B(n,p_n=\frac{\lambda}{n})\)</span>, tenemos que el límite de binomiales de parámetros <span class="math inline">\(n\)</span> y <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span> es una distribución de Poisson de parámetro <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(Po(\lambda)\)</span>.</p>
<p><strong>Procesos de Poisson</strong></p>
<p>Lo interesante de las variables Poisson es que podemos modificar (si el modelo lo permite) el intervalo de tiempo <span class="math inline">\((0,t]\)</span> en el que contamos los eventos siempre y cuando se cumplan las condiciones 1 y 2 enunciadas anteriormente en el nuevo intervalo de tiempo.</p>
<p>En general, podemos afirmar si la variable es Poisson en <span class="math inline">\((0,t]\)</span>, también lo será en cualquier subintervalo <span class="math inline">\((0,t&#39;]\)</span> para todo <span class="math inline">\(t&#39;\)</span> tal que <span class="math inline">\(0&lt;t&#39;&lt;t\)</span>.</p>
<p>De esta forma, podremos definir una serie de variables <span class="math inline">\(X_t\)</span> de distribución <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p><l class="prop"> <strong>Definición de procesos de Poisson</strong> </l></p>
<p>Consideremos un experimento <em>Poisson</em> con <span class="math inline">\(\lambda\)</span> igual
al promedio de eventos en una unidad de tiempo (u.t.).</p>
<p>Si <span class="math inline">\(t\)</span> es una cantidad de tiempo en u.t., la v.a. <span class="math inline">\(X_{t}\)</span> definida como el número de eventos en el intervalo <span class="math inline">\((0,t]\)</span> es una <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p>El conjunto de variables <span class="math inline">\(\{X_t\}_{t&gt;0}\)</span> recibe el nombre de <strong>proceso de Poisson</strong>.</p>
<p><strong>Resumen de la distribución de Poisson <span class="math inline">\(X\equiv Po(\lambda)\)</span></strong></p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X\)</span> Poisson</th>
<th align="left"><span class="math inline">\(\lambda\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\(\{0,1,\ldots \}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} \frac{\lambda^x}{x!}e^{-\lambda}, &amp; \mbox{ si } x=0,1,\ldots\\ 0, &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left"><span class="math inline">\(\begin{array}{l}\left\{\begin{array}{ll} 0, &amp; \mbox{si } x&lt;0,\\\displaystyle\sum_{i=0}^{k} P(X=i)= \displaystyle\sum_{i=0}^{k} \frac{\lambda^i}{i!}\cdot e^{-\lambda}, &amp; \mbox{si }\left\{\begin{array}{l}k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.\end{array}\right. \\\mbox{Calcular la suma o utilizar funciones de `R` o python.} \end{array}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\lambda\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=\lambda\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Resumen proceso Poisson <span class="math inline">\(X_t\equiv Po(\lambda\cdot t)\)</span></strong></p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X_t\)</span> <span class="math inline">\(Po(\lambda\cdot t)\)</span></th>
<th align="left"><span class="math inline">\(\lambda\)</span> promedio por u.t.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\(\{0,1,\ldots \}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} \frac{(\lambda\cdot t)^x}{x!}e^{-\lambda\cdot t} &amp; \mbox{ si } x=0,1,\ldots\\ 0 &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left"><span class="math inline">\(\begin{array}{l}\left\{\begin{array}{ll} 0, &amp; \mbox{si } x&lt;0,\\\displaystyle\sum_{i=0}^{k} P(X=i)= \displaystyle\sum_{i=0}^{k} \frac{(\lambda\cdot t)^i}{i!}\cdot e^{-\lambda\cdot t}, &amp; \mbox{si }\left\{\begin{array}{l}k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.\end{array}\right. \\\mbox{Calcular la suma o utilizar funciones de `R` o python.} \end{array}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\lambda\cdot t\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=\lambda\cdot t\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Aproximación de la distribución binomial por la Poisson</strong></p>
<p>Dada una variable aleatoria de distribución <span class="math inline">\(B(n,p)\)</span> si <span class="math inline">\(n\)</span> es grande y <span class="math inline">\(p\)</span> es pequeño, podemos aproximar la distribución anterior por una distribución Poisson de parámetro <span class="math inline">\(\lambda=n\cdot p\)</span>, <span class="math inline">\(Po(\lambda = n\cdot p)\)</span>.</p>
<p>Un criterio para decidir que la aproximación anterior es buena es que
<span class="math inline">\(n\geq 20\)</span>, o mejor, <span class="math inline">\(n\geq 30\)</span>, <span class="math inline">\(n\cdot p &lt; 10\)</span> y <span class="math inline">\(p\leq 0.05.\)</span></p>
<p>La aproximación de la función de probabilidad de una variable binomial a una variable de Poisson es óptima en los valores cercanos a <span class="math inline">\(E(X)=\lambda\)</span>.</p>
<p><strong>Gráficos de la aproximación binomial a la de Poisson</strong></p>
<p>Suponemos que estamos en las condiciones anteriores: <span class="math inline">\(n\geq 20\)</span>, <span class="math inline">\(n\cdot p &lt; 10\)</span>, <span class="math inline">\(p\leq 0.05\)</span>.</p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb190-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb190-3" title="3">  <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb190-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;n_binomP&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número de repeticiones n:&quot;</span>,</a>
<a class="sourceLine" id="cb190-5" title="5">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>, <span class="dt">value =</span><span class="dv">20</span> , <span class="dt">step =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb190-6" title="6">  <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb190-7" title="7">          <span class="kw">sliderInput</span>(<span class="st">&quot;p_binomP&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Probabilidad éxito p:&quot;</span>,</a>
<a class="sourceLine" id="cb190-8" title="8">                     <span class="dt">min =</span> <span class="fl">0.001</span>, <span class="dt">max =</span> <span class="fl">0.9</span>, <span class="dt">value =</span> <span class="fl">0.05</span>, <span class="dt">step =</span> <span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb190-9" title="9">         )</a>
<a class="sourceLine" id="cb190-10" title="10">  )</a>
<a class="sourceLine" id="cb190-11" title="11">)</a>
<a class="sourceLine" id="cb190-12" title="12"></a>
<a class="sourceLine" id="cb190-13" title="13"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb190-14" title="14">  n=input<span class="op">$</span>n_binomP</a>
<a class="sourceLine" id="cb190-15" title="15">  pr=input<span class="op">$</span>p_binomP</a>
<a class="sourceLine" id="cb190-16" title="16">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb190-17" title="17">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb190-18" title="18">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">size=</span>n,<span class="dt">prob=</span>pr)</a>
<a class="sourceLine" id="cb190-19" title="19">  <span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">size=</span>n,<span class="dt">prob=</span>pr),</a>
<a class="sourceLine" id="cb190-20" title="20">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de probabilidad&quot;</span>,</a>
<a class="sourceLine" id="cb190-21" title="21">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Funciones de probabilidad</span><span class="ch">\n</span><span class="st"> B(n=&quot;</span>,n,<span class="st">&quot;,p=&quot;</span>,pr,<span class="st">&quot;), </span></a>
<a class="sourceLine" id="cb190-22" title="22"><span class="st">                     Po(lambda=&quot;</span>,n<span class="op">*</span>pr,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb190-23" title="23">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb190-24" title="24">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb190-25" title="25">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),n<span class="op">*</span>pr)</a>
<a class="sourceLine" id="cb190-26" title="26">  <span class="kw">points</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),n<span class="op">*</span>pr),</a>
<a class="sourceLine" id="cb190-27" title="27">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">pch=</span><span class="dv">25</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb190-28" title="28">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb190-29" title="29">  <span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Binomial&quot;</span>,<span class="st">&quot;Poisson&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), </a>
<a class="sourceLine" id="cb190-30" title="30">         <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">25</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb190-31" title="31">  <span class="kw">curve</span>(<span class="kw">pbinom</span>(x,<span class="dt">size=</span>n,<span class="dt">p=</span>pr),</a>
<a class="sourceLine" id="cb190-32" title="32">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de Distribución&quot;,</span></a>
<a class="sourceLine" id="cb190-33" title="33"><span class="st">         main=paste0(c(&quot;</span>Funciones de distribución \n <span class="kw">B</span>(<span class="dt">n=</span><span class="st">&quot;,n,&quot;</span>,<span class="dt">p=</span><span class="st">&quot;,pr,&quot;</span>),</a>
<a class="sourceLine" id="cb190-34" title="34">                       <span class="kw">Po</span>(<span class="dt">lambda=</span><span class="st">&quot;,n*pr,&quot;</span>)<span class="st">&quot;),collapse = &quot;&quot;))</span></a>
<a class="sourceLine" id="cb190-35" title="35"><span class="st">  curve(ppois(x,n*pr),</span></a>
<a class="sourceLine" id="cb190-36" title="36"><span class="st">        xlim=c(-1,n+1),col=&quot;</span>red<span class="st">&quot;,add=TRUE)</span></a>
<a class="sourceLine" id="cb190-37" title="37"><span class="st">  if(all(c(n&gt;=20,n*pr&lt;10,pr&lt;= 0.05))){aux_l=&quot;</span>Condición\n TRUE<span class="st">&quot;} else </span></a>
<a class="sourceLine" id="cb190-38" title="38"><span class="st">    {aux_l=&quot;</span>Condición\n FALSE<span class="st">&quot;}</span></a>
<a class="sourceLine" id="cb190-39" title="39"><span class="st">  legend(&quot;</span>topleft<span class="st">&quot;,legend=c(aux_l,paste0(&quot;</span><span class="dt">n=</span><span class="st">&quot;,n),paste0(&quot;</span>n<span class="op">*</span><span class="dt">p=</span><span class="st">&quot;,n*pr),</span></a>
<a class="sourceLine" id="cb190-40" title="40"><span class="st">                            paste0(&quot;</span><span class="dt">p=</span><span class="st">&quot;,pr)),bg=&quot;</span>transparent<span class="st">&quot;,cex=0.8,bty = &quot;</span>n<span class="st">&quot;)</span></a>
<a class="sourceLine" id="cb190-41" title="41"><span class="st">  par(mfrow=c(1,1))</span></a>
<a class="sourceLine" id="cb190-42" title="42"><span class="st">})</span></a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_Poisson1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="example">
<p><strong>Ejemplo de una distribución de Poisson <span class="math inline">\(Po(\lambda)\)</span>: trampa para insectos</strong></p>
<p>La conocida <a href="https://es.wikipedia.org/wiki/Insecticida_el%C3%A9ctrico">lámpara antiinsectos o insecticida eléctrico</a> atrae a los insectos voladores con una luz ultravioleta y los mata por electrocución.</p>
<p>Consideremos la v.a. <span class="math inline">\(X\)</span> que cuenta el número de insectos caídos en la trampa en una hora. Supongamos que el número promedio de insectos que captura la trampa en una hora es <span class="math inline">\(E(X)=20\)</span> y que podemos admitir que <span class="math inline">\(X\)</span> sigue una ley de probabilidad <span class="math inline">\(Po(\lambda=20)\)</span>.</p>
<p>Nos piden</p>
<ol style="list-style-type: decimal">
<li>Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson.</li>
<li>Escribir de forma explicita la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>.</li>
<li>Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</li>
<li>Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</li>
<li>¿Cuál es el valor esperando, la varianza y la desviación típica de <span class="math inline">\(X\)</span>?</li>
</ol>
<div class="example-sol">
<p><strong>Solución 1.</strong> Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson.</p>
<ol style="list-style-type: decimal">
<li>El número promedio de eventos en el intervalo <span class="math inline">\((0,1]\)</span>, una hora es
<span class="math inline">\(\lambda=20&gt;0\)</span>.</li>
<li>Es posible dividir el intervalo de tiempo de una hora en un
gran número de subintervalos (denotemos por <span class="math inline">\(n\)</span> al número de intervalos) de forma que:
<ul>
<li>La probabilidad de que se produzcan dos o más electrocuciones un subintervalo es despreciable. No es posible que dos mosquitos se electrocuten al mismo tiempo.</li>
<li>El número de ocurrencias, electrocuciones de insectos, en un intervalo es independiente del número de electrocuciones en otro intervalo.</li>
<li>La probabilidad de que un evento ocurra en un subintervalo es <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>· Podemos dividir los 20 insectos promedio entre los <span class="math inline">\(n\)</span> intervalos (trozo de hora) de forma que <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>.</li>
<li>Por ejemplo si <span class="math inline">\(n=60\)</span> tenemos que <span class="math inline">\(p_n=\frac{20}{60}=\frac{1}{3}\)</span>. La probabilidad de que en un minuto la trampa chisporrotee es <span class="math inline">\(\frac{1}{3}\)</span>.</li>
</ul></li>
</ol>
<p><strong>Solución 2.</strong> Escribid de forma explicita la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>.</p>
<p>La distribución de probabilidad de un <span class="math inline">\(Po(\lambda)\)</span> es</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}  \frac{\lambda^x}{x!}e^{-\lambda}, &amp; \mbox{ si } x=0,1,\ldots\\ 0,  &amp; \mbox{ en otro caso.}\end{array}\right.
\]</span></p>
<p>En nuestro caso, <span class="math inline">\(\lambda =20\)</span>:
<span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}\frac{20^x}{x!}e^{-20}, &amp; \mbox{ si } x=0,1,\ldots\\ 0,  &amp; \mbox{ en otro caso.}\end{array}\right.
\]</span>
La función de distribución es:</p>
<p><span class="math display">\[
F_X(x)=P(X\leq X)=
\left\{\begin{array}{ll} 
0, &amp; \mbox{si } x&lt;0,\\
\displaystyle\sum_{i=0}^{k} P(X=i)=\sum_{i=0}^{k}\frac{\lambda^i}{i!}\cdot e^{-\lambda}, &amp; \mbox{si  }
\left\{\begin{array}{l}
k\leq x&lt; k+1,\\k=0,1,2,\ldots
\end{array}
\right.
\end{array}
\right.
\]</span><br />
En nuestro caso:
<span class="math display">\[
F_X(x)=P(X\leq X)=
\left\{\begin{array}{ll} 
0, &amp; \mbox{si } x&lt;0,\\
\displaystyle\sum_{i=0}^{k} P(X=i)=\sum_{i=0}^{k}\frac{20^i}{i!}\cdot e^{-20}, &amp; \mbox{si  }
\left\{\begin{array}{l}
k\leq x&lt; k+1,\\k=0,1,2,\ldots
\end{array}
\right.
\end{array}
\right.
\]</span>
<strong>Solución 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Nos piden la probabilidad siguiente:
<span class="math display">\[
P(X=21)=\frac{20^{21}}{21!} e^{-20}=0.0846051.
\]</span></p>
<p>Para realizar el cálculo anterior, podemos usar <code>R</code> como calculadora o usar la función <code>dpois</code> que nos calcula la función de distribución de la variable de Poisson:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1"><span class="dv">20</span><span class="op">^</span>(<span class="dv">21</span>)<span class="op">/</span><span class="kw">factorial</span>(<span class="dv">21</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">20</span>)</a></code></pre></div>
<pre><code>## [1] 0.08460506</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1"><span class="kw">dpois</span>(<span class="dv">21</span>,<span class="dt">lambda =</span> <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## [1] 0.08460506</code></pre>
<p><strong>Solución 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>Nos piden la probabilidad siguiente:
<span class="math display">\[
\begin{array}{rl}
 P(X\geq 6)&amp;=1- P(X&lt;6)=1-P(X\leq 5)=1-F_X(5)=1-\displaystyle\sum_{x=0}^{5} \frac{20^{x}}{x!}\cdot e^{-20}\\
 &amp;=
 1-\left(\frac{20^{0}}{0!}\cdot e^{-20}+\frac{20^{1}}{1!}\cdot e^{-20}+\frac{20^{2}}{2!}\cdot e^{-20}+\frac{20^{3}}{3!}\cdot e^{-20}+\frac{20^{4}}{4!}\cdot e^{-20}+\frac{20^{5}}{5!}\cdot e^{-20}\right)\\[1ex]
 &amp;=
 1-e^{-20}\cdot \left(1+20+\frac{400}{4}+\frac{8000}{6}+\frac{160000}{24}+\frac{3200000}{120}\right)\\[1ex]
 &amp;=
 1-e^{-20} \cdot \left(\frac{1 \cdot 120+20\cdot 120+400\cdot 30+8000\cdot 20+160000\cdot 24+3200000\cdot 1}{120}\right)\\[1ex]
 &amp;= 1-e^{-20}\cdot\left(\frac{4186520}{120}\right)=1-7.1908841\times 10^{-5} =0.9999281.
\end{array}
\]</span></p>
<p><strong>Solución 5.</strong> ¿Cuál es el valor esperado, la varianza y la desviación típica de <span class="math inline">\(X\)</span>?</p>
<p>El valor esperado del número de insectos caídos en la trampa en una hora es:
<span class="math display">\[E(X)=\lambda=20.\]</span>
Su varianza es
<span class="math display">\[Var(X)=\lambda=20,\]</span>
y su desviación típica vale:
<span class="math display">\[\sqrt{Var(X)}=+\sqrt{\lambda}=+\sqrt{20}=4.47214.\]</span></p>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Consideremos por ejemplo una v.a. <span class="math inline">\(X\)</span> con distribución <span class="math inline">\(Po(\lambda=3)\)</span>. Calculemos <span class="math inline">\(P_X(0)=P(X=0), P_X(1)=P(X=1)\)</span> con <code>R</code>:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1"><span class="kw">dpois</span>(<span class="dv">0</span>,<span class="dt">lambda =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.04978707</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1"><span class="kw">dpois</span>(<span class="dv">1</span>,<span class="dt">lambda =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.1493612</code></pre>
<p>Si quisiéramos hallar la función de distribución en los mismos valores anteriores,
<span class="math inline">\(F_X(0)=P(X\leq 0), F_X(1)=P(X\leq 1)\)</span>, haríamos lo siguiente:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1"><span class="kw">ppois</span>(<span class="dv">0</span>,<span class="dt">lambda =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.04978707</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1"><span class="kw">ppois</span>(<span class="dv">1</span>,<span class="dt">lambda =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.1991483</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1"><span class="kw">dpois</span>(<span class="dv">0</span>,<span class="dt">lambda =</span> <span class="dv">3</span>)<span class="op">+</span><span class="kw">dpois</span>(<span class="dv">1</span>,<span class="dt">lambda =</span> <span class="dv">3</span>) <span class="co">### es igual a ppois(1,lambda=3)</span></a></code></pre></div>
<pre><code>## [1] 0.1991483</code></pre>
<p>A continuación, comprobemos que <span class="math inline">\(F_X(10)=\sum\limits_{x=0}^{10} P_X(x)\)</span>:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1"><span class="kw">dpois</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##  [1] 0.0497870684 0.1493612051 0.2240418077 0.2240418077 0.1680313557
##  [6] 0.1008188134 0.0504094067 0.0216040315 0.0081015118 0.0027005039
## [11] 0.0008101512</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="kw">sum</span>(<span class="kw">dpois</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## [1] 0.9997077</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1"><span class="kw">ppois</span>(<span class="dv">10</span>,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.9997077</code></pre>
<p>Si quisiéramos generar una secuencia de <span class="math inline">\(100\)</span> observaciones para una distribución de Poisson de parámetro <span class="math inline">\(\lambda=3\)</span>, <span class="math inline">\(Po(3)\)</span>, tendríamos que hacer:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1"><span class="kw">rpois</span>(<span class="dt">n=</span><span class="dv">100</span>,<span class="dt">lambda =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 2 5 3 3 2 2 5 2 4 4 2 3 2 2 2 2 2 3 3 5 3 3 2 4 2 3 2 1 1 3 4 6 2 5 3
##  [36] 4 1 1 6 3 4 1 4 3 4 3 0 2 1 4 3 0 2 4 2 3 5 2 1 3 3 4 2 5 0 3 1 1 4 6
##  [71] 4 5 0 4 0 3 3 3 4 1 2 6 2 2 2 2 1 2 5 2 5 3 7 3 5 2 3 2 1 3</code></pre>
<div class="exercise">
<p><strong>Ejercicio de la trampa para insectos (continuación)</strong></p>
<p>En el ejercicio de la trampa para insectos teníamos que <span class="math inline">\(X\)</span> es una <span class="math inline">\(Po(20)\)</span>. Responded con <code>R</code> a la preguntas 3 y 4 de este ejercicio</p>
<div class="example-sol">
<p><strong>Pregunta 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X=21)\)</span>:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1"><span class="kw">dpois</span>(<span class="dv">21</span>,<span class="dt">lambda=</span><span class="dv">20</span>)<span class="co">## P(X=21)</span></a></code></pre></div>
<pre><code>## [1] 0.08460506</code></pre>
<p><strong>Pregunta 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X\geq 6)=1-P(X&lt;6)=1-P(X\leq 5)\)</span>:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1"><span class="kw">ppois</span>(<span class="dv">5</span>,<span class="dt">lambda=</span><span class="dv">20</span>)</a></code></pre></div>
<pre><code>## [1] 7.190884e-05</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">ppois</span>(<span class="dv">5</span>,<span class="dt">lambda=</span><span class="dv">20</span>) <span class="co">## es 1-P(X&lt;=5)=P(X&gt;=6)</span></a></code></pre></div>
<pre><code>## [1] 0.9999281</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1"><span class="kw">ppois</span>(<span class="dv">5</span>,<span class="dt">lambda=</span><span class="dv">20</span>,<span class="dt">lower.tail =</span><span class="ot">FALSE</span> ) <span class="co">## acumula hacia arriba P(X&gt;5)=P(X&gt;=6)=P(X=6)+P(X=7)+...</span></a></code></pre></div>
<pre><code>## [1] 0.9999281</code></pre>
</div>
</div>
<p><strong>Gráficos de la distribución Poisson con <code>R</code></strong></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">lambda=<span class="dv">20</span></a>
<a class="sourceLine" id="cb221-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb221-3" title="3">n=<span class="kw">qpois</span>(<span class="fl">0.99</span>,<span class="dt">lambda=</span>lambda)</a>
<a class="sourceLine" id="cb221-4" title="4">aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb221-5" title="5">aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">lambda=</span>lambda)</a>
<a class="sourceLine" id="cb221-6" title="6">ymax=<span class="kw">max</span>(<span class="kw">ppois</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">lambda=</span>lambda))</a>
<a class="sourceLine" id="cb221-7" title="7"><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">lambda=</span>lambda),</a>
<a class="sourceLine" id="cb221-8" title="8">     <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,ymax),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de probabilidad&quot;</span>,</a>
<a class="sourceLine" id="cb221-9" title="9">     <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st">  Po(lambda=&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb221-10" title="10"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb221-11" title="11"><span class="kw">curve</span>(<span class="kw">ppois</span>(x,<span class="dt">lambda=</span>lambda),</a>
<a class="sourceLine" id="cb221-12" title="12">      <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de Distribución&quot;,</span></a>
<a class="sourceLine" id="cb221-13" title="13"><span class="st">      main=paste0(c(&quot;</span>Función de distribución \n <span class="kw">Po</span>(<span class="dt">lambda=</span><span class="st">&quot;,lambda,&quot;</span>)<span class="st">&quot;),collapse = &quot;&quot;))</span></a>
<a class="sourceLine" id="cb221-14" title="14"><span class="st">par(mfrow=c(1,1))</span></a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/graficosPOISON-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Gráficos interactivos con <code>R</code></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" title="1"><span class="kw">sliderInput</span>(<span class="st">&quot;lambda&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Promedio de eventos lambda&quot;</span>,</a>
<a class="sourceLine" id="cb222-2" title="2">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">100</span>, <span class="dt">value =</span><span class="dv">20</span> , <span class="dt">step =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb222-3" title="3"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb222-4" title="4">  lambda=input<span class="op">$</span>lambda</a>
<a class="sourceLine" id="cb222-5" title="5">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb222-6" title="6">  n=<span class="kw">qpois</span>(<span class="fl">0.99</span>,<span class="dt">lambda=</span>lambda)</a>
<a class="sourceLine" id="cb222-7" title="7">  <span class="co">#n</span></a>
<a class="sourceLine" id="cb222-8" title="8">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb222-9" title="9">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">lambda=</span>lambda)</a>
<a class="sourceLine" id="cb222-10" title="10">  ymax=<span class="fl">0.45</span></a>
<a class="sourceLine" id="cb222-11" title="11">  <span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">lambda=</span>lambda),</a>
<a class="sourceLine" id="cb222-12" title="12">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,ymax),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de probabilidad&quot;</span>,</a>
<a class="sourceLine" id="cb222-13" title="13">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st">  Po(lambda=&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb222-14" title="14">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb222-15" title="15">  <span class="kw">curve</span>(<span class="kw">ppois</span>(x,<span class="dt">lambda=</span>lambda),</a>
<a class="sourceLine" id="cb222-16" title="16">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de Distribución&quot;,</span></a>
<a class="sourceLine" id="cb222-17" title="17"><span class="st">         main=paste0(c(&quot;</span>Función de distribución \n <span class="kw">Po</span>(<span class="dt">lambda=</span><span class="st">&quot;,lambda,&quot;</span>)<span class="st">&quot;),collapse = &quot;&quot;))</span></a>
<a class="sourceLine" id="cb222-18" title="18"><span class="st">  par(mfrow=c(1,1))</span></a>
<a class="sourceLine" id="cb222-19" title="19"><span class="st">})</span></a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_Poisson2.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Cálculos con python</strong></p>
<p>Realicemos los mismos cálculos realizados con <code>R</code> pero ahora usando python. Recordemos que considerábamos una v.a. <span class="math inline">\(X\)</span> con distribución <span class="math inline">\(Po(\lambda=3)\)</span>. Calculemos <span class="math inline">\(P_X(0)=P(X=0), P_X(1)=P(X=1)\)</span> con python</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb223-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</a>
<a class="sourceLine" id="cb223-2" title="2">poisson.pmf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.049787068367863944</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb225-1" title="1">poisson.pmf(<span class="dv">1</span>,mu <span class="op">=</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.14936120510359185</code></pre>
<p>Si quisiéramos hallar las funciones de distribución en los mismos valores anteriores,
<span class="math inline">\(F_X(0)=P(X\leq 0), F_X(1)=P(X\leq 1)\)</span>, tendríamos que hacer:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb227-1" title="1">poisson.cdf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.04978706836786395</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb229-1" title="1">poisson.cdf(<span class="dv">1</span>,mu <span class="op">=</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.1991482734714558</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb231-1" title="1">poisson.pmf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)<span class="op">+</span>poisson.pmf(<span class="dv">1</span>,mu<span class="op">=</span> <span class="dv">3</span>) <span class="co">### es igual a poisson.cdf(1,lambda=3)</span></a></code></pre></div>
<pre><code>## 0.1991482734714558</code></pre>
<p>La comprobación de que <span class="math inline">\(F_X(10)=\displaystyle\sum_{0}^{10} P_X(x)\)</span> en python se realiza de la forma siguiente:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb233-1" title="1"><span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb235-1" title="1">poisson.pmf(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>),mu<span class="op">=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## array([0.04978707, 0.14936121, 0.22404181, 0.22404181, 0.16803136,
##        0.10081881, 0.05040941, 0.02160403, 0.00810151, 0.0027005 ])</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb237-1" title="1"><span class="bu">sum</span>(poisson.pmf(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>),mu<span class="op">=</span><span class="dv">3</span>))</a></code></pre></div>
<pre><code>## 0.9988975118698846</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb239-1" title="1">poisson.cdf(<span class="dv">10</span>,mu<span class="op">=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.9997076630493527</code></pre>
<div class="exercise">
<p><strong>Ejercicio de la trampa para insectos (continuación)</strong></p>
<p>En el ejercicio de la trampa para insectos teníamos que <span class="math inline">\(X\)</span> es una <span class="math inline">\(Po(20)\)</span>. Responded con python a la preguntas 3 y 4 de este ejercicio</p>
<div class="example-sol">
<p><strong>Pregunta 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X=21)\)</span>:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb241-1" title="1">poisson.pmf(<span class="dv">21</span>,mu<span class="op">=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb241-2" title="2"><span class="co">## P(X=21)</span></a></code></pre></div>
<pre><code>## 0.08460506418293791</code></pre>
<p><strong>Pregunta 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>La probabilidad pedida es <span class="math inline">\(P(X\geq 6)=1-P(X\leq 5)\)</span>:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb243-1" title="1"><span class="dv">1</span><span class="op">-</span>poisson.cdf(<span class="dv">5</span>,mu<span class="op">=</span><span class="dv">20</span>) </a>
<a class="sourceLine" id="cb243-2" title="2"><span class="co">## es 1-P(X&lt;=5)=P(X&gt;=6)</span></a></code></pre></div>
<pre><code>## 0.9999280911594716</code></pre>
<p>Como ya hemos visto con <code>scipy.stats</code>, podemos pedir los momentos de una variable aleatoria
<span class="math inline">\(Po(3)\)</span></p>
<div class="sourceCode" id="cb245"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb245-1" title="1">poisson.stats(mu<span class="op">=</span><span class="dv">3</span>, moments<span class="op">=</span><span class="st">&#39;mv&#39;</span>)</a></code></pre></div>
<pre><code>## (array(3.), array(3.))</code></pre>
<p>Y también generar secuencias de observaciones aleatorias de una población <span class="math inline">\(Po(3)\)</span>:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb247-1" title="1">poisson.rvs(mu<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">40</span>)</a></code></pre></div>
<pre><code>## array([4, 3, 6, 1, 6, 5, 1, 3, 2, 1, 2, 2, 6, 1, 2, 4, 1, 7, 1, 2, 1, 6,
##        2, 5, 6, 3, 2, 0, 1, 1, 2, 2, 1, 4, 0, 6, 4, 4, 2, 3])</code></pre>
</div>
</div>
<p><strong>Gráficos con python</strong></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb249-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</a>
<a class="sourceLine" id="cb249-2" title="2">mu <span class="op">=</span> <span class="dv">10</span> <span class="co">## mu = lambda</span></a>
<a class="sourceLine" id="cb249-3" title="3">x <span class="op">=</span> np.arange(poisson.ppf(<span class="fl">0.01</span>, mu),poisson.ppf(<span class="fl">0.99</span>, mu))</a>
<a class="sourceLine" id="cb249-4" title="4">fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</a>
<a class="sourceLine" id="cb249-5" title="5">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb249-6" title="6">ax.plot(x, poisson.pmf(x, mu), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;Poisson pmf&#39;</span>)</a>
<a class="sourceLine" id="cb249-7" title="7">ax.vlines(x, <span class="dv">0</span>, poisson.pmf(x, mu), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb249-8" title="8"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb249-9" title="9">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb249-10" title="10"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb249-11" title="11">  tick.label.set_fontsize(<span class="dv">5</span>) </a>
<a class="sourceLine" id="cb249-12" title="12">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb249-13" title="13">ax.plot(x, poisson.cdf(x, mu), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;Poisson cdf&#39;</span>)</a>
<a class="sourceLine" id="cb249-14" title="14">ax.vlines(x, <span class="dv">0</span>, poisson.cdf(x, mu), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb249-15" title="15"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb249-16" title="16">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb249-17" title="17"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb249-18" title="18">  tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb249-19" title="19">fig.suptitle(<span class="st">&#39;Distribucion de Poisson&#39;</span>)</a>
<a class="sourceLine" id="cb249-20" title="20">plt.show()</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/py_poiss2-1.png" width="480" /></p>
<p><strong>Gráficos interactivos para un proceso de Poisson <span class="math inline">\(Po(\lambda\cdot t\)</span>)</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb250-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb250-2" title="2">  <span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb250-3" title="3">      <span class="kw">column</span>(<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb250-4" title="4">           <span class="kw">sliderInput</span>(<span class="st">&quot;lambdapp&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Promedio eventos por unidad de tiempo&quot;</span>, </a>
<a class="sourceLine" id="cb250-5" title="5">                       <span class="dt">min =</span> <span class="fl">0.1</span>, <span class="dt">max =</span> <span class="dv">50</span>, <span class="dt">value =</span><span class="dv">10</span> , <span class="dt">step =</span> <span class="fl">0.01</span>)),</a>
<a class="sourceLine" id="cb250-6" title="6">    <span class="kw">column</span>(<span class="dv">6</span>,<span class="kw">sliderInput</span>(<span class="st">&quot;t&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Intervalo de tiempo (0,t]&quot;</span>, </a>
<a class="sourceLine" id="cb250-7" title="7">                         <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">120</span>, <span class="dt">value =</span><span class="dv">1</span> , <span class="dt">step =</span> <span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb250-8" title="8">   )</a>
<a class="sourceLine" id="cb250-9" title="9">)</a>
<a class="sourceLine" id="cb250-10" title="10"></a>
<a class="sourceLine" id="cb250-11" title="11"></a>
<a class="sourceLine" id="cb250-12" title="12"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb250-13" title="13">  lambda1=input<span class="op">$</span>lambdapp</a>
<a class="sourceLine" id="cb250-14" title="14">  t=input<span class="op">$</span>t</a>
<a class="sourceLine" id="cb250-15" title="15">  lambda=lambda1<span class="op">*</span>t <span class="co">## es lambda* t</span></a>
<a class="sourceLine" id="cb250-16" title="16">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb250-17" title="17">  n=<span class="kw">qpois</span>(<span class="fl">0.99</span>,<span class="dt">lambda=</span>lambda)</a>
<a class="sourceLine" id="cb250-18" title="18">  <span class="co">#n</span></a>
<a class="sourceLine" id="cb250-19" title="19">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb250-20" title="20">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,(n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span>,<span class="dv">2</span>)]=<span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">lambda=</span>lambda)</a>
<a class="sourceLine" id="cb250-21" title="21">  ymax=<span class="kw">ppois</span>(<span class="kw">which.max</span>(<span class="kw">ppois</span>(<span class="dv">0</span><span class="op">:</span>n,lambda))<span class="op">-</span><span class="dv">1</span>,lambda)<span class="op">*</span><span class="fl">0.7</span></a>
<a class="sourceLine" id="cb250-22" title="22">  <span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">y=</span><span class="kw">dpois</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>n),<span class="dt">lambda=</span>lambda),</a>
<a class="sourceLine" id="cb250-23" title="23">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,ymax),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de probabilidad&quot;</span>,</a>
<a class="sourceLine" id="cb250-24" title="24">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st">  Po(lambda=&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),<span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb250-25" title="25">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>n,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb250-26" title="26">  <span class="kw">curve</span>(<span class="kw">ppois</span>(x,<span class="dt">lambda=</span>lambda),</a>
<a class="sourceLine" id="cb250-27" title="27">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,n<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de Distribución&quot;,</span></a>
<a class="sourceLine" id="cb250-28" title="28"><span class="st">         main=paste0(c(&quot;</span>Función de distribución \n <span class="kw">Po</span>(<span class="dt">lambda=</span><span class="st">&quot;,lambda,&quot;</span>)<span class="st">&quot;),collapse = &quot;&quot;))</span></a>
<a class="sourceLine" id="cb250-29" title="29"><span class="st">  par(mfrow=c(1,1))</span></a>
<a class="sourceLine" id="cb250-30" title="30"><span class="st">  })</span></a></code></pre></div>
<!--![[](Images/noshinyImages/interactivos_proceso_Poisson1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="example">
<p><strong>Ejemplo: Número de impactos de insectos en la visera de un casco</strong></p>
<p>Un colega de trabajo, al que llamaremos JG, es muy aficionado a los grandes premios de velocidad tanto en coches como en motos.</p>
<p>Como es tan aficionado, está obsesionado con muchas de las más extravagantes estadísticas de estos deportes.
En particular le propusimos que estudiara el número de insectos que chocan contra la visera de un casco de un motorista GP o de un conductor de fórmula 1 .</p>
<p>La idea es que el número de insectos está igualmente repartido por todo el circuito y de promedio impactan <span class="math inline">\(\lambda&gt;0\)</span> insectos por minuto. También es razonable suponer que:</p>
<ul>
<li>podemos dividir la superficie de la visera en cuadrados suficientemente pequeños de forma que la probabilidad de que caigan dos insectos en la misma zona es prácticamente 0.</li>
<li>la probabilidad de que un insecto impacte en un cuadrado cualquiera de la visera es independiente de cualquier otro cuadrado.</li>
<li>si hemos dividido la visera en <span class="math inline">\(n\)</span> cuadrados la probabilidad <span class="math inline">\(p_n\)</span> de impacto de un cuadrado vale <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>.</li>
</ul>
<p>Bajo estas condiciones, si denotamos por <span class="math inline">\(X_t\)</span> como el número de insectos que ha impactado en la visera en el intervalo <span class="math inline">\((0,t]\)</span> (en <span class="math inline">\(t\)</span> minutos), podemos afirmar que <span class="math inline">\(X_t\)</span> es un proceso de Poisson <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p>Supongamos que nos dicen que <span class="math inline">\(\lambda=3\)</span> insectos por minuto. Entonces el proceso de Poisson <span class="math inline">\(X_t\)</span> seguirá un ley <span class="math inline">\(Po(3\cdot t).\)</span></p>
<p>Nos piden las probabilidades siguientes:</p>
<ol style="list-style-type: decimal">
<li>¿Cuál es la probabilidad de que en 10 minutos impacten más de 25 insectos?</li>
<li>¿Cuál es la probabilidad de que tengamos que esperar más de 2 minutos para observar el primer impacto?</li>
</ol>
<div class="exercise-sol">
<p><strong>Solución de 1. ¿Cuál es la probabilidad de que en 10 minutos impacten más de 25 insectos?</strong></p>
<p>En este caso <span class="math inline">\(t=10\)</span> y <span class="math inline">\(X_{10}\)</span> es la variable aleatoria que nos da el número de insectos que impactan en 10 minutos o durante el intervalo <span class="math inline">\([0,10)\)</span>. La distribución de <span class="math inline">\(X_{10}\)</span> será de Poisson de parámetro <span class="math inline">\(\lambda=3\cdot 10=30)\)</span>, <span class="math inline">\(Po(30)\)</span>.</p>
<p>Nos piden la probabilidad siguiente: <span class="math inline">\(P(X&gt;25)=1-P(X\leq 25)\)</span>, que calculamos con ayuda de <code>R</code>:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">dpois</span>(<span class="dv">25</span>,<span class="dt">lambda=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p><strong>Solución de 2. ¿Cuál es la probabilidad de que tengamos que esperar más de 2 minutos para observar el primer impacto?</strong></p>
<p>Nos piden la probabilidad siguiente <span class="math inline">\(P(X_2=0)\)</span> ya que la variable <span class="math inline">\(X_2\)</span> nos dice el número de impactos en dos minutos. La distribución de <span class="math inline">\(X_2\)</span> será de Poisson de parámetro <span class="math inline">\(\lambda =2\cdot 3=6\)</span>, <span class="math inline">\(Po(6)\)</span>. Si hemos de esperar más de dos minutos para el primer impacto, significa que <span class="math inline">\(X_2=0\)</span>:
<span class="math display">\[P(X_2=0)=\frac{(6)^0}{0!}\cdot e^{-6}= e^{-6}=0.002479.\]</span>
Si usamos <code>R</code>, obtenemos:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1"><span class="dv">6</span><span class="op">^</span><span class="dv">0</span><span class="op">/</span><span class="kw">factorial</span>(<span class="dv">0</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">6</span>)</a></code></pre></div>
<pre><code>## [1] 0.002478752</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1"><span class="kw">ppois</span>(<span class="dv">0</span>,<span class="dt">lambda=</span><span class="dv">3</span><span class="op">*</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.002478752</code></pre>
</div>
</div>
</div>
<div id="distribución-hipergeométrica" class="section level3">
<h3><span class="header-section-number">3.1.6</span> Distribución hipergeométrica</h3>
<p>Supongamos que disponemos de una urna de de sorteos que contiene <span class="math inline">\(m\)</span> bolas blancas y <span class="math inline">\(n\)</span> bolas rojas.</p>
<p>En total en esta urna hay <span class="math inline">\(m+n\)</span> bolas, <span class="math inline">\(m\)</span> blancas y <span class="math inline">\(n\)</span> rojas. Si extraemos dos bolas de la urna lo podemos hacer de dos formas:</p>
<ul>
<li>Extraer una anotar su color y reponerla. Sacar otra y anotar su color. Hemos extraído la bola con reposición.</li>
<li>Extraer simultáneamente dos bolas (sin reposición) y contar el número de bolas blancas.</li>
</ul>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de bolas blancas extraídas.</p>
<p>Sea <span class="math inline">\(X\)</span> es la v.a. que cuenta el número de bolas blancas extraídas.</p>
<ul>
<li>En el primer caso, <span class="math inline">\(X\)</span> es una <span class="math inline">\(B(n=2,p=\frac{m}{m+n})\)</span> ya que consiste en repetir dos veces el mismo experimento de Bernoulli.</li>
<li>En el segundo caso, <span class="math inline">\(X\)</span> sigue una distribución hipergeométrica que estudiaremos en esta sección.</li>
</ul>
<p><l class="definition"> <strong>Distribución hipergeométrica</strong> </l></p>
<p>Sean <span class="math inline">\(n\)</span>, <span class="math inline">\(m\)</span> y <span class="math inline">\(k\)</span> tres número enteros positivos y tales que <span class="math inline">\(k&lt;m+n\)</span>.</p>
<p>Consideremos una urna que contiene <span class="math inline">\(m+n\)</span> bolas de las que <span class="math inline">\(m\)</span> son blancas y las restantes <span class="math inline">\(n\)</span> no (son no blancas).</p>
<p>El número total de bolas es <span class="math inline">\(m+n\)</span>. Extraemos de forma aleatoria <span class="math inline">\(k\)</span> bolas de la urna sin reemplazarlas.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de bolas blancas extraídas. Diremos que la distribución de <span class="math inline">\(X\)</span> es hipergeométrica de parámetros <span class="math inline">\(m\)</span>, <span class="math inline">\(n\)</span> y <span class="math inline">\(k\)</span> y la denotaremos por <span class="math inline">\(H(m,n,k)\)</span>.</p>
<p>Su dominio es</p>
<p><span class="math display">\[D_X=\left\{x\in\mathbf{N}\mid \max\{0,k-n\}\leq  x \leq \min\{m,k\}\right\}\]</span></p>
<p>Para explicarlo, veamos varios ejemplos:</p>
<ul>
<li><span class="math inline">\(H(m=5,n=2,k=3)\)</span>. Tenemos <span class="math inline">\(m=5\)</span> bolas blancas, <span class="math inline">\(n=2\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso el mínimo de bolas blancas extraídas es <span class="math inline">\(1=k-n=3-2\)</span>, ya que sólo hay dos no blancas.</li>
<li>En cambio, el máximo si es <span class="math inline">\(k=3\)</span>, ya que tenemos bolas blancas de “sobra”.</li>
</ul></li>
<li><span class="math inline">\(H(m=2,n=5,k=3)\)</span>. Tenemos <span class="math inline">\(m=2\)</span> bolas blancas, <span class="math inline">\(n=5\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso el mínimo de bolas blancas es <span class="math inline">\(0\)</span> ya que puedo sacar 3 no blancas.</li>
<li>En cambio, el máximo si es <span class="math inline">\(m=2\)</span>, ya que aunque saquemos <span class="math inline">\(k=3\)</span> bolas, al llegar a 2 ya hemos extraído todas las bolas blancas de la urna.</li>
</ul></li>
<li><span class="math inline">\(H(m=10,n=10,k=3)\)</span>. Tenemos <span class="math inline">\(m=10\)</span> bolas blancas, <span class="math inline">\(n=10\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso podemos obtener desde <span class="math inline">\(0\)</span> blancas hasta <span class="math inline">\(k=3\)</span> blancas.</li>
</ul></li>
</ul>
<p>Su función de probabilidad es:
<span class="math display">\[
P_{X}(x)=\left\{
\begin{array}{ll}
\frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}}, &amp; \mbox{ si }
\max\{0,k-n\}\leq x \leq \min\{m,k\}, \mbox { para  } x\in \mathbf{N},\\
0,  &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><l class="observ"> <strong>Observación: otras parametrizaciones</strong> </l></p>
<p>En ocasiones se parametriza una v.a. hipergeométrica mediante <span class="math inline">\(N=m+n\)</span>, número total de bolas,
<span class="math inline">\(k\)</span>, número de extracciones y <span class="math inline">\(p\)</span>, probabilidad de extraer una bola blanca.</p>
<p>Así, podemos <strong>parametrizar alternativamente</strong> la distribución hipergeométrica como
<span class="math inline">\(H(N,k,p)\)</span> donde <span class="math inline">\(p=\frac{m}{N}.\)</span></p>
<p><strong>Resumen hipergeométrica <span class="math inline">\(H(m,n,k)\)</span></strong></p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X=\)</span>número de bolas blancas en <span class="math inline">\(k\)</span> extracciones sin reposición de una urna con <span class="math inline">\(m\)</span> bolas blancas y <span class="math inline">\(n\)</span> negras.</th>
<th align="left"><span class="math inline">\(H(m,n,k)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X\)</span>=</td>
<td align="left"><span class="math inline">\(\left\{x\in\mathbf{N}\mid \max\{0,k-n\}\leq x \leq \min\{m,k\}\right\}\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{ \begin{array}{ll} \frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}}, &amp; \mbox{ si } \max\{0,k-n\}\leq x \leq \min\{m,k\}, \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq x)\)</span></td>
<td align="left">Hay que sumarla. Utilizad funciones de <code>R</code> o de python.</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\frac{k\cdot m}{m+n}\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=k\cdot\frac{m}{m+n}\cdot\left(1-\frac{m}{m+n}\right) \cdot\frac{m+n-k}{m+n-1}\)</span></td>
</tr>
</tbody>
</table>
<div class="example">
<p><strong>Ejemplo: urna con <span class="math inline">\(m=15\)</span> blancas, <span class="math inline">\(n=10\)</span> rojas y <span class="math inline">\(k=3\)</span> extracciones sin reposición</strong></p>
<p>Tenemos una urna con 15 bolas blancas y 10 bolas rojas. Extraemos al azar tres bolas de la urna sin reposición. Sea <span class="math inline">\(X\)</span> el número de bolas <strong>blancas</strong> extraídas. Bajo esta condiciones, la v.a. <span class="math inline">\(X\)</span> sigue una ley de distribución <span class="math inline">\(H(m=15,n=10,k=3)\)</span>.</p>
<p>Nos piden:</p>
<ol style="list-style-type: decimal">
<li>Hallar la función de probabilidad de <span class="math inline">\(X\)</span>.</li>
<li>Probabilidad de sacar dos bolas blancas.</li>
<li>Probabilidad de sacar más de una bola blanca.</li>
<li>Esperanza, varianza y desviación típica de <span class="math inline">\(X\)</span>.</li>
</ol>
<div class="example-sol">
<p><strong>Solución de 1. Hallar la función de probabilidad de <span class="math inline">\(X\)</span></strong></p>
<p>La función de probabilidad de <span class="math inline">\(X\)</span> es:
<span class="math display">\[
P_X(x)=P(X=x)=\left\{
\begin{array}{ll}
\frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}}, &amp; \mbox{ si }
\max\{0,k-n\}\leq x \leq \min\{m,k\}, \mbox { para  } x\in \mathbf{N},\\
0,  &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Sustituyendo los parámetros <span class="math inline">\(m,n\)</span> y <span class="math inline">\(k\)</span> por <span class="math inline">\(m=15\)</span>, <span class="math inline">\(n=10\)</span> y <span class="math inline">\(k=3\)</span>, obtenemos:</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{
\begin{array}{ll}
\frac{\binom{15}{x}\cdot \binom{10}{3-x}}{\binom{25}{3}}= \frac{\binom{15}{x}\cdot \binom{10}{3-x}}{2300}, &amp; \mbox{ si }
0\leq x \leq 3, \mbox { para  } x\in \mathbf{N},\\
0,  &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><strong>Solución de 2. Probabilidad de sacar dos bolas blancas</strong></p>
<p>La probabilidad de sacar 2 blancas será:
<span class="math display">\[
P(X=2)=\frac{\binom{15}{2}\cdot \binom{10}{3-2}}{\binom{25}{3}}
\]</span></p>
<p>Si calculamos con ayuda de <code>R</code> los números binomiales involucrados en la expresión anterior, obtenemos:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1"><span class="kw">c</span>(<span class="kw">choose</span>(<span class="dv">15</span>,<span class="dv">2</span>), <span class="kw">choose</span>(<span class="dv">10</span>,<span class="dv">1</span>), <span class="kw">choose</span>(<span class="dv">25</span>,<span class="dv">3</span>))</a></code></pre></div>
<pre><code>## [1]  105   10 2300</code></pre>
<p>La probabilidad pedida, será, pues:
<span class="math inline">\(P(X=2)=\frac{105\cdot10 }{2300}=0.4565217.\)</span></p>
<p><strong>Solución de 3. Probabilidad de sacar más de una bola blanca</strong></p>
<p>La probabilidad de que saquemos más de 1 bola blanca es:
<span class="math display">\[
\begin{array}{rl}
P(X&gt; 1)&amp;= 1-P(X\leq 1)=1-(P(X=0)+P(X=1))\\
&amp;=
1-\left(\frac{\binom{15}{0}\cdot \binom{10}{3}}{\binom{25}{3}}+
\frac{\binom{15}{1}\cdot \binom{10}{2}}{\binom{25}{3}}\right)\\
&amp;=
1-\left(
\frac{1\cdot120 }{2300}+\frac{15\cdot45 }{2300}
\right)=1-\frac{120+15\cdot 45}{2300}=0.6543478.
\end{array}
\]</span></p>
<p><strong>Solución de 4. Esperanza, varianza y desviación típica de <span class="math inline">\(X\)</span></strong></p>
<p>El número esperado de bolas blancas extraídas para una v.a. <span class="math inline">\(X\)</span> de distribución <span class="math inline">\(H(m=15,n=10,k=3)\)</span> es:</p>
<p><span class="math display">\[E(X)=\frac{k\cdot m}{m+n}=\frac{3\cdot 15}{15+10}=\frac{45}{35}=1.285714.\]</span>
La varianza vale:
<span class="math display">\[
\begin{array}{rl}
Var(X)&amp;=k\cdot\frac{m}{m+n}\cdot\left(1-\frac{m}{m+n}\right) \cdot\frac{m+n-k}{m+n-1}\\
&amp;=3\cdot\frac{15}{15+10}\cdot\left(1-\frac{15}{15+10}\right) \cdot\frac{15+10-3}{15+10-1}\\
&amp;=
3\cdot\frac{15}{25}\cdot\left(1-\frac{15}{25}\right) \cdot\frac{22}{24}= 
3\cdot\frac{15}{25}\cdot\frac{25-15}{25} \cdot\frac{22}{24}\\
&amp;=
3\cdot\frac{15}{25}\cdot\frac{10}{25}\cdot\frac{22}{24}=0.66.
\end{array}
\]</span></p>
<p>Y por lo tanto, su desviación típica es:</p>
<p><span class="math display">\[
+\sqrt{Var(X)}=+\sqrt{0.66}=0.812404.
\]</span></p>
</div>
</div>
<p><strong>Cálculos con R</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. <span class="math inline">\(H(m,n,k)\)</span>. La función de <code>R</code> para calcular la función de probabilidad en un valor <span class="math inline">\(x\)</span>, <span class="math inline">\(P(X=x)\)</span>, es <code>dhyper(x,m,n,k)</code> y para calcular la función de distribución en un valor <span class="math inline">\(q\)</span>, <span class="math inline">\(P(X\leq q)\)</span>, es <code>phyper(q,m,n,k)</code>. Para generar una muestra de valores que siga la distribución <span class="math inline">\(H(m,n,k)\)</span>, hay que usar la función <code>rhyper(nn,m,n,k)</code> donde <code>nn</code> es el número de observaciones aleatorias deseado de la muestra.</p>
<p>Por ejemplo, si <span class="math inline">\(X\)</span> es una <span class="math inline">\(H(m=15,n=10,k=3)\)</span>, los valores de <span class="math inline">\(P(X=2)\)</span> y que <span class="math inline">\(P(X&gt;1)=1-P(X\leq 1)\)</span> son:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1"><span class="kw">dhyper</span>(<span class="dt">x=</span><span class="dv">2</span>,<span class="dt">m=</span><span class="dv">15</span>,<span class="dv">10</span>,<span class="dt">k=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.4565217</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1"><span class="kw">phyper</span>(<span class="dt">q=</span><span class="dv">1</span>,<span class="dt">m=</span><span class="dv">15</span>,<span class="dt">n=</span><span class="dv">10</span>,<span class="dt">k=</span><span class="dv">3</span>)<span class="co">## sí, le han puesto q ya veremos el porqué</span></a></code></pre></div>
<pre><code>## [1] 0.3456522</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">phyper</span>(<span class="dt">q=</span><span class="dv">1</span>,<span class="dt">m=</span><span class="dv">15</span>,<span class="dt">n=</span><span class="dv">10</span>,<span class="dt">k=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.6543478</code></pre>
<p>Una muestra aleatoria de este experimento de tamaño 200 sería:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1"><span class="kw">rhyper</span>(<span class="dt">nn=</span><span class="dv">200</span>,<span class="dt">m=</span><span class="dv">15</span>,<span class="dt">n=</span><span class="dv">10</span>,<span class="dt">k=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 2 3 1 3 1 2 2 3 2 2 1 2 1 2 2 3 3 1 1 1 1 0 2 3 2 1 3 2 2 2 2 3 2 3 3
##  [36] 2 0 1 2 1 3 2 2 3 2 3 2 2 3 2 3 1 2 2 2 2 3 2 2 1 3 2 2 3 1 2 2 2 2 2
##  [71] 3 0 2 0 3 2 2 2 1 2 2 3 1 1 1 2 2 2 2 1 1 3 2 2 3 2 2 1 1 1 3 3 2 2 2
## [106] 1 3 2 2 2 1 1 2 3 2 2 1 2 2 2 2 2 2 3 1 2 3 3 1 1 2 2 1 1 3 2 1 1 2 2
## [141] 3 1 1 1 2 1 1 3 1 2 2 3 3 2 3 1 2 1 2 2 2 1 2 3 1 3 3 3 2 2 1 3 3 1 1
## [176] 2 2 2 2 2 3 2 1 2 1 1 1 1 2 1 1 2 2 2 2 3 3 1 0 2</code></pre>
<p><strong>Gráficas con R</strong></p>
<p>Los gráficos de la función de probabilidad y de la función de distribución en <code>R</code> se realizan de la forma siguiente:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb267-2" title="2">m=<span class="dv">15</span></a>
<a class="sourceLine" id="cb267-3" title="3">n=<span class="dv">10</span></a>
<a class="sourceLine" id="cb267-4" title="4">k=<span class="dv">3</span></a>
<a class="sourceLine" id="cb267-5" title="5">a=<span class="kw">max</span>(<span class="kw">c</span>(<span class="dv">0</span>,k<span class="op">-</span>n))</a>
<a class="sourceLine" id="cb267-6" title="6">b=<span class="kw">min</span>(<span class="kw">c</span>(m,k))</a>
<a class="sourceLine" id="cb267-7" title="7">l=b<span class="op">-</span>a<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb267-8" title="8">aux=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>l)</a>
<a class="sourceLine" id="cb267-9" title="9">aux[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>l,<span class="dv">2</span>)]=<span class="kw">dhyper</span>(<span class="kw">c</span>(a<span class="op">:</span>b),<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb267-10" title="10">x=a<span class="op">:</span>b</a>
<a class="sourceLine" id="cb267-11" title="11"><span class="kw">plot</span>(x,<span class="dt">y=</span><span class="kw">dhyper</span>(x,<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k),</a>
<a class="sourceLine" id="cb267-12" title="12">  <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(a<span class="dv">-1</span>,b<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb267-13" title="13">  <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> H(m=&quot;</span>,m,<span class="st">&quot;, n=&quot;</span>,n,<span class="st">&quot;, k=&quot;</span>,k,<span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb267-14" title="14"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(a<span class="op">:</span>b,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb267-15" title="15"><span class="kw">curve</span>(<span class="kw">phyper</span>(x,<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k),</a>
<a class="sourceLine" id="cb267-16" title="16">  <span class="dt">xlim=</span><span class="kw">c</span>(a<span class="dv">-1</span>,b<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb267-17" title="17">  <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de distribución\n H(m=&quot;</span>,m,<span class="st">&quot;, n=&quot;</span>,n,<span class="st">&quot;, k=&quot;</span>,k,<span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb267-18" title="18"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-79-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Gráficos interactivos <span class="math inline">\(H(m,n,k)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb268-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb268-3" title="3">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb268-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;mh&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número de bolas blancas m&quot;</span>,</a>
<a class="sourceLine" id="cb268-5" title="5">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">50</span>, <span class="dt">value =</span><span class="dv">15</span>, <span class="dt">step =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb268-6" title="6">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb268-7" title="7">         <span class="kw">sliderInput</span>(<span class="st">&quot;nh&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número de bolas rojas n&quot;</span>,</a>
<a class="sourceLine" id="cb268-8" title="8">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">50</span>, <span class="dt">value =</span><span class="dv">10</span> , <span class="dt">step =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb268-9" title="9">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb268-10" title="10">          <span class="kw">sliderInput</span>(<span class="st">&quot;kh&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número bolas extraídas k&quot;</span>,</a>
<a class="sourceLine" id="cb268-11" title="11">                     <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max=</span><span class="dv">25</span>, <span class="dt">value =</span> <span class="dv">3</span>, <span class="dt">step =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb268-12" title="12">         )</a>
<a class="sourceLine" id="cb268-13" title="13">  )</a>
<a class="sourceLine" id="cb268-14" title="14">)</a>
<a class="sourceLine" id="cb268-15" title="15"></a>
<a class="sourceLine" id="cb268-16" title="16"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb268-17" title="17">  m=input<span class="op">$</span>mh</a>
<a class="sourceLine" id="cb268-18" title="18">  n=input<span class="op">$</span>nh</a>
<a class="sourceLine" id="cb268-19" title="19">  k=input<span class="op">$</span>kh</a>
<a class="sourceLine" id="cb268-20" title="20">  <span class="co">#n=10</span></a>
<a class="sourceLine" id="cb268-21" title="21">  <span class="co">#k=3</span></a>
<a class="sourceLine" id="cb268-22" title="22">  <span class="co">#m=15</span></a>
<a class="sourceLine" id="cb268-23" title="23">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb268-24" title="24">  a=<span class="kw">max</span>(<span class="kw">c</span>(<span class="dv">0</span>,k<span class="op">-</span>n))</a>
<a class="sourceLine" id="cb268-25" title="25">  b=<span class="kw">min</span>(<span class="kw">c</span>(m,k))</a>
<a class="sourceLine" id="cb268-26" title="26">  l=b<span class="op">-</span>a<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb268-27" title="27">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dt">times=</span><span class="dv">2</span><span class="op">*</span>l)</a>
<a class="sourceLine" id="cb268-28" title="28">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>l,<span class="dv">2</span>)]=<span class="kw">dhyper</span>(<span class="kw">c</span>(a<span class="op">:</span>b),<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb268-29" title="29">  x=a<span class="op">:</span>b</a>
<a class="sourceLine" id="cb268-30" title="30">  <span class="kw">plot</span>(x,<span class="dt">y=</span><span class="kw">dhyper</span>(x,<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k),</a>
<a class="sourceLine" id="cb268-31" title="31">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(a<span class="dv">-1</span>,b<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,</a>
<a class="sourceLine" id="cb268-32" title="32">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de probabilidad</span><span class="ch">\n</span><span class="st"> H(m=&quot;</span>,m,<span class="st">&quot;, n=&quot;</span>,n,<span class="st">&quot;, k=&quot;</span>,k,<span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb268-33" title="33">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(a<span class="op">:</span>b,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb268-34" title="34">  <span class="kw">curve</span>(<span class="kw">phyper</span>(x,<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k),</a>
<a class="sourceLine" id="cb268-35" title="35">        <span class="dt">xlim=</span><span class="kw">c</span>(a<span class="dv">-1</span>,b<span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb268-36" title="36">        <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de distribución\n H(m=&quot;</span>,m,<span class="st">&quot;, n=&quot;</span>,n,<span class="st">&quot;, k=&quot;</span>,k,<span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb268-37" title="37">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb268-38" title="38">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactivos_hiper_geom1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Comparación <span class="math inline">\(H(m,n,k)\)</span> y <span class="math inline">\(B\left(k,\frac{m}{n+m}\right)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb269-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb269-3" title="3">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb269-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;mh2&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número de bolas blancas m&quot;</span>,</a>
<a class="sourceLine" id="cb269-5" title="5">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">50</span>, <span class="dt">value =</span><span class="dv">15</span>, <span class="dt">step =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb269-6" title="6">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb269-7" title="7">         <span class="kw">sliderInput</span>(<span class="st">&quot;nh2&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número de bolas rojas n&quot;</span>,</a>
<a class="sourceLine" id="cb269-8" title="8">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">50</span>, <span class="dt">value =</span><span class="dv">10</span> , <span class="dt">step =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb269-9" title="9">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb269-10" title="10">          <span class="kw">sliderInput</span>(<span class="st">&quot;kh2&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Número bolas extraídas k&quot;</span>,</a>
<a class="sourceLine" id="cb269-11" title="11">                     <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max=</span><span class="dv">25</span>, <span class="dt">value =</span> <span class="dv">3</span>, <span class="dt">step =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb269-12" title="12">         )</a>
<a class="sourceLine" id="cb269-13" title="13">  )</a>
<a class="sourceLine" id="cb269-14" title="14">)</a>
<a class="sourceLine" id="cb269-15" title="15"></a>
<a class="sourceLine" id="cb269-16" title="16"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb269-17" title="17">  m=input<span class="op">$</span>mh2</a>
<a class="sourceLine" id="cb269-18" title="18">  n=input<span class="op">$</span>nh2</a>
<a class="sourceLine" id="cb269-19" title="19">  k=input<span class="op">$</span>kh2</a>
<a class="sourceLine" id="cb269-20" title="20">  <span class="co">#n=10</span></a>
<a class="sourceLine" id="cb269-21" title="21">  <span class="co">#k=3</span></a>
<a class="sourceLine" id="cb269-22" title="22">  <span class="co">#m=15</span></a>
<a class="sourceLine" id="cb269-23" title="23">  pr=<span class="kw">round</span>(m<span class="op">/</span>(n<span class="op">+</span>m),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb269-24" title="24">  a=<span class="kw">max</span>(<span class="kw">c</span>(<span class="dv">0</span>,k<span class="op">-</span>n))</a>
<a class="sourceLine" id="cb269-25" title="25">  b=<span class="kw">min</span>(<span class="kw">c</span>(m,k))</a>
<a class="sourceLine" id="cb269-26" title="26">  l=b<span class="op">-</span>a<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb269-27" title="27">  aux=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dt">times=</span><span class="dv">2</span><span class="op">*</span>l)</a>
<a class="sourceLine" id="cb269-28" title="28">  auxB=<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dt">times=</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb269-29" title="29">  aux[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>l,<span class="dv">2</span>)]=<span class="kw">dhyper</span>(<span class="kw">c</span>(a<span class="op">:</span>b),<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb269-30" title="30">  x=a<span class="op">:</span>b</a>
<a class="sourceLine" id="cb269-31" title="31">  auxB[<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="op">*</span>(k<span class="op">+</span><span class="dv">1</span>),<span class="dv">2</span>)]=<span class="kw">dbinom</span>(<span class="dv">0</span><span class="op">:</span>k,k,pr)</a>
<a class="sourceLine" id="cb269-32" title="32">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb269-33" title="33">  <span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>k),<span class="dt">y=</span><span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>k),<span class="dt">size=</span>k,<span class="dt">prob=</span>pr),</a>
<a class="sourceLine" id="cb269-34" title="34">       <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Función de probabilidad&quot;</span>,</a>
<a class="sourceLine" id="cb269-35" title="35">       <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Funciones de probabilidad</span><span class="ch">\n</span><span class="st"> B(n=&quot;</span>,n,<span class="st">&quot;p=&quot;</span>,pr,<span class="st">&quot;)  </span></a>
<a class="sourceLine" id="cb269-36" title="36"><span class="st">                   H(m=&quot;</span>,m,<span class="st">&quot;n=&quot;</span>, n,<span class="st">&quot;k=&quot;</span>,k,<span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb269-37" title="37">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>k,<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux,<span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb269-38" title="38">  <span class="co">#aux=rep(0,(n+1)*2)</span></a>
<a class="sourceLine" id="cb269-39" title="39">  <span class="co">#aux[seq(2,(n+1)*2,2)]=dpois(c(0:n),n*pr)</span></a>
<a class="sourceLine" id="cb269-40" title="40">  <span class="kw">points</span>(<span class="dt">x=</span><span class="kw">c</span>(a<span class="op">:</span>b),<span class="dt">y=</span><span class="kw">dhyper</span>(<span class="kw">c</span>(a<span class="op">:</span>b),<span class="dt">m=</span>m,<span class="dt">n=</span>n,<span class="dt">k=</span>k),</a>
<a class="sourceLine" id="cb269-41" title="41">         <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>),<span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">pch=</span><span class="dv">25</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb269-42" title="42">  <span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span>(l<span class="dv">-1</span>),<span class="dt">each=</span><span class="dv">2</span>),<span class="dt">y=</span>aux, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb269-43" title="43">  <span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Binomial&quot;</span>,<span class="st">&quot;Hipergeométrica&quot;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb269-44" title="44">         <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">25</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb269-45" title="45">  <span class="kw">curve</span>(<span class="kw">pbinom</span>(x,<span class="dt">size=</span>k,<span class="dt">p=</span>pr),</a>
<a class="sourceLine" id="cb269-46" title="46">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Función de Distribución&quot;,</span></a>
<a class="sourceLine" id="cb269-47" title="47"><span class="st">         main=paste0(&quot;</span>Funciones de distribución\n <span class="kw">B</span>(<span class="st">&quot;,k,&quot;</span>,<span class="st">&quot;,pr,&quot;</span>) </a>
<a class="sourceLine" id="cb269-48" title="48">                     <span class="kw">H</span>(<span class="dt">m=</span><span class="st">&quot;,m,&quot;</span><span class="dt">n=</span><span class="st">&quot;, n,&quot;</span><span class="dt">k=</span><span class="st">&quot;,k,&quot;</span>)<span class="st">&quot;))</span></a>
<a class="sourceLine" id="cb269-49" title="49"><span class="st">  curve(phyper(x,m=m,n=n,k=k),</span></a>
<a class="sourceLine" id="cb269-50" title="50"><span class="st">        xlim=c(-1,k+1),col=&quot;</span>red<span class="st">&quot;,add=TRUE)</span></a>
<a class="sourceLine" id="cb269-51" title="51"><span class="st">  #if(all(c(n&gt;=20,n*pr&lt;10,pr&lt;= 0.05))){aux_l=&quot;</span>Condición VERDADERA<span class="st">&quot;} </span></a>
<a class="sourceLine" id="cb269-52" title="52"><span class="st">  else {aux_l=&quot;</span>Condición FALSA<span class="st">&quot;}</span></a>
<a class="sourceLine" id="cb269-53" title="53"><span class="st">  #legend(&quot;</span>topleft<span class="st">&quot;,legend=c(aux_l,paste0(&quot;</span><span class="dt">n=</span><span class="st">&quot;,n),paste0(&quot;</span>n<span class="op">*</span><span class="dt">p=</span><span class="st">&quot;,n*pr),</span></a>
<a class="sourceLine" id="cb269-54" title="54"><span class="st">  paste0(&quot;</span><span class="dt">p=</span><span class="st">&quot;,pr)),bg=&quot;</span>transparent<span class="st">&quot;,cex=0.5)</span></a>
<a class="sourceLine" id="cb269-55" title="55"><span class="st">  par(mfrow=c(1,1))</span></a>
<a class="sourceLine" id="cb269-56" title="56"><span class="st">})</span></a></code></pre></div>
<!--[![](Images/noshinyImages/interactivos_hipergeom_binom1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Cálculos con python</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(H(m,n,k)\)</span>. Las funciones de <code>scipy.stats</code> cambian los parámetros de la forma siguiente:</p>
<ul>
<li><span class="math inline">\(M\)</span> es el número total de bolas. Con nuestra parametrización <span class="math inline">\(M=m+n\)</span>.</li>
<li><span class="math inline">\(n\)</span> es el número de bolas blancas. Con nuestra parametrización <span class="math inline">\(n=m\)</span>.</li>
<li><span class="math inline">\(N\)</span> es el número de extracciones. Con nuestra parametrización <span class="math inline">\(N=k\)</span>.</li>
</ul>
<div class="sourceCode" id="cb270"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb270-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> hypergeom</a></code></pre></div>
<p>Los cálculos realizados anteriormente en <code>R</code> serían:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb271-1" title="1">hypergeom.pmf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.29347826086956585</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb273-1" title="1">hypergeom.cdf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.3456521739130442</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb275-1" title="1"><span class="dv">1</span><span class="op">-</span>hypergeom.cdf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 0.6543478260869557</code></pre>
<p>Una muestra aleatoria de este experimento sería:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb277-1" title="1">hypergeom.rvs(M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">100</span>)</a></code></pre></div>
<pre><code>## array([0, 2, 3, 2, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 1, 2, 2,
##        2, 1, 2, 2, 2, 2, 1, 3, 2, 2, 1, 1, 1, 3, 2, 3, 2, 2, 2, 3, 2, 2,
##        2, 2, 2, 1, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 1, 3, 2, 2, 1, 2, 3, 2,
##        1, 3, 2, 1, 2, 3, 2, 1, 1, 1, 1, 2, 2, 1, 2, 2, 2, 2, 2, 3, 1, 3,
##        2, 2, 1, 3, 2, 2, 1, 2, 2, 1, 2, 2])</code></pre>
<p>Los gráficos de la función de probabilidad y de la función de distribución en python se realizan de la forma siguiente:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb279-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> hypergeom</a>
<a class="sourceLine" id="cb279-2" title="2">[M, n, N] <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">7</span>, <span class="dv">12</span>] <span class="co">##20 elementos, 7 del tipo, extraemos 12</span></a>
<a class="sourceLine" id="cb279-3" title="3">x <span class="op">=</span> np.arange(<span class="bu">max</span>(<span class="dv">0</span>, N<span class="op">-</span>M<span class="op">+</span>n),<span class="bu">min</span>(n, N))</a>
<a class="sourceLine" id="cb279-4" title="4">fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</a>
<a class="sourceLine" id="cb279-5" title="5"> <span class="op">=</span>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb279-6" title="6"> <span class="op">=</span>ax.plot(x, hypergeom.pmf(x, M, n, N), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;hypergeom pmf&#39;</span>)</a>
<a class="sourceLine" id="cb279-7" title="7"> <span class="op">=</span>ax.vlines(x, <span class="dv">0</span>, hypergeom.pmf(x, M, n, N), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb279-8" title="8"> <span class="op">=</span>ax.set_ylim([<span class="dv">0</span>, <span class="bu">max</span>(hypergeom.pmf(x, M, n, N))<span class="op">*</span><span class="fl">1.1</span>])</a>
<a class="sourceLine" id="cb279-9" title="9"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb279-10" title="10">   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb279-11" title="11"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb279-12" title="12">  <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>) </a>
<a class="sourceLine" id="cb279-13" title="13">ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb279-14" title="14"> <span class="op">=</span>ax.plot(x, hypergeom.cdf(x, M, n, N), <span class="st">&#39;bo&#39;</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">&#39;hypergeom cdf&#39;</span>)</a>
<a class="sourceLine" id="cb279-15" title="15"> <span class="op">=</span>ax.vlines(x, <span class="dv">0</span>, hypergeom.cdf(x, M, n, N), colors<span class="op">=</span><span class="st">&#39;b&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb279-16" title="16"><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb279-17" title="17">   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb279-18" title="18"><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</a>
<a class="sourceLine" id="cb279-19" title="19">   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb279-20" title="20"> <span class="op">=</span>fig.suptitle(<span class="st">&#39;Distribucion Hipergeometrica&#39;</span>)</a>
<a class="sourceLine" id="cb279-21" title="21"> <span class="op">=</span>plt.show()</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/py_hyper2-1.png" width="480" /></p>
</div>
</div>
<div id="cuantiles-de-distribuciones-notables-discretas" class="section level2">
<h2><span class="header-section-number">3.2</span> Cuantiles de distribuciones notables discretas</h2>
<div class="example">
<p><strong>Ejemplo</strong></p>
<p>Consideremos una v.a. <span class="math inline">\(X\)</span> de distribución <span class="math inline">\(B(5,0.5)\)</span>.</p>
<p>Los cuantiles <span class="math inline">\(x_{0.3}\)</span>, <span class="math inline">\(x_{0.6}\)</span> y <span class="math inline">\(x_{0.8}\)</span> son los siguientes:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1"><span class="kw">qbinom</span>(<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>),<span class="dv">5</span>,<span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## [1] 2 3 3</code></pre>
<p>Calculemos a mano, el valor <span class="math inline">\(x_{0.3}\)</span> y verifiquemos que da el mismo resultado que nos ha dado <code>R</code>.</p>
<p>La función de distribución de <span class="math inline">\(X\)</span> es:
<span class="math display">\[
\small{
F_x(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; x&lt; 0, \\
0.03125, &amp; \mbox{ si } 0 \leq x&lt; 1, \\
0.18750, &amp; \mbox{ si } 1 \leq x&lt; 2, \\
0.50000, &amp; \mbox{ si } 2 \leq x&lt; 3, \\
0.81250, &amp; \mbox{ si } 3 \leq x&lt; 4, \\
0.96875, &amp; \mbox{ si } 4 \leq x&lt; 5, \\
1.00000, &amp; \mbox{ si }  5\leq x. \\
\end{array}
\right.}
\]</span></p>
<p>El cuantil <span class="math inline">\(q=0.3\)</span> es el primer valor <span class="math inline">\(x\in D_X\)</span> tal que <span class="math inline">\(F_X(x)=P(X\leq x_{0.3})\geq 0.3\)</span>. Mirando la expresión anterior, comprobamos que <span class="math inline">\(x_{0.3}=2\)</span> ya que <span class="math inline">\(F_X(2)=P(X\leq 2)=0.5 \geq 0.3\)</span>.</p>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Calcular los cuantiles de <span class="math inline">\(0.6\)</span> y <span class="math inline">\(0.8\)</span> de una <span class="math inline">\(B(5,0.5).\)</span></p>
</div>
<p><strong>Gráfico interactivo que muestra los cuantiles de las distribuciones <span class="math inline">\(B(n,p)\)</span> y <span class="math inline">\(Po(\lambda)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb282-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb282-3" title="3">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb282-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;nq&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Par. n B(n,p)&quot;</span>,</a>
<a class="sourceLine" id="cb282-5" title="5">              <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">20</span>, <span class="dt">value =</span><span class="dv">10</span> , <span class="dt">step =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb282-6" title="6">         ),</a>
<a class="sourceLine" id="cb282-7" title="7">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb282-8" title="8">          <span class="kw">sliderInput</span>(<span class="st">&quot;pq&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Par. p B(n,p)&quot;</span>,</a>
<a class="sourceLine" id="cb282-9" title="9">                     <span class="dt">min =</span> <span class="fl">0.01</span>, <span class="dt">max =</span> <span class="fl">0.99</span>, <span class="dt">value =</span> <span class="fl">0.5</span>, <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb282-10" title="10">         ),</a>
<a class="sourceLine" id="cb282-11" title="11">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb282-12" title="12">         <span class="kw">sliderInput</span>(<span class="st">&quot;qq&quot;</span>, <span class="dt">label=</span><span class="st">&quot; Cuantil q&quot;</span>, <span class="dt">value=</span><span class="fl">0.75</span>, <span class="dt">min =</span> <span class="fl">0.01</span>, <span class="dt">max =</span> <span class="fl">0.99</span>, </a>
<a class="sourceLine" id="cb282-13" title="13">                     <span class="dt">step =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb282-14" title="14">         ),</a>
<a class="sourceLine" id="cb282-15" title="15">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb282-16" title="16">         <span class="kw">sliderInput</span>(<span class="st">&quot;lq&quot;</span>, <span class="dt">label=</span><span class="st">&quot;Par. lambda Po(lambda)&quot;</span>, <span class="dt">value=</span><span class="dv">5</span>, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb282-17" title="17">                     <span class="dt">step =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb282-18" title="18">         )</a>
<a class="sourceLine" id="cb282-19" title="19">  )</a>
<a class="sourceLine" id="cb282-20" title="20">)</a>
<a class="sourceLine" id="cb282-21" title="21"></a>
<a class="sourceLine" id="cb282-22" title="22">  </a>
<a class="sourceLine" id="cb282-23" title="23"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb282-24" title="24">  n=input<span class="op">$</span>nq</a>
<a class="sourceLine" id="cb282-25" title="25">  p=input<span class="op">$</span>pq</a>
<a class="sourceLine" id="cb282-26" title="26">  q=input<span class="op">$</span>qq</a>
<a class="sourceLine" id="cb282-27" title="27">  lambda=input<span class="op">$</span>lq</a>
<a class="sourceLine" id="cb282-28" title="28">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb282-29" title="29">  <span class="co">#n=10;p=0.5;q=0.75;lambda=5</span></a>
<a class="sourceLine" id="cb282-30" title="30">  <span class="co">#xx=c(seq(min(a,x),min(b,x),by=0.001))</span></a>
<a class="sourceLine" id="cb282-31" title="31">  probsB=<span class="kw">pbinom</span>(<span class="dv">0</span><span class="op">:</span>n,n,p)</a>
<a class="sourceLine" id="cb282-32" title="32">  <span class="kw">curve</span>(<span class="kw">pbinom</span>(x,n,p),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span><span class="fl">-0.25</span>,n<span class="fl">+0.25</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(probsB<span class="fl">+0.05</span>,<span class="fl">0.1</span>)),</a>
<a class="sourceLine" id="cb282-33" title="33">        <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función distribución\n B(n=&quot;</span>,n,<span class="st">&quot;, p=&quot;</span>,p,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb282-34" title="34">        <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;dbinom(x,&quot;</span>,n,<span class="st">&quot;, &quot;</span>,p,<span class="st">&quot;)&quot;</span>),<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb282-35" title="35">  <span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="kw">qbinom</span>(q,n,p),<span class="dt">y0 =</span> <span class="dv">0</span>,<span class="dt">x1 =</span> <span class="kw">qbinom</span>(q,n,p),<span class="dt">y1 =</span> q,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb282-36" title="36">  <span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="kw">qbinom</span>(q,n,p),<span class="dt">y0 =</span> q,<span class="dt">x1 =</span> <span class="fl">-0.25</span>,<span class="dt">y1 =</span> q,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb282-37" title="37">  ytick=<span class="kw">c</span>(<span class="fl">0.0</span>,q,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb282-38" title="38">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span>ytick, <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb282-39" title="39">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">qbinom</span>(q,n,p), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb282-40" title="40">  <span class="kw">curve</span>(<span class="kw">ppois</span>(x,lambda),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span><span class="fl">-0.25</span>,<span class="fl">2.5</span><span class="op">*</span>lambda),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="fl">+0.1</span>),</a>
<a class="sourceLine" id="cb282-41" title="41">        <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función distribución </span><span class="ch">\n</span><span class="st"> Po(lambda=&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb282-42" title="42">        <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;dpois(x, lambda&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb282-43" title="43">  <span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="kw">qpois</span>(q,lambda),<span class="dt">y0 =</span> <span class="dv">0</span>,<span class="dt">x1 =</span> <span class="kw">qpois</span>(q,lambda),<span class="dt">y1 =</span> q,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb282-44" title="44">  <span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="kw">qpois</span>(q,lambda),<span class="dt">y0 =</span> q,<span class="dt">x1 =</span> <span class="fl">-0.25</span>,<span class="dt">y1 =</span> q,<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb282-45" title="45">  ytick=<span class="kw">c</span>(<span class="fl">0.0</span>,q,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb282-46" title="46">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span>ytick, <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb282-47" title="47">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">qpois</span>(q,lambda), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb282-48" title="48">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb282-49" title="49">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_cuantiles1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
</div>
<div id="distribuciones-continuas" class="section level2">
<h2><span class="header-section-number">3.3</span> Distribuciones continuas</h2>
<div id="distribución-uniforme" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Distribución uniforme</h3>
<p>Una v.a. continua <span class="math inline">\(X\)</span> tiene una distribución uniforme sobre el intervalo real <span class="math inline">\((a,b)\)</span> ,con <span class="math inline">\(a&lt;b\)</span>, si su función de densidad es</p>
<p><span class="math display">\[
f_X(x)=\left\{\begin{array}{ll}
\frac1{b-a}, &amp; \mbox{si } a&lt;x&lt;b,\\ 0,  &amp; \mbox{en cualquier otro caso.}
\end{array}
\right. 
\]</span></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Comprobar que el área comprendida entre <span class="math inline">\(f_X\)</span> y la horizontal
vale 1.</p>
<div class="exercise-sol">
<p>El área pedida vale:
<span class="math display">\[
\int_{-\infty}^{+\infty} f_x(x)\cdot dx=\int_{a}^{b} \frac{1}{b-a} \cdot dx=\left.\frac{x}{b-a}\right]_{x=a}^{x=b}=\frac{b}{b-a}-\frac{a}{b-a}=
\frac{b-a}{b-a}=1.
\]</span></p>
</div>
</div>
<p>Su función de distribución es:
<span class="math display">\[
F_X(x)=\left\{\begin{array}{ll} 0,  &amp; \mbox{si } x\leq a,\\
\frac{x-a}{b-a}, &amp; \mbox{si } a&lt;x&lt;b,\\ 1,  &amp; \mbox{si } b\leq x.
\end{array}
\right. 
\]</span>
Efectivamente:</p>
<ul>
<li>Si <span class="math inline">\(x\leq a\)</span>, entonces
<span class="math display">\[F_X(x)=\int_{-\infty}^{x} f(t)\cdot dt= \int_{-\infty}^{x} 0\cdot dt.\]</span></li>
<li>Si <span class="math inline">\(a&lt;x&lt;b\)</span> entonces ,</li>
</ul>
<p><span class="math display">\[
\begin{array}{rl}
F_X(x)&amp;=\displaystyle\int_{-\infty}^{x} f(t)\cdot dt= \int_{-\infty}^{a} 0\cdot dt+\int_{a}^{x} \frac1{b-a} \cdot dt\\
&amp;= \displaystyle 0 +\left.\frac{t}{b-a}\right]_{t=a}^{t=x}= \frac{x}{b-a}-\frac{a}{b-a}=\frac{x-a}{b-a}.
\end{array}
\]</span>
* Por último si <span class="math inline">\(x\geq b\)</span> entonces,</p>
<p><span class="math display">\[
\begin{array}{rl}
F_X(x)&amp;=\displaystyle\int_{-\infty}^{x} f(t) dt=\int_{a}^{b} \frac{1}{b-a} dt=
  \left.  \frac{t}{b-a} \right]_{t=a}^{t=b}
\\&amp;=\displaystyle \frac{b}{b-a}-\frac{a}{b-a}=\frac{b-a}{b-a}=1.
\end{array}
\]</span></p>
<p>Denotaremos a la v.a. <span class="math inline">\(X\)</span> uniforme en el intervalo <span class="math inline">\((a,b)\)</span> por <span class="math inline">\(U(a,b)\)</span>.</p>
<p><strong>Esperanza y varianza para una v.a. <span class="math inline">\(X\)</span> <span class="math inline">\(U(a,b)\)</span></strong></p>
<p>Calculemos la esperanza de <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
\begin{array}{rl}
E(X)&amp;=\displaystyle\int_{-\infty}^{+\infty} x\cdot f_X(x) dx =\int_{a}^{b} x \cdot \frac{1}{b-a} dx =
\left.\frac{x^2}{2\cdot (b-a)}\right]_{x=a}^{x=b}\\
&amp;=\displaystyle \frac{b^2}{2\cdot (b-a)}-\frac{a^2}{2\cdot (b-a)}=
\frac{b^2-a^2}{2\cdot (b-a)}=\frac{(b+a)\cdot (b-a)}{2\cdot (b-a)}=
\frac{b+a}{2}.
\end{array}
\]</span></p>
<p>De cara a calcular su varianza, calculemos primero la esperanza de <span class="math inline">\(X^2\)</span>:</p>
<p><span class="math display">\[
\begin{array}{rl}
E(X^2)&amp;=\displaystyle\int_{-\infty}^{+\infty} x^2 f_X(x) dx=\int_{a}^{b} x^2 \frac1{b-a}
dx =\left.\frac{x^3}{3\cdot (b-a)}\right]_{x=a}^{x=b} \\
&amp;=\displaystyle\frac{b^3-a^3}{3\cdot (b-a)}=\frac{b^2+ab+a^2}{3}.
\end{array}
\]</span></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<ul>
<li><p>Demostrad que la igualdad <span class="math inline">\(b^3-a^3=(b-a)\cdot (b^2+ab+a^2)\)</span> es cierta.</p></li>
<li><p>Utilizadla para el cálculo final del valor de <span class="math inline">\(E(X^2)\)</span>.</p></li>
</ul>
</div>
<p>Calculemos <span class="math inline">\(Var(X)\)</span>.
<span class="math display">\[
\begin{array}{rl}
Var(X)&amp;=\displaystyle E(X^2)-(E(X))^2=\frac{b^2+ab+a^2}3-\left(\frac{b+a}2\right)^2\\&amp;=\displaystyle
\frac{b^2+ab+a^2}{3}-\frac{b^2+2ab+a^2}{4}\\
&amp;=\displaystyle
\frac{4\cdot (b^2+ab+a^2)-3\cdot (b^2+2ab+a^2)}{4\cdot 3}
\\
&amp;=\displaystyle
\frac{b^2-2ab+a^2}{12}=
\frac{(b-a)^2}{12}.
\end{array}
\]</span></p>
<p><strong>Gráficas <span class="math inline">\(U(0,1)\)</span></strong></p>
<p>El código en <code>R</code> para dibujar la función de densidad y la función de distribución de una distribución <span class="math inline">\(U(0,1)\)</span> es el siguiente:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb283-2" title="2">a=<span class="dv">0</span>;b=<span class="dv">1</span></a>
<a class="sourceLine" id="cb283-3" title="3"><span class="kw">curve</span>(<span class="kw">dunif</span>(x,a,b),<span class="dt">xlim=</span><span class="kw">c</span>(a<span class="fl">-0.25</span>,b<span class="fl">+0.25</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="dv">1</span><span class="op">/</span>(b<span class="op">-</span>a)<span class="op">+</span><span class="fl">0.05</span>,<span class="fl">0.1</span>)),</a>
<a class="sourceLine" id="cb283-4" title="4">      <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función densidad  U(&quot;</span>,a,<span class="st">&quot;,&quot;</span>,b,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb283-5" title="5">      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;dunif(x,&quot;</span>,a,<span class="st">&quot;, &quot;</span>,b,<span class="st">&quot;)&quot;</span>)</a>
<a class="sourceLine" id="cb283-6" title="6">      )</a>
<a class="sourceLine" id="cb283-7" title="7"><span class="kw">curve</span>(<span class="kw">punif</span>(x,a,b),<span class="dt">xlim=</span><span class="kw">c</span>(a<span class="dv">-1</span>,b<span class="op">+</span><span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),</a>
<a class="sourceLine" id="cb283-8" title="8">      <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de distribución U(&quot;</span>,a,<span class="st">&quot;,&quot;</span>,b,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb283-9" title="9">      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;punif(x,&quot;</span>,a,<span class="st">&quot;, &quot;</span>,b,<span class="st">&quot;)&quot;</span>,<span class="dt">cex.axis=</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb283-10" title="10">      )</a>
<a class="sourceLine" id="cb283-11" title="11"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/grafica_unif10_vista-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Gráficas interactivas <span class="math inline">\(U(a,b)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb284-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb284-3" title="3">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb284-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;a1&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Parámetro a&quot;</span>,</a>
<a class="sourceLine" id="cb284-5" title="5">              <span class="dt">min =</span> <span class="dv">-5</span>, <span class="dt">max =</span> <span class="dv">9</span>, <span class="dt">value =</span><span class="dv">0</span> , <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb284-6" title="6">         ),</a>
<a class="sourceLine" id="cb284-7" title="7">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb284-8" title="8">          <span class="kw">sliderInput</span>(<span class="st">&quot;b1&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Parámetro b&quot;</span>,</a>
<a class="sourceLine" id="cb284-9" title="9">                     <span class="dt">min =</span> <span class="dv">10</span>, <span class="dt">max =</span> <span class="dv">15</span>, <span class="dt">value =</span> <span class="dv">5</span>, <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb284-10" title="10">         ),</a>
<a class="sourceLine" id="cb284-11" title="11">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb284-12" title="12">         <span class="kw">sliderInput</span>(<span class="st">&quot;x1&quot;</span>, <span class="dt">label=</span><span class="st">&quot;x&quot;</span>, <span class="dt">value=</span><span class="dv">9</span>, <span class="dt">min =</span> <span class="dv">-5</span>, <span class="dt">max =</span> <span class="dv">15</span>, <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb284-13" title="13">         )</a>
<a class="sourceLine" id="cb284-14" title="14">  </a>
<a class="sourceLine" id="cb284-15" title="15">)</a>
<a class="sourceLine" id="cb284-16" title="16">)</a>
<a class="sourceLine" id="cb284-17" title="17"></a>
<a class="sourceLine" id="cb284-18" title="18"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb284-19" title="19">  a=input<span class="op">$</span>a1</a>
<a class="sourceLine" id="cb284-20" title="20">  b=input<span class="op">$</span>b1</a>
<a class="sourceLine" id="cb284-21" title="21">  x=input<span class="op">$</span>x1</a>
<a class="sourceLine" id="cb284-22" title="22">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb284-23" title="23">  <span class="co">#a=0;b=1;x=0.25</span></a>
<a class="sourceLine" id="cb284-24" title="24">  xx=<span class="kw">c</span>(<span class="kw">seq</span>(<span class="kw">min</span>(a,x),<span class="kw">min</span>(b,x),<span class="dt">by=</span><span class="fl">0.001</span>))</a>
<a class="sourceLine" id="cb284-25" title="25">  <span class="kw">curve</span>(<span class="kw">dunif</span>(x,a,b),<span class="dt">xlim=</span><span class="kw">c</span>(a<span class="fl">-0.25</span>,b<span class="fl">+0.25</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(<span class="dv">1</span><span class="op">/</span>(b<span class="op">-</span>a)<span class="op">+</span><span class="fl">0.05</span>,<span class="fl">0.1</span>)),</a>
<a class="sourceLine" id="cb284-26" title="26">        <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función densidad U(&quot;</span>,a,<span class="st">&quot;,&quot;</span>,b,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb284-27" title="27">  <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;dunif(x,&quot;</span>,a,<span class="st">&quot;, &quot;</span>,b,<span class="st">&quot;)&quot;</span>),<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb284-28" title="28">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">c</span>(a,x,b), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb284-29" title="29">  <span class="kw">polygon</span>(<span class="dt">x=</span><span class="kw">c</span>(a,xx,<span class="kw">min</span>(x,b)),<span class="dt">y=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">dunif</span>(xx,a,b),<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb284-30" title="30">          <span class="dt">density=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span>)</a>
<a class="sourceLine" id="cb284-31" title="31">  <span class="kw">curve</span>(<span class="kw">punif</span>(x,a,b),<span class="dt">xlim=</span><span class="kw">c</span>(a<span class="dv">-1</span>,b<span class="op">+</span><span class="dv">1</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb284-32" title="32">        <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de distribución U(&quot;</span>,a,<span class="st">&quot;,&quot;</span>,b,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb284-33" title="33">  <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;punif(x,&quot;</span>,a,<span class="st">&quot;, &quot;</span>,b,<span class="st">&quot;)&quot;</span>),<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb284-34" title="34">  <span class="kw">segments</span>(<span class="dt">x0=</span>x,<span class="dt">y0=</span><span class="dv">0</span>,<span class="dt">x1=</span>x,<span class="dt">y1=</span><span class="kw">punif</span>(x,a,b),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb284-35" title="35">  <span class="kw">segments</span>(<span class="dt">x0=</span>a<span class="fl">-1.01</span>,<span class="dt">y0=</span><span class="kw">punif</span>(x,a,b),<span class="dt">x1=</span>x,<span class="dt">y1=</span><span class="kw">punif</span>(x,a,b),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb284-36" title="36">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">round</span>(<span class="kw">punif</span>(x,a,b),<span class="dv">1</span>),<span class="dv">2</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb284-37" title="37">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">c</span>(a,x,b), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb284-38" title="38">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb284-39" title="39">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_uniforme1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Transformación lineal de la v.a. uniforme</strong></p>
<p>Si <span class="math inline">\(X\)</span> sigue una distribución <span class="math inline">\(U(a,b)\)</span> entonces <span class="math inline">\(Z=\frac{X-a}{b-a}\)</span> sigue una distribución <span class="math inline">\(U(0,1)\)</span>.</p>
<div class="prop">
<p><strong>Propiedad: Transformación lineal de la v.a. uniforme</strong></p>
</div>
<p>Sea <span class="math inline">\(X\)</span> una v.a <span class="math inline">\(U(a,b)\)</span>.</p>
<p>Si <span class="math inline">\(scale\not=0\)</span> y <span class="math inline">\(loc\)</span> son dos constantes reales entonces</p>
<ul>
<li>si <span class="math inline">\(scale&gt;0\)</span>, <span class="math inline">\(T=scale\cdot X+loc\)</span> sigue una ley <span class="math inline">\(U(scale\cdot a +loc,scale\cdot b +loc)\)</span><br />
</li>
<li>si <span class="math inline">\(scale&lt;0\)</span>, <span class="math inline">\(T=scale\cdot X+loc\)</span> sigue una ley <span class="math inline">\(U(scale\cdot b +loc,scale\cdot a +loc)\)</span></li>
</ul>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Supongamos que <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(U(a,b)\)</span>, que <span class="math inline">\(scale&gt;0\)</span> y que <span class="math inline">\(T=scale\cdot X+loc\)</span>. Dejamos el caso <span class="math inline">\(scale&lt;0\)</span> como ejercicio.</p>
<p>La función de distribución de <span class="math inline">\(X\)</span> es:
<span class="math display">\[
F_X(x)=P(X\leq x)=\left\{\begin{array}{ll} 0, &amp; \mbox{ si } x\leq a,\\\frac{x-a}{b-a}, &amp; \mbox{ si } a\leq x\leq b, \\1, &amp; \mbox{ si } b\leq x.\end{array}\right.
\]</span></p>
<p>Si <span class="math inline">\(T\)</span> vale <span class="math inline">\(T=scale\cdot X+loc\)</span>, su función de distribución será:
<span class="math display">\[
\begin{array}{rl}
F_T(t)&amp;=P(T\leq t)= P(scale\cdot X+ loc\leq t)= P\left(X\leq \frac{t-loc}{scale}\right)=F_X\left(\frac{t-loc}{scale}\right)\\
&amp;=
\left\{\begin{array}{ll} 0, &amp; \mbox{ si } \frac{t-loc}{scale}\leq a\\\frac{\frac{t-loc}{scale}-a}{b-a}, &amp; \mbox{ si } a\leq \frac{t-loc}{scale}\leq b,\\1, &amp; \mbox{ si } b\leq \frac{t-loc}{scale},\end{array}\right. \\ &amp; =
\left\{\begin{array}{ll} 0, &amp; \mbox{ si }  t\leq scale\cdot a +loc, \\
\frac{t-(scale\cdot a+loc)}{scale\cdot (b-a)}, &amp; \mbox{ si } scale\cdot a+loc \leq t\leq scale\cdot b+loc, \\
1, &amp; \mbox{ si } scale\cdot b+loc\leq t, \end{array}\right.\\
&amp; = 
\left\{\begin{array}{ll} 0, &amp; \mbox{ si }  t\leq scale\cdot a +loc, \\
\frac{t-(scale\cdot a+loc)}{scale\cdot b+loc-(scale\cdot a+loc)}, &amp; \mbox{ si } scale\cdot a+loc \leq t\leq scale\cdot b+loc, \\
1, &amp; \mbox{ si } scale\cdot b+loc\leq t,\end{array}\right.
\end{array}
\]</span>
función que corresponde a la función de distribución de una v.a. <span class="math inline">\(U(scale\cdot a+loc,scale\cdot b+loc)\)</span>, como queríamos demostrar.</p>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una variable <span class="math inline">\(U(0,1)\)</span> y sea <span class="math inline">\(T=scale\cdot X+loc\)</span>:</p>
<ul>
<li><p>Si <span class="math inline">\(T\)</span> es <span class="math inline">\(U(-5,5)\)</span> ¿qué valores toman <span class="math inline">\(scale\)</span> y <span class="math inline">\(loc\)</span>?</p></li>
<li><p>Si <span class="math inline">\(loc=-10\)</span> y <span class="math inline">\(scale=10\)</span> ¿qué distribución de probabilidad sigue <span class="math inline">\(T\)</span>?</p></li>
<li><p>Si <span class="math inline">\(loc=0\)</span> y <span class="math inline">\(scale=-1\)</span> ¿qué distribución probabilidad sigue <span class="math inline">\(T\)</span>?</p></li>
</ul>
</div>
<p><strong>Resumen v.a con distribución uniforme, <span class="math inline">\(U(a,b)\)</span></strong></p>
<table>
<colgroup>
<col width="45%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Distribución uniforme</th>
<th align="left"><span class="math inline">\(U(a,b)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">Dominio</td>
<td align="left"><span class="math inline">\(D_X=(a,b)\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(f_{X}(x)\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll}\frac1{b-a}, &amp; \mbox{si } a&lt;x&lt;b,\\ 0, &amp; \mbox{en cualquier otro caso.}\end{array} \right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} 0, &amp; \mbox{ si } x\leq a\\\frac{x-a}{b-a}, &amp; \mbox{ si } a\leq x\leq b,\\1, &amp; \mbox{ si } b\leq x.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\)</span></td>
<td align="left"><span class="math inline">\(\frac{a+b}2\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(Var(X)=\)</span></td>
<td align="left"><span class="math inline">\(\frac{(b-a)^2}{12}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(v.a.\)</span> <span class="math inline">\(U(a,b)\)</span>. Las funciones <code>dunif(x,a,b)</code> y <code>punif(x,a,b)</code> calculan la función de densidad y de distribución de <span class="math inline">\(X\)</span> en el valor <span class="math inline">\(X\)</span>. Por ejemplo, para <span class="math inline">\(a=-1\)</span>, <span class="math inline">\(b=1\)</span> y <span class="math inline">\(x=0.5\)</span>, los valores <span class="math inline">\(f_X(x)\)</span> y <span class="math inline">\(F_X(x)\)</span> valen:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1"><span class="kw">dunif</span>(<span class="dt">x=</span><span class="fl">0.5</span>, <span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1"><span class="kw">punif</span>(<span class="dt">q=</span><span class="fl">0.5</span>,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<p>La función <code>runif(n,a,b)</code> calcula un muestra de observaciones de tamaño <span class="math inline">\(n\)</span> que sigan la distribución <span class="math inline">\(U(a,b)\)</span>:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1"><span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">5</span>,<span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">max=</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] -0.5502232 -0.4271506 -0.0515360  0.8052209  0.8983523</code></pre>
<p>Por defecto, el valor de los parámetros <code>a</code> y <code>b</code> son 0 y 1, respectivamente:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1"><span class="kw">dunif</span>(<span class="dt">x=</span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1"><span class="kw">punif</span>(<span class="dt">q=</span><span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1"><span class="kw">runif</span>(<span class="dt">n=</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## [1] 0.382302539 0.009313886 0.351767001 0.294007361 0.071581515</code></pre>
<p><strong>Cálculos con python</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(v.a.\)</span> <span class="math inline">\(U(-1,1)\)</span>. Tomando como “base” la v.a. <span class="math inline">\(U(0,1)\)</span>, los parámetros <span class="math inline">\(loc\)</span> y <span class="math inline">\(scale\)</span> valen: <span class="math inline">\(loc=-1\)</span> y <span class="math inline">\(scale=2,\)</span> ya que como hemos visto <span class="math inline">\(X=2*U(0,1)-1=U(-1,1)\)</span>.</p>
<p>En python, hay que usar dichos parámetros para calcular la función de densidad y de distribución:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb297-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> uniform</a>
<a class="sourceLine" id="cb297-2" title="2">uniform.pdf(<span class="fl">0.5</span>,loc<span class="op">=-</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 0.5</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb299-1" title="1">uniform.ppf(<span class="fl">0.5</span>,loc<span class="op">=-</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 0.0</code></pre>
<p>Para generar una muestra de valores aleatorios, hay que usar la función <code>uniform.rvs</code>:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb301-1" title="1">uniform.rvs(size<span class="op">=</span><span class="dv">30</span>,loc<span class="op">=-</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## array([ 0.72964674, -0.73642421,  0.11560767,  0.49526477, -0.64999492,
##         0.17252838,  0.7372323 ,  0.48443601, -0.4792597 , -0.88360289,
##         0.58161284, -0.73295832,  0.90978764, -0.61909106, -0.62946974,
##        -0.48730337, -0.2815912 ,  0.69204318,  0.67876797, -0.42146344,
##        -0.11588506, -0.00826262, -0.47279286, -0.91092917,  0.57309746,
##        -0.87249603,  0.15819998, -0.89290976, -0.19173785,  0.51779543])</code></pre>
<p>Los valores de los parámetros por defecto son <code>loc=0, scale=1</code>:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb303-1" title="1">uniform.pdf(<span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## 1.0</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb305-1" title="1">uniform.ppf(<span class="fl">0.5</span>)</a></code></pre></div>
<pre><code>## 0.5</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb307-1" title="1">uniform.rvs(size<span class="op">=</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## array([0.30517893, 0.37790412, 0.23849597, 0.43929062, 0.61125226])</code></pre>
</div>
<div id="distribución-exponencial" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Distribución exponencial</h3>
<p><strong>Distribución del tiempo entre dos eventos Poisson</strong></p>
<p>Supongamos que tenemos un proceso Poisson con parámetro <span class="math inline">\(\lambda\)</span> en una unidad de tiempo.</p>
<p>Dado un tiempo <span class="math inline">\(t\)</span>, definimos <span class="math inline">\(N_{t}\)</span> como el número de eventos en el intervalo de tiempo <span class="math inline">\((0,t]\)</span>. La distribución de <span class="math inline">\(N(t)\)</span> es una <span class="math inline">\(Po(\lambda\cdot t)\)</span>. Consideremos la v.a. <span class="math inline">\(T\)</span> como el tiempo transcurrido entre dos eventos Poisson consecutivos.</p>
<p>Sea <span class="math inline">\(t&gt;0\)</span>, entonces</p>
<p><span class="math display">\[
\begin{array}{rl}
P(T&gt;t)&amp;=P(\mbox{Cero eventos en el intervalo}(0,t])\\
&amp;=P(N_{t}=0)=
         \frac{(\lambda t)^0}{0!} e^{-\lambda
         t}=e^{-\lambda t}.
\end{array}
\]</span></p>
<p>Tomando complementarios, la función de distribución de <span class="math inline">\(T\)</span> será:
<span class="math display">\[
F_{T}(t)= P(T\leq t)=1-P(T&gt;t)=\left\{\begin{array}{ll} 0, &amp;\mbox{ si } t\leq 0,\\
  1-e^{-\lambda t},&amp; \mbox{ si } t&gt;0,\end{array}\right.
\]</span></p>
<p>Para hallar la función de densidad de <span class="math inline">\(T\)</span>, basta derivar la expresión anterior:</p>
<p><span class="math display">\[
f_{T}(t)=\left\{\begin{array}{ll}\lambda \cdot e^{-\lambda t}, &amp; \mbox{ si }  t&gt;0,\\
0, &amp; \mbox{ si } t\leq 0. \end{array}\right.
\]</span></p>
<p>Llamaremos a la variable <span class="math inline">\(T\)</span> exponencial de parámetro <span class="math inline">\(\lambda\)</span> y la denotaremos por <span class="math inline">\(Exp(\lambda)\)</span>.</p>
<p><strong>Propiedad de la falta de memoria</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. <span class="math inline">\(Exp(\lambda)\)</span>, entonces</p>
<p><span class="math display">\[P(X&gt;s+t\big|X&gt;s)=P(X&gt;t)\mbox{  para todo } s,t\in \mathbb{R}\]</span></p>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Si <span class="math inline">\(X\)</span> es una v.a. <span class="math inline">\(Exp(\lambda)\)</span> tenemos que <span class="math inline">\(P(X&gt;x)=1-P(X\leq x)=1-(1-e^{-\lambda\cdot x})=e^{-\lambda\cdot x}\)</span> para todo <span class="math inline">\(x&gt;0\)</span>.</p>
<p>Por tanto,
<span class="math display">\[
\begin{array}{rl}
P(X&gt;s+t\big|X&gt;s) &amp; =\frac{P(\{X&gt;s+t\}\cap \{X&gt;s\})}{P(X&gt;s)}=\frac{P(X&gt;s+t)}{P(X&gt;s)}=\frac{e^{-\lambda\cdot (s+t)}}{e^{-\lambda\cdot s}}=
\frac{e^{-\lambda\cdot s}\cdot e^{-\lambda\cdot t} }{e^{-\lambda\cdot s}}\\ &amp; =e^{-\lambda\cdot t}=P(X&gt;t).
\end{array}
\]</span></p>
</div>
<div class="example">
<p><strong>Ejemplo: el clásico problema del peluquero.</strong></p>
<p>Una pequeña peluquería es regentada por un único peluquero. El peluquero está esperando al próximo cliente mientras lee el periódico.</p>
<p>Supongamos que la v.a. <span class="math inline">\(N_T\)</span>, que representa el número de clientes que llegan en el intervalo <span class="math inline">\([0,t)\)</span>, es una <span class="math inline">\(Po(\lambda\cdot t)\)</span> entonces la variable <span class="math inline">\(T\)</span>, tiempo entre dos clientes consecutivos, sigue una ley <span class="math inline">\(Exp(\lambda)\)</span>.</p>
<p>Supongamos que <span class="math inline">\(t\)</span> se mide en horas y que <span class="math inline">\(\lambda=4\)</span> es el promedio de clientes por hora.</p>
<p>Se pide:</p>
<ol style="list-style-type: decimal">
<li>El tiempo esperado (en horas) y la varianza hasta el siguiente cliente.</li>
<li>¿Cuál es la probabilidad de que nuestro peluquero esté sin clientes (leyendo el periódico) más de 30 minutos (0.5 horas)?</li>
</ol>
<div class="example-sol">
<p>En este ejemplo la propiedad de la pérdida de memoria significa que
por ejemplo, si el peluquero lleva ya esperando más de <span class="math inline">\(s&gt;0.25\)</span> (un cuarto de hora), la probabilidad de que espere <span class="math inline">\(t=1/6\)</span> de hora más (10 minutos) no cambia sigue siendo <span class="math inline">\(P(T&gt;0.25+1/6|T&gt;0.25)=P(T&gt;1/6).\)</span></p>
<p><strong>Solución de 1. El tiempo esperado (en horas) y la varianza hasta el siguiente cliente.</strong></p>
<p>El tiempo esperado (en horas) hasta el siguiente cliente es</p>
<p><span class="math display">\[
E(X)=\frac{1}{\lambda}=\frac{1}{4}=0.25,
\]</span>
y la varianza es
<span class="math display">\[
Var(X)=\frac{1}{\lambda^2}=\frac{1}{4^2}=0.0625.
\]</span>
<strong>Solución de 2. ¿Cuál es la probabilidad de que nuestro peluquero esté sin clientes (leyendo el periódico) más de 30 minutos (0.5 horas)?</strong></p>
<p>La probabilidad pedida vale:
<span class="math display">\[
P(X&gt;0.5)=1-P(X\leq 0.5)=1-(1-e^{-4\cdot 0.5 })=e^{-2}=0.1353353.
\]</span></p>
<p>Usando <code>R</code>, la probabilidad anterior puede ser calculada de la forma siguiente:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1"><span class="kw">pexp</span>(<span class="fl">0.5</span>,<span class="dt">rate=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.7768698</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">pexp</span>(<span class="fl">0.5</span>,<span class="dt">rate=</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.2231302</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" title="1"><span class="kw">pexp</span>(<span class="fl">0.5</span>,<span class="dt">rate=</span><span class="dv">3</span>,<span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.2231302</code></pre>
</div>
</div>
<p><strong>Cálculos con R</strong></p>
<p>Las funciones de densidad y de distribución de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span> en un valor <code>x</code> se pueden obtener en <code>R</code> usando las funciones <code>dexp(x,lambda)</code> y <code>pexp(x,lambda)</code>, respectivamente. Para generar <code>n</code> valores aleatorios de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span>, hay que usar la función <code>rexp(n,lambda)</code>. Veamos un ejemplo de aplicación de las tres funciones anteriores:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1"><span class="kw">dexp</span>(<span class="fl">0.001</span>,<span class="dt">rate=</span><span class="dv">3</span>)<span class="co">### alerta no es una probabilidad, es una densidad y puede ser &gt;1</span></a></code></pre></div>
<pre><code>## [1] 2.991013</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" title="1"><span class="kw">pexp</span>(<span class="fl">0.5</span>,<span class="dt">rate=</span><span class="dv">3</span>) <span class="co">##P(X&lt;0.5)</span></a></code></pre></div>
<pre><code>## [1] 0.7768698</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" title="1"><span class="kw">rexp</span>(<span class="dv">10</span>,<span class="dv">3</span>)<span class="co">### diez tiempos de una exponencial</span></a></code></pre></div>
<pre><code>##  [1] 0.32072389 0.57998323 0.26019628 0.48896233 0.31041354 0.11871455
##  [7] 0.10798351 0.18699902 0.10023100 0.03619832</code></pre>
<p><strong>Cálculos con python</strong></p>
<p>Las funciones de densidad y de distribución de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span> en un valor <code>x</code> se pueden obtener en python usando las funciones <code>expon.pdf(x,scale=1/lambda)</code> y <code>expon.cdf(x,scale=1/lambda)</code>, respectivamente. Para generar <code>n</code> valores aleatorios de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span>, hay que usar la función <code>expon.rvs(scale=1/lambda,size=n)</code>. Veamos un ejemplo de aplicación de las tres funciones anteriores:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb321-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> expon</a>
<a class="sourceLine" id="cb321-2" title="2">expon.pdf(<span class="fl">0.0001</span>,scale<span class="op">=</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## 2.9991001349865014</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb323-1" title="1">expon.cdf(<span class="fl">0.5</span>,scale<span class="op">=</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">3</span>) </a></code></pre></div>
<pre><code>## 0.7768698398515702</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb325-1" title="1">expon.rvs(scale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## array([0.11736128, 0.44701035, 0.27764569, 0.27184166, 0.38850863,
##        0.24264556, 0.30958057, 0.74803325, 1.31966995, 0.70032672])</code></pre>
<p><strong>Resumen v.a con distribución exponencial, <span class="math inline">\(Exp(\lambda)\)</span></strong></p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X\)</span></th>
<th align="left"><span class="math inline">\(Exp(\lambda)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\((0,+\infty)\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(f_{X}(x)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} \lambda e^{-\lambda x}, &amp; \mbox{ si } x&gt;0,\\ 0, &amp; \mbox{ si } x\leq 0. \end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left"><span class="math inline">\(\left\{\begin{array}{ll} 0, &amp;\mbox{si } x\leq 0,\\ 1-e^{-\lambda x},&amp; \mbox{si } x&gt;0.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\frac{1}{\lambda}\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=\frac{1}{\lambda^2}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Gráficas de las funciones de densidad y de distribución de la variable aleatoria <span class="math inline">\(Exp(\lambda=10)\)</span></strong></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1">lambda=<span class="dv">10</span></a>
<a class="sourceLine" id="cb327-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb327-3" title="3"><span class="kw">curve</span>(<span class="kw">dexp</span>(x,<span class="dt">rate=</span>lambda),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.05</span>,<span class="kw">round</span>(<span class="kw">qexp</span>(<span class="fl">0.99</span>,<span class="dt">rate=</span>lambda,<span class="dv">2</span>),<span class="dv">2</span>)<span class="op">+</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb327-4" title="4">      <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">dexp</span>(<span class="dv">0</span>,lambda)<span class="op">+</span><span class="fl">0.1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb327-5" title="5">      <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función densidad Exp(&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb327-6" title="6">      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;dexp(x,rate=&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb327-7" title="7"><span class="kw">curve</span>(<span class="kw">pexp</span>(x,<span class="dt">rate=</span>lambda),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.05</span>,<span class="kw">qexp</span>(<span class="fl">0.999</span>,<span class="dv">10</span>)),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb327-8" title="8">      <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de distribución Exp(&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb327-9" title="9">      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;pexp(x,rate=&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb327-10" title="10"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-93-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Consultad en el manual de python <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.expon.html">scipy.stats</a>.</p>
<p>Dibujad la función de densidad y de distribución de una <span class="math inline">\(Exp(\lambda=10).\)</span></p>
</div>
<p><strong>Gráficas interactivas de una variable <span class="math inline">\(Exp(\lambda)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb328-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb328-3" title="3">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb328-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;le&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;lambda&quot;</span>,</a>
<a class="sourceLine" id="cb328-5" title="5">              <span class="dt">min =</span> <span class="fl">0.1</span>, <span class="dt">max =</span> <span class="dv">3</span>, <span class="dt">value =</span><span class="dv">1</span> , <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb328-6" title="6">         ),</a>
<a class="sourceLine" id="cb328-7" title="7">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb328-8" title="8">          <span class="kw">sliderInput</span>(<span class="st">&quot;xe&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;X=x&quot;</span>,</a>
<a class="sourceLine" id="cb328-9" title="9">                     <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">5</span>, <span class="dt">value =</span> <span class="dv">5</span>, <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb328-10" title="10">         ),</a>
<a class="sourceLine" id="cb328-11" title="11">  <span class="kw">column</span>(<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb328-12" title="12">          <span class="kw">sliderInput</span>(<span class="st">&quot;pe&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Cuantil p&quot;</span>,</a>
<a class="sourceLine" id="cb328-13" title="13">                     <span class="dt">min =</span> <span class="fl">0.01</span>, <span class="dt">max =</span> <span class="dv">1</span>, <span class="dt">value =</span> <span class="fl">0.75</span>, <span class="dt">step =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb328-14" title="14">         )</a>
<a class="sourceLine" id="cb328-15" title="15">)</a>
<a class="sourceLine" id="cb328-16" title="16">)</a>
<a class="sourceLine" id="cb328-17" title="17"></a>
<a class="sourceLine" id="cb328-18" title="18"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb328-19" title="19">  lambda=input<span class="op">$</span>le</a>
<a class="sourceLine" id="cb328-20" title="20">  p=input<span class="op">$</span>pe</a>
<a class="sourceLine" id="cb328-21" title="21">  x=input<span class="op">$</span>xe</a>
<a class="sourceLine" id="cb328-22" title="22">  <span class="co">#lambda=10;p=0.75;x=0.4</span></a>
<a class="sourceLine" id="cb328-23" title="23">  xx=<span class="kw">seq</span>(<span class="dv">0</span>,x,<span class="dt">by=</span><span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb328-24" title="24">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb328-25" title="25">  <span class="kw">curve</span>(<span class="kw">dexp</span>(x,<span class="dt">rate=</span>lambda),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.05</span>,<span class="kw">round</span>(<span class="kw">qexp</span>(<span class="fl">0.999</span>,<span class="dt">rate=</span>lambda),<span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb328-26" title="26">        <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">dexp</span>(<span class="dv">0</span>,lambda)<span class="op">+</span><span class="fl">0.1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb328-27" title="27">        <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función densidad Exp(&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb328-28" title="28">  <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;dexp(x,&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb328-29" title="29">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">0</span>,x,<span class="kw">round</span>(<span class="kw">qexp</span>(<span class="fl">0.999</span>,<span class="dt">rate=</span>lambda),<span class="dv">2</span>)),<span class="dt">cex.axis=</span><span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb328-30" title="30">  <span class="kw">polygon</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,xx,<span class="kw">max</span>(x,xx)),<span class="dt">y=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">dexp</span>(xx, <span class="dt">rate=</span>lambda),<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb328-31" title="31">          <span class="dt">density=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span>)</a>
<a class="sourceLine" id="cb328-32" title="32">  <span class="kw">curve</span>(<span class="kw">pexp</span>(x,<span class="dt">rate=</span>lambda),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">qexp</span>(<span class="fl">0.999</span>,<span class="dt">rate=</span>lambda)<span class="op">+</span><span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb328-33" title="33">        <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb328-34" title="34">        <span class="dt">main=</span><span class="kw">paste0</span>(<span class="st">&quot;Función de distribución Exp(&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb328-35" title="35">        <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&quot;pexp(x,&quot;</span>,lambda,<span class="st">&quot;)&quot;</span>),<span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb328-36" title="36">  <span class="kw">segments</span>(<span class="dt">x0=</span><span class="kw">qexp</span>(p,lambda),<span class="dt">x1=</span><span class="kw">qexp</span>(p,lambda),<span class="dt">y0=</span><span class="dv">0</span>,<span class="dt">y1=</span>p,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb328-37" title="37">  <span class="kw">segments</span>(<span class="dt">x0=</span><span class="dv">0</span><span class="fl">-0.05</span>,<span class="dt">y0=</span>p,<span class="dt">x1=</span><span class="kw">qexp</span>(p,lambda),<span class="dt">y1=</span>p,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb328-38" title="38">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb328-39" title="39">  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">round</span>(<span class="kw">qexp</span>(<span class="fl">0.999</span>,<span class="dt">rate=</span>lambda),<span class="dv">2</span>),<span class="dt">by=</span><span class="fl">0.1</span>), <span class="dt">labels =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb328-40" title="40">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb328-41" title="41">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_exponencial1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="exercise">
<p><strong>Ejercicio: las bombillas que no envejecen.</strong></p>
<p>Supongamos que compramos una bombilla led que promete un <strong>valor esperado</strong> de duración de 10000 (1.14 años) horas de funcionamiento continuo. Además, nos aseguran que la distribución de <span class="math inline">\(X\)</span>, el número de horas de funcionamiento continuo de una bombilla led, sigue una ley exponencial.</p>
<ul>
<li>Si <span class="math inline">\(X\)</span> es <span class="math inline">\(Exp(\lambda)\)</span> ¿cuál es el valor del parámetro <span class="math inline">\(\lambda\)</span>?.</li>
<li>¿Cuál es la probabilidad de que una bombilla led ilumine más de 2 años?</li>
<li>Supongamos que ya tengo una bombilla led funcionando 1 año ¿Cuál es la probabilidad de que dure dos años más?</li>
<li>¿Cuál es la varianza de la duración en horas de este tipo de bombillas?</li>
</ul>
</div>
</div>
<div id="distribución-normal-o-gaussiana" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Distribución normal o Gaussiana</h3>
<p>Una de las variables aleatorias continua más populares es la llamada distribución normal o <a href="https://es.wikipedia.org/wiki/Distribuci%C3%B3n_normal">Gaussiana</a>.</p>
<p><l class="def"> <strong>Distribución normal o de Gauss</strong></l>
Diremos que una v.a. <span class="math inline">\(X\)</span> sigue una ley normal de parámetros
<span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> y la denotaremos por <span class="math inline">\(N(\mu,\sigma)\)</span>
si tiene por función de densidad:</p>
<p><span class="math display">\[
f_{X}(x)=\frac1{\sqrt{2\cdot\pi\cdot\sigma^2}}
e^{-\frac{1}{2}\cdot\left(\frac{x-\mu}{\sigma}\right)^2},
\]</span>
para todo <span class="math inline">\(x\in \mathbb{R}.\)</span></p>
<p>La gráfica de esta función de densidad es conocida como <strong>campana de Gauss.</strong></p>
<p>La v.a. normal con <span class="math inline">\(\mu=0\)</span> y <span class="math inline">\(\sigma=1\)</span> recibe el nombre de
normal estándar y se suele denotar por la letra <span class="math inline">\(Z\)</span> normal <span class="math inline">\(N(0,1)\)</span>.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x),<span class="dt">main=</span><span class="st">&quot;Función de densidad de una normal estándar&quot;</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">3.9</span>,<span class="fl">3.9</span>))</a></code></pre></div>
<p><img src="curso-probabilidad-udemy_files/figure-html/normaldensidad1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><l class="prop"> <strong>Propiedades de la función de densidad de la distribución normal</strong></l></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. <span class="math inline">\(N(\mu,\sigma)\)</span> y sean <span class="math inline">\(f_{X}\)</span> su función de densidad y <span class="math inline">\(F_X(x)=\displaystyle\int_{-\infty}^x f_X(t)\, dt\)</span> su función de distribución. Entonces:</p>
<ol style="list-style-type: decimal">
<li>La función <span class="math inline">\(f_{X}\)</span> verifica todas las propiedades de las funciones de densidad: <span class="math inline">\(f_X(x)&gt;0\)</span>, para todo <span class="math inline">\(x\in\mathbb{R}\)</span> y <span class="math inline">\(\displaystyle\int_{-\infty}^\infty f_X(x)\,dx=1\)</span>.</li>
<li>La función <span class="math inline">\(f_X(x)\)</span> es simétrica respecto de la recta <span class="math inline">\(x=\mu\)</span>: <span class="math inline">\(f_{X}(\mu-x)=f_{X}(\mu+x)\)</span>, para todo <span class="math inline">\(x\in\mathbb{R}\)</span>.</li>
<li><span class="math inline">\(f_{X}\)</span> tiene un único máximo absoluto en <span class="math inline">\(x=\mu\)</span> que vale <span class="math inline">\(f_X(\mu)=\frac1{\sqrt{2\pi\sigma^2}}\)</span>.</li>
<li>Si <span class="math inline">\(F_{X}\)</span> es la función de distribución de <span class="math inline">\(X\)</span>, entonces <span class="math inline">\(F_{X}(\mu+x)=1-F_{X}(\mu-x)\)</span>, para todo <span class="math inline">\(x\in\mathbb{R}\)</span>.</li>
<li>En particular si <span class="math inline">\(Z\)</span> es una <span class="math inline">\(N(0,1)\)</span> entonces <span class="math inline">\(F_{Z}(-x)=1-F_{Z}(x)\)</span>, para todo <span class="math inline">\(x\in\mathbb{R}\)</span>.</li>
<li><span class="math inline">\(Z=\frac{X-\mu}{\sigma}\)</span> es una v.a. <span class="math inline">\(N(0,1)\)</span> y <span class="math inline">\(X=\sigma\cdot Z+\mu\)</span> es una <span class="math inline">\(N(\mu,\sigma)\)</span> donde <span class="math inline">\(Z\)</span> es la normal estándar.</li>
<li>La función <span class="math inline">\(f_X\)</span> es continua.</li>
<li><span class="math inline">\(\lim\limits_{x\to+\infty}f(x)=\lim\limits_{x\to-\infty}f(x)=0\)</span> es decir tiene asíntota horizontal a derecha e izquierda.</li>
<li><span class="math inline">\(f\)</span> es estrictamente creciente si <span class="math inline">\(x&lt;\mu\)</span> y decreciente si <span class="math inline">\(x&gt;\mu\)</span>.</li>
<li>Tiene dos puntos de inflexión en <span class="math inline">\(x=\mu+\sigma\)</span> y en <span class="math inline">\(x=\mu-\sigma\)</span>.</li>
</ol>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-94-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><img src="curso-probabilidad-udemy_files/figure-html/unnamed-chunk-95-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Función de distribución de la N(0,1)</strong></p>
<p>Su función de distribución es, como sabemos:</p>
<p><span class="math display">\[
F(x)=\displaystyle\int_{-\infty}^{x} {1\over{\sqrt{2\cdot \pi\cdot\sigma^2}}}
e^{-{1\over 2}{\left({t-\mu}\over{\sigma}\right)}^2} dt.
\]</span></p>
<p>La función <span class="math inline">\(F(x)\)</span> no tiene ninguna expresión algebraica “decente”. Es por esta razón, y por comodidad, que esta función está tabulada o hay que calcularla usando un software estadístico.</p>
<p><strong>Resumen v.a con distribución normal, <span class="math inline">\(N(\mu,\sigma)\)</span></strong></p>
<table>
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(X\)</span></th>
<th align="left"><span class="math inline">\(N(\mu,\sigma)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(D_X=\)</span></td>
<td align="left"><span class="math inline">\(\mathbb{R}=(-\infty,+\infty)\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(f_{X}(x)\)</span></td>
<td align="left"><span class="math inline">\(=\frac{1}{\sqrt{2\pi\cdot\sigma^2}}\cdot e^{\frac{-(x-\mu)^2}{2\cdot \sigma^2}}\mbox{ para todo }x\in \mathbb{R}.\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td align="left">Utilizad la función de <code>R</code> <code>pnorm(x,mean=mu,sd=sigma)</code> o la función correspondiente en python</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(E(X)=\mu.\)</span></td>
<td align="left"><span class="math inline">\(Var(X)=\sigma^2.\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Cálculos con R</strong></p>
<p>Las funciones que calculan la función de densidad y de distribución de una variable <span class="math inline">\(N(\mu,\sigma)\)</span> en un valor <code>x</code> son <code>dnorm(x,mean=mu,sd=sigma)</code> y <code>pnorm(x,mean=mu,sd=sigma)</code>, respectivamente. Por ejemplo, para una variable <span class="math inline">\(X\sim N(\mu=1,\sigma=2)\)</span>, la función de densidad <span class="math inline">\(f_X(2)\)</span> se puede calcular de la forma siguiente:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1"><span class="kw">dnorm</span>(<span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">1</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.1760327</code></pre>
<p>y la función de distribución <span class="math inline">\(F_X(2) = P(X\leq 2)\)</span> de la forma siguiente:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" title="1"><span class="kw">pnorm</span>(<span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">1</span>,<span class="dt">sd=</span><span class="dv">2</span>) </a></code></pre></div>
<pre><code>## [1] 0.6914625</code></pre>
<p>Si queremos calcular el cuantil <span class="math inline">\(x_{q}\)</span> de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span> que, recordemos es el valor que cumple que <span class="math inline">\(P(X\leq x_{q})=q\)</span>, tenemos que usar la función <code>qnorm(q,mean=mu,sd=sigma)</code>:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" title="1"><span class="kw">qnorm</span>(<span class="fl">0.95</span>,<span class="dt">mean=</span><span class="dv">1</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 4.289707</code></pre>
<p>Para generar <code>n</code> valores aleatorios de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span>, hay que usar la función <code>rnorm(n,mean=mu,sd=sigma)</code>:</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" title="1"><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">5</span>,<span class="dt">mean=</span><span class="dv">1</span>,<span class="dt">sd=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] -1.7813382  0.7320555  2.7209162  2.9098518  2.5098235</code></pre>
<p><strong>Cálculos con python</strong></p>
<p>Para poder trabajar con una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span> en python, tenemos que importar <code>norm</code> de <code>scipy.stas</code>. Los parámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> son <code>loc</code> y <code>scale</code>, respectivamente.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb338-1" title="1"><span class="im">from</span> scipy.stats <span class="im">import</span> norm</a></code></pre></div>
<p>Por ejemplo, para una variable <span class="math inline">\(X\sim N(\mu=1,\sigma=2)\)</span>, la función de densidad <span class="math inline">\(f_X(2)\)</span> se puede calcular de la forma siguiente:</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb339-1" title="1">norm.pdf(<span class="dv">2</span>,loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 0.17603266338214976</code></pre>
<p>y la función de distribución <span class="math inline">\(F_X(2) = P(X\leq 2)\)</span>, de la forma siguiente:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb341-1" title="1">norm.cdf(<span class="dv">2</span>,loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 0.6914624612740131</code></pre>
<p>Si queremos calcular el cuantil <span class="math inline">\(x_{q}\)</span> de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span>, tenemos que usar la función <code>norm.ppf(q,loc=mu,scale=sigma)</code>:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb343-1" title="1">norm.ppf(<span class="fl">0.95</span>,loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 4.289707253902945</code></pre>
<p>Para generar <code>n</code> valores aleatorios de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span>, hay que usar la función <code>norm.rvs(loc=mu,scale=sigma,size=n)</code>:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb345-1" title="1">norm.rvs(loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span><span class="dv">5</span>)</a></code></pre></div>
<pre><code>## array([-0.02922468,  5.49169206, -0.93439702, -0.46256825, -1.42642246])</code></pre>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Consultad <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html">SciPy.org</a> para dibujar las funciones de densidad y de distribución con python.</p>
</div>
<p><strong>Gráficas interactivas usando los parámetros de la distribución normal</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb347-1" title="1"><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb347-2" title="2"><span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb347-3" title="3">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb347-4" title="4">         <span class="kw">sliderInput</span>(<span class="st">&quot;m1&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;mu1&quot;</span>,</a>
<a class="sourceLine" id="cb347-5" title="5">              <span class="dt">min =</span> <span class="dv">-10</span>, <span class="dt">max =</span> <span class="dv">10</span>, <span class="dt">value =</span><span class="dv">0</span> , <span class="dt">step =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb347-6" title="6">         ),</a>
<a class="sourceLine" id="cb347-7" title="7">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb347-8" title="8">          <span class="kw">sliderInput</span>(<span class="st">&quot;s1&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;sigma1&quot;</span>,</a>
<a class="sourceLine" id="cb347-9" title="9">                     <span class="dt">min =</span><span class="fl">0.1</span>, <span class="dt">max =</span> <span class="dv">5</span>, <span class="dt">value =</span> <span class="dv">1</span>, <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb347-10" title="10">         ),</a>
<a class="sourceLine" id="cb347-11" title="11">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb347-12" title="12">         <span class="kw">sliderInput</span>(<span class="st">&quot;m2&quot;</span>, <span class="dt">label=</span><span class="st">&quot;mu2&quot;</span>, <span class="dt">value=</span><span class="dv">4</span>, <span class="dt">min =</span> <span class="dv">-10</span>, <span class="dt">max =</span> <span class="dv">10</span>, <span class="dt">step =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb347-13" title="13">         ),</a>
<a class="sourceLine" id="cb347-14" title="14">  <span class="kw">column</span>(<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb347-15" title="15">          <span class="kw">sliderInput</span>(<span class="st">&quot;s2&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;sigma2&quot;</span>,</a>
<a class="sourceLine" id="cb347-16" title="16">                     <span class="dt">min =</span><span class="fl">0.1</span>, <span class="dt">max =</span> <span class="dv">5</span>, <span class="dt">value =</span> <span class="dv">1</span>, <span class="dt">step =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb347-17" title="17">         )</a>
<a class="sourceLine" id="cb347-18" title="18">  </a>
<a class="sourceLine" id="cb347-19" title="19">)</a>
<a class="sourceLine" id="cb347-20" title="20">)</a>
<a class="sourceLine" id="cb347-21" title="21"></a>
<a class="sourceLine" id="cb347-22" title="22"><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb347-23" title="23">  m1=input<span class="op">$</span>m1</a>
<a class="sourceLine" id="cb347-24" title="24">  m2=input<span class="op">$</span>m2</a>
<a class="sourceLine" id="cb347-25" title="25">  s1=input<span class="op">$</span>s1</a>
<a class="sourceLine" id="cb347-26" title="26">  s2=input<span class="op">$</span>s2</a>
<a class="sourceLine" id="cb347-27" title="27">  mins2=<span class="kw">min</span>(<span class="kw">c</span>(s1<span class="op">^</span><span class="dv">2</span>,s2<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb347-28" title="28">m=<span class="kw">min</span>(<span class="kw">c</span>(<span class="kw">qnorm</span>(<span class="fl">0.01</span>,m1,s1),<span class="kw">qnorm</span>(<span class="fl">0.01</span>,m2,s2)))</a>
<a class="sourceLine" id="cb347-29" title="29">M=<span class="kw">max</span>(<span class="kw">c</span>(<span class="kw">qnorm</span>(<span class="fl">0.99</span>,m1,s1),<span class="kw">qnorm</span>(<span class="fl">0.99</span>,m2,s2)))</a>
<a class="sourceLine" id="cb347-30" title="30"></a>
<a class="sourceLine" id="cb347-31" title="31"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x,m1,s1),<span class="dt">xlim=</span><span class="kw">c</span>(m,M),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>mins2)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb347-32" title="32"><span class="kw">legend</span>(<span class="st">&quot;toplef&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">N</span>(mu[<span class="dv">1</span>],sigma[<span class="dv">1</span>])),</a>
<a class="sourceLine" id="cb347-33" title="33">                         <span class="kw">expression</span>(<span class="kw">N</span>(mu[<span class="dv">2</span>],sigma[<span class="dv">2</span>]))),</a>
<a class="sourceLine" id="cb347-34" title="34">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb347-35" title="35"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x,m2,s2),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb347-36" title="36">})</a></code></pre></div>
<!--[![](Images/noshinyImages/interactiva_normal1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Transformaciones lineales de variables aleatorias normales</strong></p>
<p><l class="prop"> <strong>Propiedad: transformación lineal la distribución normal</strong> </l></p>
<p>Sea <span class="math inline">\(X\)</span> una variable <span class="math inline">\(N(\mu,\sigma)\)</span> entonces la variable <span class="math inline">\(Y=a X+b\)</span> con
<span class="math inline">\(a\not=0,b\in\mathbb{R}\)</span> tiene distribución <span class="math inline">\(N(a\mu+b, |a| \sigma)\)</span></p>
<p>En el caso particular en que <span class="math inline">\(a=\frac1{\sigma}\)</span> y <span class="math inline">\(b= \frac{-\mu}{\sigma}\)</span> obtenemos la v.a. <span class="math inline">\(Z={{X-\mu}\over {\sigma}}\)</span>, que
se distribuye según una normal estándar <span class="math inline">\(N(0,1)\)</span>, es decir <span class="math inline">\(E(X)=0\)</span> y <span class="math inline">\(Var(X)=1\)</span>. Dicha operación se denomina estandarización de la
distribución normal.</p>
<p>La propiedad anterior nos permite calcular la función de distribución de cualquier v.a. <span class="math inline">\(N(\mu,\sigma)\)</span> a partir de la función de distribución de la distribución <span class="math inline">\(Z=N(0,1)\)</span>:
<span class="math display">\[
F_X(x)=P(X\leq x)=P\left(\frac{X-\mu}{\sigma}\leq \frac{x-\mu}{\sigma}\right)=P\left(Z\leq \frac{x-\mu}{\sigma}\right)=F_Z \left(\frac{x-\mu}{\sigma}\right).
\]</span>
Entonces, basta conocer la manera de calcular <span class="math inline">\(F_Z\)</span> para poder calcular <span class="math inline">\(F_X\)</span>, para <span class="math inline">\(X=N(\mu,\sigma)\)</span>, para cualquier <span class="math inline">\(\mu\)</span> y cualquier <span class="math inline">\(\sigma&gt;0\)</span>.</p>
<p><strong>Propiedades de la distribución normal estándar</strong></p>
<p>Sea <span class="math inline">\(Z\)</span> una <span class="math inline">\(N(0,1)\)</span>.</p>
<p>En este caso, <span class="math inline">\(\mu=0\)</span> y <span class="math inline">\(\sigma=1\)</span>. Podemos escribir algunas de las propiedades vistas para una distribución normal cualquiera de la forma siguiente:</p>
<ul>
<li>La propiedad <span class="math inline">\(f_X(\mu-x)=f_X(\mu+x)\)</span> se traduce a <span class="math inline">\(f_Z(-x)=f_Z(x)\)</span></li>
<li>La propiedad <span class="math inline">\(F_X(\mu-x)=1-F_X(\mu+x)\)</span> se traduce a <span class="math inline">\(F_Z(-x)=1-F(x).\)</span></li>
<li>Dado <span class="math inline">\(\delta&gt;0\)</span>,
<span class="math display">\[
P(-\delta\leq Z \leq \delta)=F_{Z}(\delta)-F_{Z}(-\delta)=F_Z(\delta)-(1-F_Z(\delta))=
2\cdot F_Z(\delta)-1.
\]</span></li>
</ul>
<div class="exercise">
<p><strong>Ejercicio: cálculos con la distribución normal estándar</strong></p>
<p>Sea <span class="math inline">\(Z\)</span> una distribución <span class="math inline">\(N(0,1)\)</span>. Calcular las siguientes probabilidades en función de <span class="math inline">\(F_Z\)</span>:</p>
<ul>
<li><span class="math inline">\(P(-4\leq Z \leq 4).\)</span></li>
<li><span class="math inline">\(P(-2\leq Z \leq 2).\)</span></li>
<li><span class="math inline">\(P(Z\leq -2).\)</span></li>
<li><span class="math inline">\(P( Z \leq 2).\)</span></li>
<li><span class="math inline">\(P( Z \geq 2).\)</span></li>
<li><span class="math inline">\(P( Z &gt; 2).\)</span></li>
<li><span class="math inline">\(P( Z = 2).\)</span></li>
<li><span class="math inline">\(P( Z \geq -2).\)</span></li>
</ul>
<div class="example-sol">
<p>Resolución:</p>
<ul>
<li><span class="math inline">\(P(-4\leq Z \leq 4)=F_{Z}(4)-F_{Z}(-4)=2\cdot F_Z(4)-1\)</span>.</li>
<li><span class="math inline">\(P(-2\leq Z \leq 2)=F_{Z}(2)-F_{Z}(-2)=2\cdot F_Z(2)-1\)</span>.</li>
<li><span class="math inline">\(P(Z\leq -2)=F_Z(-2)=1-F_Z(2)\)</span>.</li>
<li><span class="math inline">\(P( Z \leq 2)=F_{Z}(2)\)</span>.</li>
<li><span class="math inline">\(P( Z \geq 2)=1-P(Z&lt;2)=1-F_{Z}(2)\)</span>.</li>
<li><span class="math inline">\(P( Z &gt; 2)=1-P(Z\leq 2)=1-F_{Z}(2)\)</span>.</li>
<li><span class="math inline">\(P( Z = 2)=0\)</span> ya que es una distribución continua.</li>
<li><span class="math inline">\(P( Z \geq -2)=1-P(Z&lt; -2)=1-F_{Z}(-2)=1-(1-F_Z(2))=F_Z(2).\)</span></li>
</ul>
</div>
</div>
<p><strong>Cálculo de probabilidades de la distribución normal <span class="math inline">\(X=N(\mu,\sigma)\)</span> en un intervalo usando la distribución <span class="math inline">\(Z=N(0,1)\)</span></strong></p>
<p>Para hallar la probabilidad de que <span class="math inline">\(X\)</span> esté en un intervalo <span class="math inline">\((a,b)\)</span> cualquiera, podemos usar la función de distribución de <span class="math inline">\(Z\)</span> de la siguiente manera:
<span class="math display">\[
\begin{array}{ll}
P(a&lt;X&lt;b)&amp;=P\left(\frac{a-\mu}{\sigma}&lt;\frac{X-\mu}{\sigma}&lt;\frac{b-\mu}{\sigma}\right)= \\
&amp;=P\left(\frac{a-\mu}{\sigma}&lt;Z&lt;\frac{b-\mu}{\sigma}\right)=F_{Z}\left(\frac{b-\mu}{\sigma}\right)-
F_{Z}\left(\frac{a-\mu}{\sigma}\right).
\end{array}
\]</span></p>
<p>Para el caso particular en que el intervalo esté centrado en la media <span class="math inline">\(\mu\)</span>, o sea existe un valor <span class="math inline">\(\delta&gt;0\)</span> tal que <span class="math inline">\((a,b)=(\mu-\delta,\mu+\delta)\)</span>, obtenemos:
<span class="math display">\[
P\left(\mu-\delta\leq X \leq\mu+\delta\right)=2\cdot  F_Z\left(\frac{\delta}{\sigma}\right)-1.
\]</span></p>
<div class="exercise">
<p><strong>Ejercicio: cálculo de probabilidades de una distribución normal</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una normal con media <span class="math inline">\(2\)</span> y varianza <span class="math inline">\(4\)</span>. Calcular</p>
<ul>
<li><span class="math inline">\(P(1&lt; X&lt; 2).\)</span></li>
<li><span class="math inline">\(P(X&gt;3).\)</span></li>
</ul>
<div class="example-sol">
<p><strong>Solución</strong></p>
<p>La primera probabilidad se calcula de la forma siguiente:
<span class="math display">\[
\begin{array}{ll}
P(1&lt; X&lt; 2)&amp;= P\left(\frac{1-2}{2}&lt;\frac{X-2}{2}&lt;\frac{2-2}{2}\right)= P\left(\frac{-1}{2}&lt;Z&lt;0\right)\\
&amp;= F_{Z}(0)-F_{Z}(-0.5)=\frac12-1+F_{Z}(0.5)=-\frac12+F_Z(0.5).
\end{array}
\]</span></p>
<p>La segunda probabilidad se calcular de la forma siguiente:
<span class="math display">\[
P(X&gt;3)=P\left(\frac{X-2}2&gt;\frac{3-2}{2}\right)=P(Z&gt;0.5)=1-F_{Z}(0.5).
\]</span></p>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una normal con media <span class="math inline">\(2\)</span> y varianza <span class="math inline">\(4\)</span>. Calcular usando <code>R</code> y con python las probabilidades siguientes:</p>
<ul>
<li><span class="math inline">\(P(1&lt; X&lt; 2).\)</span></li>
<li><span class="math inline">\(P(X&gt;3).\)</span></li>
</ul>
<div class="example-sol">
<p><strong>Solución usando <code>R</code></strong></p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1"><span class="kw">pnorm</span>(<span class="dv">2</span>,<span class="dt">mean=</span><span class="dv">2</span>,<span class="dt">sd=</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span><span class="dv">2</span>,<span class="dt">sd=</span><span class="dv">2</span>) <span class="co">#P(1&lt; X&lt; 2)</span></a></code></pre></div>
<pre><code>## [1] 0.1914625</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1"><span class="kw">pnorm</span>(<span class="dv">3</span>,<span class="dt">mean=</span><span class="dv">2</span>,<span class="dt">sd=</span><span class="dv">2</span>,<span class="dt">lower.tail =</span><span class="ot">FALSE</span>) <span class="co">#P(X&gt;3)</span></a></code></pre></div>
<pre><code>## [1] 0.3085375</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" title="1"><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">3</span>,<span class="dt">mean=</span><span class="dv">2</span>,<span class="dt">sd=</span><span class="dv">2</span>,<span class="dt">lower.tail=</span><span class="ot">TRUE</span>) <span class="co">#P(X&gt;3) = 1-P(X&lt;=3)</span></a></code></pre></div>
<pre><code>## [1] 0.3085375</code></pre>
<p><strong>Solución con Python</strong></p>
<div class="sourceCode" id="cb354"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb354-1" title="1">norm.cdf(<span class="dv">2</span>,loc<span class="op">=</span><span class="dv">2</span>,scale<span class="op">=</span><span class="dv">2</span>)<span class="op">-</span>norm.cdf(<span class="dv">1</span>,loc<span class="op">=</span><span class="dv">2</span>,scale<span class="op">=</span><span class="dv">2</span>) <span class="co">#P(1&lt; X&lt; 2)</span></a></code></pre></div>
<pre><code>## 0.19146246127401312</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb356-1" title="1"><span class="dv">1</span><span class="op">-</span>norm.cdf(<span class="dv">3</span>,loc<span class="op">=</span><span class="dv">2</span>,scale<span class="op">=</span><span class="dv">2</span>) <span class="co">#P(X&gt;3) = 1-P(X&lt;=3)</span></a></code></pre></div>
<pre><code>## 0.3085375387259869</code></pre>
</div>
</div>
<p><strong>La distribución normal aproxima otras distribuciones</strong></p>
<p>En los temas que siguen veremos como, bajo determinadas condiciones,</p>
<ul>
<li>la distribución normal puede aproximar la distribución binomial,</li>
<li>la distribución normal puede aproximar la distribución Poisson</li>
<li>la distribución normal es la distribución límite de la media aritmética de una muestra de variables aleatorias.</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="variables-aleatorias.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="variables-aleatorias-complementos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/joanby/probabilidad/edit/master/3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["curso-probabilidad-udemy.pdf", "curso-probabilidad-udemy.epub"],
"toc": {
"collapse": "subsection"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
